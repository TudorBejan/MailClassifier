YUI.add("sessionmanager",function(B){if(!YUI.namespace("Messenger").SessionManager){var D=window.launchData,G=D.fbEnabled,J=B.Messenger.RequestManager,F=B.Messenger.GlobalConfig,I=B.Messenger.CommonUtils,C=B.Messenger.GlobalConstants,A=B.Messenger.Intl,E=YUI.namespace("Messenger.Metrics"),K=B.Messenger.Events;function H(L){H.superclass.constructor.apply(this,arguments);}H.ATTRS={presenceState:{value:-1},presenceMessage:{value:""},primaryId:{value:""},loggedInId:{value:""},aliases:{value:[]},online:{value:false,setter:function(L){if(!E.convWindowPref){if(F.get("convWindowStyle")==="iframe"){logRocketStats({key:"messageWindowFloating",value:""});}else{logRocketStats({key:"messageWindowTab",value:""});}E.convWindowPref=true;}return L;}},facebookOnline:{value:false},mpopInfo:{},presenceSubscriptionsMaxPerRequest:{value:D.loginData?D.loginData.constants.presenceSubscriptionsMaxPerRequest:30},displayImage:{value:D.isSecure?C.DEFAULT_IMAGE_SSL:C.DEFAULT_IMAGE},fbConnectSeen:{value:false}};H.REQUESTS={"LOGIN":{method:"POST",path:"/v1/session"},"LOGOUT":{method:"DELETE",path:"/v1/session"},"SET_PRESENCE":{method:"PUT",path:"/v1/presence"},"LOGIN_FB":{method:"POST",path:"/v1/federation/facebook"},"LOGOUT_FB":{method:"DELETE",path:"/v1/federation/facebook"},"WAKEUP":{method:"PUT",path:"/v1/session",args:["action=mpop-activate"]}};B.extend(H,B.Base,{start:function(){var L=D.loginData,N,M=[];if(L){this.set("presenceState",D.initialPresence);this._processLoginData(L);this.set("online",true);}else{if(D.failedLogin){this.login(D.initialPresence||0);}}this._previousState={state:D.initialPresence||0,message:""};J.addListeners([{id:"buddyStatus",callback:B.bind(this._processBuddyStatus,this)},{id:"disconnect",callback:B.bind(this._processDisconnect,this)},{id:"endPointState",callback:B.bind(this._processEndPointState,this)},{id:"setVisibilityState",callback:B.bind(this._processVisibilityState,this)},{id:"federationLogin",callback:B.bind(this._processFederationLogin,this)},{id:"federationLogoff",callback:B.bind(this._processFederationLogoff,this)}]);B.Global.on(K.FATAL_IO_ERROR,B.bind(this._processDisconnect,this));B.Global.on(K.LOGGED_OUT,B.bind(this._processDisconnect,this));B.Global.on(K.SESSION_EXPIRED,B.bind(this._processSessionExpired,this));if(B.UA.ie){window.attachEvent("onunload",B.bind(this.quickLogout,this));}else{window.addEventListener("unload",B.bind(this.quickLogout,this),false);}},isOnline:function(){return this.get("online");},isOnlineFacebook:function(){return this.get("online")&&this.get("facebookOnline");},isInvisible:function(){return this.get("online")&&this.get("presenceState")==-1;},getStateID:function(){if(this.isInvisible()){return"invisible";}switch(this.get("presenceState")){case -1:case"-1":return"offline";break;case 0:case"0":return"available";break;case 2:case"2":return"busy";break;case 999:case"999":return"idle";break;default:return"offline";}},getOwnDisplayImage:function(L){L=L||32;return I.substitute(this.get("displayImage"),{"pixels|32|48":L});},login:function(P,R,S){if(this.get("online")){return;}P=P||0;R=R||"";var N=H.REQUESTS["LOGIN"],Q=I.normalizePresenceState({presenceState:P,presenceMessage:R}),O=[{"clientCapability":"smiley"},{"clientCapability":"mpop"},{"clientCapability":"richText"},{"clientCapability":"interop"},{"clientCapability":"activateSSA"},{"clientCapability":"typing"}],L,M;if(F.get("smsEnabled")){O.push({"clientCapability":"sms"});}if(F.get("fileTransferEnabled")){O.push({"clientCapability":"fileXfer"});}L={presenceState:Q.state,presenceMessage:Q.message,profileLogin:0,clientCapabilities:O,mpopLoginInfo:{"loginType":0}};L.loginTriggers=[{loginTrigger:"mpopStateTransfer"},{loginTrigger:"ignoreList"},{loginTrigger:"invisibleList"}];if(F.get("fbEnabled")){L.loginTriggers.push({loginTrigger:"fbAutoLogin"});O.push({"clientCapability":"fbInterop"});}M=["notifyServerToken=2","fieldsBuddyList="+encodeURIComponent("+groups"),"fieldsBuddyList="+encodeURIComponent("-uri")];if(!(window.openmail)){M.push("fieldsBuddyList="+encodeURIComponent("+addressbook"));}J.issueRequest({type:"LOGIN",method:N.method,path:N.path,args:M,postBody:L,successCallback:B.bind(function(T){this.set("presenceState",Q.state);this.set("presenceMessage",Q.message);J.setServerUrl("yim_core",D.protocol+T.server);J.setServerUrl("yim_notify",D.protocol+T.notifyServer);this._processLoginData(T);J.startListening();this.set("online",true);B.Command.exec("yim:processBuddies",T.contacts);B.Global.fire(K.CONNECTION_UPDATE,{isOnline:true});B.Global.fire(K.SELF_PRESENCE_CHANGED,{state:Q.state,message:Q.message});B.Global.fire(K.PRESENCE_PREF_UPDATED,P);B.Global.fire(K.EXPLICIT_LOGIN);S&&S();},this),errorCallback:B.bind(function(T){this.set("presenceState",-1);this.set("presenceMessage","");this.set("online",false);B.Global.fire(K.CONNECTION_UPDATE,{isOnline:false,reason:4});},this)});},logout:function(N){var M=H.REQUESTS["LOGOUT"],O=F.get("mpopSignOutType"),P=this.get("mpopInfo"),L;N=N?N:O=="always_local"?"local":O=="always_global"?"global":null;if(!N&&P&&P.totalEndpoints>1){B.Global.fire(K.SHOW_WINDOW,C.SIGNOUT_WINDOW);return;}if(N){L={logoffType:N=="local"?0:2};}J.issueRequest({type:"LOGOUT",method:M.method,path:M.path,postBody:L,successCallback:B.bind(function(Q){this.set("presenceState",-1);this.set("presenceMessage","");this.set("online",false);this.set("facebookOnline",false);J.handleLogout();B.Global.fire(K.CONNECTION_UPDATE,{isOnline:false,reason:4});B.Global.fire(K.PRESENCE_PREF_UPDATED,9999);},this),errorCallback:B.bind(function(Q){B.Global.fire(K.CONNECTION_UPDATE,{isOnline:true});},this)});},_processLoginData:function(N){var M=D.protocol+N.server+H.REQUESTS.LOGOUT.path,L=[],O;M+="/delete?logoffType=0";M+="&sid="+encodeURIComponent(N.sessionId);M+="&c="+encodeURIComponent(J.get("crumb"));M+="&msgrAppId=mim&blocking=0";J.setLogoutURL(M);this.set("primaryId",N.primaryLoginId);this.set("loggedInId",N.primaryLoginId);J.set("primaryLoginId",N.primaryLoginId);J.set("sessionId",N.sessionId);J.set("imToken",N.notifyServerToken.token);
if(N.profileLoginIds){for(O=0;O<N.profileLoginIds.length;O++){L.push(N.profileLoginIds[O].profileLoginId);if(N.profileLoginIds[O]["default"]){this.set("loggedInId",N.profileLoginIds[O].profileLoginId);}}this.set("aliases",L);}this.set("mpopInfo",N.mpopInfo);this._processOwnImageData(N.displayInfo);this.set("presenceSubscriptionsMaxPerRequest",N.constants.presenceSubscriptionsMaxPerRequest);B.Global.fire(K.LOGGED_IN);},_processOwnImageData:function(L){var M=L;M.user=this.get("loggedInId");M.network="yahoo";this.set("displayImage",I.getImageUrl(M));},quickLogout:function(){J.killConnections();this.set("presenceState",-1);this.set("presenceMessage","");this.set("online",false);this.set("facebookOnline",false);},toggleMessengerPresence:function(){if(this.get("online")){this.logout();}else{this.login();}},toggleFacebookPresence:function(){if(this.isOnlineFacebook()){this.logoutFacebook();}else{this.loginFacebook();}},isSelfUser:function(M){var L=this.get("aliases"),O=this.get("primaryId");if(M===O){return true;}else{for(var N=0;N<L.length;N++){if(L[N]===M){return true;}}}return false;},loginFacebook:function(L){if(F.get("isFresh")){return;}var N=H.REQUESTS["LOGIN_FB"],M=L?[]:["updateAutoLoginPref=1"];if(!G){throw new Error("Attempt made to log in to facebook but facebook is disabled");}if(this.isOnlineFacebook()){return;}if(!this.isOnline()){this.login(0,"",B.bind(function(){this.loginFacebook(L);},this));return;}J.issueRequest({type:"LOGIN_FB",method:N.method,path:N.path,args:M,postBody:"",successCallback:B.bind(function(O){this.set("facebookOnline",true);B.Global.fire(K.LOGIN_FACEBOOK);},this),failureCallback:B.bind(function(){B.Global.fire(K.LOGOUT_FACEBOOK);},this)});},logoutFacebook:function(L){var N=H.REQUESTS["LOGOUT_FB"],M=L?[]:["updateAutoLoginPref=1"];if(!this.isOnlineFacebook()){return;}J.issueRequest({type:"LOGOUT_FB",method:N.method,path:N.path,args:M,postBody:"",successCallback:B.bind(function(O){this.set("facebookOnline",false);B.Global.fire(K.LOGOUT_FACEBOOK);},this)});},setPresence:function(N,O){if(!this.get("online")){this.login(N,O);}else{if(!this.isPrimary()){this.becomePrimary(B.bind(function(){this.setPresence(N,O);},this));return;}var M=H.REQUESTS["SET_PRESENCE"],L={presenceState:N};if(O){L.presenceMessage=O;}J.issueRequest({type:"PRESENCE",method:M.method,path:M.path,postBody:L,successCallback:B.bind(function(P){this.set("presenceState",N);this.set("presenceMessage",O||"");B.Global.fire(K.SELF_PRESENCE_CHANGED,{state:N,message:O});if(N==-1){this.logoutFacebook(true);}B.Global.fire(K.PRESENCE_PREF_UPDATED,N);},this)});}},becomePrimary:function(O){var M=H.REQUESTS.WAKEUP,N=this,L=this.get("mpopInfo");if(this.isOnline()&&L&&L.state!=0){J.issueRequest({type:"MPOP_ACTIVATE",method:M.method,path:M.path,args:M.args,successCallback:function(){L=N.get("mpopInfo");L.state=0;N.set("mpopInfo",L);B.Global.fire(K.MPOP_STATE_CHANGE,L);O&&O();}});}},isPrimary:function(){return this.get("mpopInfo").state==0?true:false;},_processBuddyStatus:function(O){if(O.echo){var N=this.get("presenceState"),L=this.get("presenceMessage"),M=I.normalizePresenceState(O);if(M.state!=N||M.message!=L){this.set("presenceState",M.state);this.set("presenceMessage",M.message);B.Global.fire(K.SELF_PRESENCE_CHANGED,M);}}},_processDisconnect:function(L){this.set("presenceState",-1);this.set("presenceMessage","");this.set("online",false);this.set("facebookOnline",false);J.handleLogout();B.Global.fire(K.CONNECTION_UPDATE,{isOnline:false,reason:L?L.reason:-1});},_processSessionExpired:function(M){var L=this.get("presenceState")||"0",N=this.get("presenceMessage")||"";this._processDisconnect();this.login(L,N);},_processEndPointState:function(M){var L=this.get("mpopInfo"),N=M.endPointInfo;if(N){N.totalEndpoints=N.totalEndpoints||N.numberOfEndPoints;this.set("mpopInfo",N);if(N.state!=0&&N.numberOfEndPoints==1){this.becomePrimary();}if(L.state!=N.state){B.Global.fire(K.MPOP_STATE_CHANGE,N);}}},_processVisibilityState:function(M){var L=this.get("presenceState");if(M.state==2){if(L!=-1){this._previousState={state:L,message:this.get("presenceMessage")};this.set("presenceState",-1);this.set("presenceMessage","");B.Global.fire(K.SELF_PRESENCE_CHANGED,{state:-1,message:""});}}else{if(L==-1){this.set("presenceState",this._previousState.state);this.set("presenceMessage",this._previousState.message);B.Global.fire(K.SELF_PRESENCE_CHANGED,this._previousState);}}},_processFederationLogin:function(O){if(O&&(O.network=="facebook")&&!F.get("isFresh")){if(O.status==-1){B.Global.fire(K.LOGOUT_FACEBOOK,O);this.set("facebookOnline",false);var L=function(){this.set("fbConnectSeen",true);var S=(D&&D.lang)?D.lang:"en-US",Q=(D&&D.isSecure)?"https://ycpi-mail-credstore.msg.yahoo.com/v1/credStore.php?lang="+S+"&c="+encodeURIComponent(J.get("crumb")):"http://credstore.msg.yahoo.com/v1/credStore.php?lang="+S+"&c="+encodeURIComponent(J.get("crumb")),R=window.open(Q,"","height=700,width=980"),P=420000,T=B.later(1000,null,B.bind(function(){P-=1000;if(P<0){T.cancel();return;}if(R.closed){T.cancel();this.loginFacebook();}else{}},this),null,true);},M=A.get("str_cont_list_facebook_missing_cred"),N=I.substitute(A.get("str_cont_list_facebook_invalid_cred"),{str_cfg_branding:A.get("str_cfg_branding"),str_cfg_branding_messenger:F.getGenericAppName()});switch(O.errorCode){case 56:if(!this.get("fbConnectSeen")){B.Messenger.WindowManager.confirm(M,B.bind(L,this),null,A.get("str_cont_list_facebook_down_header").replace(/"/g,""),"warning");}else{this.set("fbConnectSeen",false);}break;case 57:if(!this.get("fbConnectSeen")){B.Messenger.WindowManager.confirm(N,B.bind(L,this),null,A.get("str_cont_list_facebook_down_header").replace(/"/g,""),"warning");}else{this.set("fbConnectSeen",false);}break;case 40:B.Messenger.WindowManager.alert(A.get("str_cont_list_facebook_down").replace(/"/g,""),null,A.get("str_cont_list_facebook_down_header").replace(/"/g,""),"warning");break;default:}}else{if(this.get("facebookOnline")){return;}this.set("facebookOnline",true);B.Global.fire(K.LOGIN_FACEBOOK,O);
}}},_processFederationLogoff:function(L){if(L&&L.network=="facebook"){if(!this.get("facebookOnline")){return;}this.set("facebookOnline",false);B.Global.fire(K.LOGOUT_FACEBOOK,L);}}});YUI.Messenger.SessionManager=new H();B.Command.registerModule("yim",YUI.Messenger.SessionManager);}B.namespace("Messenger").SessionManager=YUI.Messenger.SessionManager;},"@VERSION@",{requires:["base-base","requestmanager","command","commonutils","events","globalconstants"]});/*
YUI 3.7.2 (build 5639)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("datatype-date-parse",function(e,t){var n=e.Lang;e.mix(e.namespace("Date"),{parse:function(e){var t=null;return n.isDate(e)?t:(t=new Date(e),n.isDate(t)&&t!="Invalid Date"&&!isNaN(t)?t:null)}}),e.namespace("Parsers").date=e.Date.parse,e.namespace("DataType"),e.DataType.Date=e.Date},"3.7.2");
/*
YUI 3.7.2 (build 5639)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("lang/datatype-date-format_en-US",function(e){e.Intl.add("datatype-date-format","en-US",{a:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],A:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],b:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],B:["January","February","March","April","May","June","July","August","September","October","November","December"],c:"%a, %b %d, %Y %l:%M:%S %p %Z",p:["AM","PM"],P:["am","pm"],x:"%m/%d/%y",X:"%l:%M:%S %p"})},"3.7.2");
/*
YUI 3.7.2 (build 5639)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("datatype-date-format",function(e,t){var n=function(e,t,n){typeof n=="undefined"&&(n=10),t+="";for(;parseInt(e,10)<n&&n>1;n/=10)e=t+e;return e.toString()},r={formats:{a:function(e,t){return t.a[e.getDay()]},A:function(e,t){return t.A[e.getDay()]},b:function(e,t){return t.b[e.getMonth()]},B:function(e,t){return t.B[e.getMonth()]},C:function(e){return n(parseInt(e.getFullYear()/100,10),0)},d:["getDate","0"],e:["getDate"," "],g:function(e){return n(parseInt(r.formats.G(e)%100,10),0)},G:function(e){var t=e.getFullYear(),n=parseInt(r.formats.V(e),10),i=parseInt(r.formats.W(e),10);return i>n?t++:i===0&&n>=52&&t--,t},H:["getHours","0"],I:function(e){var t=e.getHours()%12;return n(t===0?12:t,0)},j:function(e){var t=new Date(""+e.getFullYear()+"/1/1 GMT"),r=new Date(""+e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate()+" GMT"),i=r-t,s=parseInt(i/6e4/60/24,10)+1;return n(s,0,100)},k:["getHours"," "],l:function(e){var t=e.getHours()%12;return n(t===0?12:t," ")},m:function(e){return n(e.getMonth()+1,0)},M:["getMinutes","0"],p:function(e,t){return t.p[e.getHours()>=12?1:0]},P:function(e,t){return t.P[e.getHours()>=12?1:0]},s:function(e,t){return parseInt(e.getTime()/1e3,10)},S:["getSeconds","0"],u:function(e){var t=e.getDay();return t===0?7:t},U:function(e){var t=parseInt(r.formats.j(e),10),i=6-e.getDay(),s=parseInt((t+i)/7,10);return n(s,0)},V:function(e){var t=parseInt(r.formats.W(e),10),i=(new Date(""+e.getFullYear()+"/1/1")).getDay(),s=t+(i>4||i<=1?0:1);return s===53&&(new Date(""+e.getFullYear()+"/12/31")).getDay()<4?s=1:s===0&&(s=r.formats.V(new Date(""+(e.getFullYear()-1)+"/12/31"))),n(s,0)},w:"getDay",W:function(e){var t=parseInt(r.formats.j(e),10),i=7-r.formats.u(e),s=parseInt((t+i)/7,10);return n(s,0,10)},y:function(e){return n(e.getFullYear()%100,0)},Y:"getFullYear",z:function(e){var t=e.getTimezoneOffset(),r=n(parseInt(Math.abs(t/60),10),0),i=n(Math.abs(t%60),0);return(t>0?"-":"+")+r+i},Z:function(e){var t=e.toString().replace(/^.*:\d\d( GMT[+-]\d+)? \(?([A-Za-z ]+)\)?\d*$/,"$2").replace(/[a-z ]/g,"");return t.length>4&&(t=r.formats.z(e)),t},"%":function(e){return"%"}},aggregates:{c:"locale",D:"%m/%d/%y",F:"%Y-%m-%d",h:"%b",n:"\n",r:"%I:%M:%S %p",R:"%H:%M",t:"	",T:"%H:%M:%S",x:"locale",X:"locale"},format:function(t,i){i=i||{};if(!e.Lang.isDate(t))return e.Lang.isValue(t)?t:"";var s,o,u,a,f;s=i.format||"%Y-%m-%d",o=e.Intl.get("datatype-date-format");var l=function(e,t){if(u&&t==="r")return o[t];var n=r.aggregates[t];return n==="locale"?o[t]:n},c=function(i,s){var u=r.formats[s];switch(e.Lang.type(u)){case"string":return t[u]();case"function":return u.call(t,t,o);case"array":if(e.Lang.type(u[0])==="string")return n(t[u[0]](),u[1]);default:return s}};while(s.match(/%[cDFhnrRtTxX]/))s=s.replace(/%([cDFhnrRtTxX])/g,l);var h=s.replace(/%([aAbBCdegGHIjklmMpPsSuUVwWyYzZ%])/g,c);return l=c=undefined,h}};e.mix(e.namespace("Date"),r),e.namespace("DataType"),e.DataType.Date=e.Date},"3.7.2",{lang:["ar","ar-JO","ca","ca-ES","da","da-DK","de","de-AT","de-DE","el","el-GR","en","en-AU","en-CA","en-GB","en-IE","en-IN","en-JO","en-MY","en-NZ","en-PH","en-SG","en-US","es","es-AR","es-BO","es-CL","es-CO","es-EC","es-ES","es-MX","es-PE","es-PY","es-US","es-UY","es-VE","fi","fi-FI","fr","fr-BE","fr-CA","fr-FR","hi","hi-IN","id","id-ID","it","it-IT","ja","ja-JP","ko","ko-KR","ms","ms-MY","nb","nb-NO","nl","nl-BE","nl-NL","pl","pl-PL","pt","pt-BR","ro","ro-RO","ru","ru-RU","sv","sv-SE","th","th-TH","tr","tr-TR","vi","vi-VN","zh-Hans","zh-Hans-CN","zh-Hant","zh-Hant-HK","zh-Hant-TW"]});
/*
YUI 3.7.2 (build 5639)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("datatype-date-math",function(e,t){var n=e.Lang;e.mix(e.namespace("Date"),{isValidDate:function(e){return n.isDate(e)&&isFinite(e)&&e!="Invalid Date"&&!isNaN(e)&&e!=null?!0:!1},areEqual:function(e,t){return this.isValidDate(e)&&this.isValidDate(t)&&e.getTime()==t.getTime()},isGreater:function(e,t){return this.isValidDate(e)&&this.isValidDate(t)&&e.getTime()>t.getTime()},isGreaterOrEqual:function(e,t){return this.isValidDate(e)&&this.isValidDate(t)&&e.getTime()>=t.getTime()},isInRange:function(e,t,n){return this.isGreaterOrEqual(e,t)&&this.isGreaterOrEqual(n,e)},addDays:function(e,t){return new Date(e.getTime()+864e5*t)},addMonths:function(e,t){var n=e.getFullYear(),r=e.getMonth()+t;n=Math.floor(n+r/12),r=(r%12+12)%12;var i=new Date(e.getTime());return i.setFullYear(n),i.setMonth(r),i},addYears:function(e,t){var n=e.getFullYear()+t,r=new Date(e.getTime());return r.setFullYear(n),r},listOfDatesInMonth:function(e){if(!this.isValidDate(e))return[];var t=this.daysInMonth(e),n=e.getFullYear(),r=e.getMonth(),i=[];for(var s=1;s<=t;s++)i.push(new Date(n,r,s,12,0,0));return i},daysInMonth:function(e){if(!this.isValidDate(e))return 0;var t=e.getMonth(),n=[31,28,31,30,31,30,31,31,30,31,30,31];if(t!=1)return n[t];var r=e.getFullYear();return r%400===0?29:r%100===0?28:r%4===0?29:28}}),e.namespace("DataType"),e.DataType.Date=e.Date},"3.7.2",{requires:["yui-base"]});
YUI.add("mim-dateformat",function(C){var B=C.Messenger.Intl,A=window.launchData;if(A.dateFormatter){C.Intl.add("datatype-date-format",A.lang,A.dateFormatter);C.Intl.setLang("datatype-date-format",A.lang);}else{if(B.get("str_mail_weekday_abbr_sunday")){A.dateFormatter={"a":[B.get("str_mail_weekday_abbr_sunday"),B.get("str_mail_weekday_abbr_monday"),B.get("str_mail_weekday_abbr_tuesday"),B.get("str_mail_weekday_abbr_wednesday"),B.get("str_mail_weekday_abbr_thursday"),B.get("str_mail_weekday_abbr_friday"),B.get("str_mail_weekday_abbr_saturday")],"A":[B.get("str_mail_weekday_sunday"),B.get("str_mail_weekday_monday"),B.get("str_mail_weekday_tuesday"),B.get("str_mail_weekday_wednesday"),B.get("str_mail_weekday_thursday"),B.get("str_mail_weekday_friday"),B.get("str_mail_weekday_saturday")],"b":[B.get("str_mail_month_abbr_january"),B.get("str_mail_month_abbr_february"),B.get("str_mail_month_abbr_march"),B.get("str_mail_month_abbr_april"),B.get("str_mail_month_abbr_may"),B.get("str_mail_month_abbr_june"),B.get("str_mail_month_abbr_july"),B.get("str_mail_month_abbr_august"),B.get("str_mail_month_abbr_september"),B.get("str_mail_month_abbr_october"),B.get("str_mail_month_abbr_november"),B.get("str_mail_month_abbr_december")],"B":[B.get("str_mail_month_january"),B.get("str_mail_month_february"),B.get("str_mail_month_march"),B.get("str_mail_month_april"),B.get("str_mail_month_may"),B.get("str_mail_month_june"),B.get("str_mail_month_july"),B.get("str_mail_month_august"),B.get("str_mail_month_september"),B.get("str_mail_month_october"),B.get("str_mail_month_november"),B.get("str_mail_month_december")],"c":"%a, %b %d, %Y %l:%M:%S %p %Z","p":[B.get("str_mail_dateformat_AM_l10n"),B.get("str_mail_dateformat_PM_l10n")],"P":[B.get("str_mail_dateformat_AM_l10n"),B.get("str_mail_dateformat_PM_l10n")],"x":"%m/%d/%y","X":"%l:%M:%S %p"};C.Intl.add("datatype-date-format",A.lang,A.dateFormatter);C.Intl.setLang("datatype-date-format",A.lang);}}},"@VERSION@",{requires:["yim-intl","datatype-date"]});YUI.add("abutils",function(B){function A(C){A.superclass.constructor.apply(this,arguments);}A.NAME="yim-abutils";A.ONE_PASS_TIMER=50;A.ATTRS={rawAddressBook:{value:false}};B.extend(A,B.Base,{initializer:function(){},destructor:function(){},isYUser:function(D){var E={"yahoo.com":true,"ymail.com":true,"rocketmail.com":true,"ameritech.net":true,"flash.net":true,"nvbell.net":true,"pacbell.net":true,"prodigy.net":true,"sbcglobal.net":true,"snet.net":true,"swbell.net":true,"wans.net":true,"btinternet.com":true,"btopenworld.com":true,"talk21.com":true,"rogers.com":true,"nl.rogers.com":true,"verizon.net":true,"demobroadband.com":true},C=D.split("@");if(C.length!==2||!E[C[1]]||(C[0].length<4)||(C[0].length>32)){return false;}return C[0];},parse:function(C,D){log("Begin parsing ABData");this._parseContacts(C||{},0,D);},parseUpdate:function(H,D,J){var L=H,K=[],E=[];if(!L||(typeof L!=="object")){}var I,F,G,C;for(I=0;I<L.length;I+=1){G=L[I].id;for(F=0;F<D.length;F+=1){if(G===D[F]){K.push(L[I]);break;}}}E=this._parseContacts(K,0,function(M){B.Command.exec("yim:abContactsUpdated",M);});},_parseContacts:function(C,E,F){var I=C.length,D=function(){return new Date().getTime();};this._parsedContacts=this._parsedContacts||[];var K=D();for(var Q=E;Q<I;Q++){var L=C[Q].fields,J,S,M=false,T={},P={},R=false,G=false,V,U;for(var O=0;L&&O<L.length;O++){if(L[O].type=="phone"){R=true;}if(L[O].type=="yahooid"){if(L[O].value&&L[O].value.length>=4&&L[O].value.length<=32){M=true;J=L[O].value;}break;}if(L[O].type=="email"&&!(L[O].id<=0)){S=B.Messenger.CommonUtils.getYidFromEmailAddr(L[O].value);if(S.yid){J=S.value;M=true;break;}else{}}if(L[O].type=="otherid"&&!B.Lang.isUndefined(L[O].flags)){if((L[O].flags[0]=="MSN")||L[O].flags[0]=="IBM"||L[O].flags[0]=="LCS"){G=true;V=L[O].value;U=L[O].flags[0].toLowerCase();break;}}}if(M||R||G){if(M){P.id=J;P.network="yahoo";}else{if(G){P.id=V;P.network=U;}}for(var N=0;L&&N<L.length;N++){switch(L[N].type){case"name":if(!T.firstname){T.firstname=L[N].value.givenName||"";}if(!T.lastname){T.lastname=L[N].value.familyName||"";}break;case"nickname":if(!T.nickname){T.nickname=L[N].value;}break;case"email":if(!T.email){T.email=L[N].value;T.sc_score=L[N].sc_score;}break;case"phone":if(!B.Lang.isUndefined(L[N].flags)&&B.Lang.isString(L[N].flags[0])){var H=L[N].flags[0];switch(H){case"HOME":if(!T.homeno){T.homeno=L[N].value;}break;case"WORK":if(!T.workno){T.workno=L[N].value;}break;case"MOBILE":if(!T.mobileno){T.mobileno=L[N].value;if(!P.id){P.id=B.Messenger.CommonUtils.normalizeNumber(T.mobileno);P.network="sms";}}break;default:}}else{}break;case"guid":P.guid=L[N].value;break;default:}}P.addressbookId=C[Q].id;P.addressbook=T;if(P.id&&P.network){this._parsedContacts.push(P);}}else{}if((D()-K)>A.ONE_PASS_TIMER){break;}else{}}if(Q<I){log("ABUtils parsed from "+E+" to "+Q+". But we have more, so scheduling next batch");B.later(50,this,B.bind(function(){this._parseContacts(C,Q+1,F);},this));}else{if(this._parsedContacts.length){F&&F(this._parsedContacts);}delete this._parsedContacts;}}});B.namespace("Messenger").ABUtils=A;},"@VERSION@",{requires:["base-base","commonutils"]});YUI.add("contactsmanager",function(C){if(!YUI.namespace("Messenger").ContactsManager){var E=window.launchData,I=0,A=C.Messenger.Intl,H=C.Messenger.CommonUtils,K=C.Messenger.Events,F=C.Messenger.GlobalConfig,D=C.Messenger.GlobalConstants,J=C.Messenger.RequestManager,G=C.Messenger.SessionManager;function B(L){B.superclass.constructor.apply(this,arguments);}B.ATTRS={ABDataReceived:{value:false},started:{value:false}};B.REQUESTS={"BLOCK_USER":{method:"PUT",path:"/v1/ignorelist"},"UNBLOCK_USER":{method:"DELETE",path:"/v1/ignorelist"},"ACCEPT_ADD":{method:"POST",path:"/v1/buddyrequest/{{network}}/{{user}}"},"DENY_ADD":{method:"DELETE",path:"/v1/buddyrequest/{{network}}/{{user}}"},"REPORT_SPAM":{method:"POST",path:"/v1/abuse/spim"},"SUBSCRIBE_PRESENCE":{method:"PUT",path:"/v1/subscription/presence",args:["blocking=0"]},"UNSUBSCRIBE_PRESENCE":{method:"DELETE",path:"/v1/subscription/presence",args:["blocking=0"]},"VISIBLE_LIST_ADD":{method:"PUT",path:"/v1/stealth/visiblelist"},"VISIBLE_LIST_DELETE":{method:"DELETE",path:"/v1/stealth/visiblelist"},"INVISIBLE_LIST_ADD":{method:"PUT",path:"/v1/stealth/invisiblelist"},"INVISIBLE_LIST_DELETE":{method:"DELETE",path:"/v1/stealth/invisiblelist"},"ADD_USER":{method:"PUT",path:"/v1/group/{{groupname}}/contact/{{network}}/{{user}}"},"DELETE_USER":{method:"DELETE",path:"/v1/group/{{groupname}}/contact/{{network}}/{{user}}"},"UPDATE_USER":{method:"PUT",path:"/v1/contact/{{network}}/{{user}}"}};C.extend(B,C.Base,{initializer:function(L){this._contacts={};this._ignoredUsers=[];this._invisibleList=[];this._visibleList=[];this._pendingAddRequests={};this._incomingAddRequests={};this._presenceReceived=false;this._bufferedAddRequests=[];this._imContacts=0;this._mobileContacts=0;},destructor:function(){if(this._abUtils){this._abUtils.destroy();delete this._abUtils;}if(this._addReqThrottleTimer){this._addReqThrottleTimer.cancel();delete this._addReqThrottleTimer;}},start:function(){var L=E.loginData,M=E.abData;if(L){this.processBuddies(L.contacts);}if(M){this._handleAddressBookData(M);delete E.abData;}C.Global.on(K.AB_DATA_RECEIVED,this._handleAddressBookData,this);this._startListening();C.Global.on(K.CONNECTION_UPDATE,C.bind(this._handleConnectionChange,this));this.set("started",true);},getIgnoreList:function(){return this._ignoredUsers;},addBuddy:function(M){var N=M.user,L=M.network||"yahoo",T=M.group||A.get("str_conv_default_group"),V=M.message||"",U=M.addressbook||{},Q={addressbook:M.addressbook},P=[N,L].join("~"),S=B.REQUESTS.ADD_USER,R=M.addAs,O;if(L!="yahoo"){this._pendingAddRequests[P]=M;}O={message:V,addressbook:U};if(R){O.addAs=R;}J.issueRequest({successCallback:C.bind(function(W){if(!this._contacts[P]){Q.user=N;Q.network=L;Q.groups=[T];Q.authorized=0;Q.type="buddy";this._addContact(Q);C.Global.fire(K.ADD_CONTACT_SENT,Q);}else{Q=this._contacts[P];Q.groups=Q.groups||[];if(Q.type=="buddy"){throw new Error("Attempted to send an add request to an existing Messenger Buddy");}Q.type="buddy";Q.authorized=0;Q.groups.push(T);this._updateContact(Q);}M.successCallback&&M.successCallback(W);},this),errorCallback:M.errorCallback,method:S.method,path:H.substitute(S.path,{user:encodeURIComponent(N),network:encodeURIComponent(L),groupname:encodeURIComponent(T)}),postBody:O});},acceptAddRequest:function(N){var P=N.alias,O=N.user,M=N.network||"yahoo",T=B.REQUESTS.ACCEPT_ADD,S=[O,M].join("~"),U=this._incomingAddRequests[S],Q=P?{authAs:P}:{},R=this.getContact(O,M),L;J.issueRequest({successCallback:C.bind(function(V){delete this._incomingAddRequests[S];N.successCallback&&N.successCallback(V);},this),errorCallback:N.errorCallback,method:T.method,path:H.substitute(T.path,{user:encodeURIComponent(O),network:encodeURIComponent(M)}),postBody:Q});if(!R||R.type!="buddy"){L={alias:P,user:O,network:M,addressbook:{firstname:U.fname||"",lastname:U.lname||"",nickname:U.nickName||"",mobileno:U.mobileNumber||""},successCallback:C.bind(function(V){this.addContacts([{user:O,network:M,authorized:0,firstname:U.fname,lastname:U.lname,nickname:U.nickName,mobileno:U.mobileNumber}]);},this)};this.addBuddy(L);}},abContactDeleted:function(L){var O=this.getContacts(),N,M;for(N=0;N<O.length;N++){if(O[N].addressbookId==L){this.unsubscribeForPresence([{id:O[N].user,network:O[N].network}]);M=[O[N].user,O[N].network].join("~");C.Global.fire(K.CONTACT_DELETED,this._contacts[M]);delete this._contacts[M];break;}}},abContactsUpdated:function(L){this.addContacts(L);this._subscribeABContacts();},getIMContactCount:function(){return this._imContacts;},getMobileContactCount:function(){return this._mobileContacts;},declineAddRequest:function(S){var O=S.alias,M=S.user,R=S.network||"yahoo",Q=B.REQUESTS.DENY_ADD,N=[M,R].join("~"),P=this._incomingAddRequests[N],L=O?{authAs:O}:{};if(S.message){L.authReason=S.message;}J.issueRequest({successCallback:C.bind(function(T){delete this._incomingAddRequests[N];S.successCallback&&S.successCallback(T);},this),errorCallback:S.errorCallback,method:Q.method,path:H.substitute(Q.path,{user:encodeURIComponent(M),network:encodeURIComponent(R)}),postBody:L});},removeContactFromGroup:function(S){var P=B.REQUESTS.DELETE_USER,N=S.user,Q=S.network||"yahoo",R=S.group,M=this._contacts[[N,Q].join("~")],O,L;J.issueRequest({method:P.method,path:H.substitute(P.path,{user:encodeURIComponent(N),network:encodeURIComponent(Q),groupname:encodeURIComponent(R)}),successCallback:function(T){for(O=0,L=M.groups.length;O<L;O++){if(M.groups[O]==R){M.groups.splice(O,1);break;}}C.Global.fire(K.CONTACT_REMOVED_FROM_GROUP,{"user":N,"network":Q,"group":R});S.successCallback&&S.successCallback(T);},errorCallback:S.errorCallback});},deleteContact:function(S){var Q,N,O=S.user,R=S.network,P=[O,R].join("~"),M=this._contacts[[O,R].join("~")],L=M.groups.slice(0);for(Q=0,N=L.length;Q<N;Q++){this.removeContactFromGroup({user:O,network:R,group:L[Q]});}M.groups=[];if(window.openmail){if(R=="facebook"){C.Global.fire(K.CONTACT_REMOVED_FROM_GROUP,{"user":O,"network":R,"group":A.get("str_cont_list_facebook_group_id")});}else{C.Global.fire(K.CONTACT_REMOVED_FROM_GROUP,{"user":O,"network":R,"group":A.get("str_cont_list_default_group_id")});
}}C.Global.fire(K.CONTACT_DELETED,M);delete this._contacts[P];},showDeleteConfirm:function(R){if(!(R&&R.user&&R.network)){return;}var O=R.user,N=R.network,M=O+"~"+N,Q=this.getContact(O,N);if(!Q){return;}var T,P,S=A.get("str_del_contact_msg_header"),L=C.bind(function(V){if(C.Lang.isObject(V)&&V.checked&&Q.type!=="addressbook"){this.unsubscribeForPresence([{id:O,network:N}]);C.Global.fire(K.DELETE_FROM_AB,Q);this.deleteContact(R);}else{if(P===undefined){this.unsubscribeForPresence([{id:O,network:N}]);C.Global.fire(K.DELETE_FROM_AB,Q);this.deleteContact(R);}else{var U=A.get("str_del_contact_msg_not_deleted_ab");U=H.substitute(U,{"contact_highlighted":"<strong>"+Q.displayname+"</strong>","str_cont_list_default_group_name":A.get("str_cont_list_default_group_name"),"str_cfg_generic_messenger":A.get("str_cfg_generic_messenger"),"str_messenger_options":H.substitute(A.get("str_menu_messenger_options"),{"str_cfg_branding_messenger":A.get("str_cfg_generic_messenger")}),"line_spacing":"<p>"});C.Messenger.WindowManager.alert(U,null,S,"warning");this.deleteContact(R);}}},this);if(Q.type==="addressbook"){T=A.get("str_del_contact_msg_ab_only_desc");T=H.substitute(T,{"contact_highlighted":"<strong>"+Q.displayname+"</strong>","contact":Q.displayname,"str_cont_list_default_group_name":A.get("str_cont_list_default_group_name"),"str_cfg_generic_messenger":A.get("str_cfg_generic_messenger"),"str_messenger_options":H.substitute(A.get("str_menu_messenger_options"),{"str_cfg_branding_messenger":A.get("str_cfg_generic_messenger")}),"line_spacing":"<p>"});}else{callInternal("getNeoString",{key:"str_branding_mail"},function(U){T=A.get("str_del_contact_msg_messenger_desc");T=H.substitute(T,{"contact_highlighted":"<strong>"+Q.displayname+"</strong>","str_cfg_generic_messenger":A.get("str_cfg_generic_messenger")});P=A.get("str_del_contact_msg_also_delete_ab");P=H.substitute(P,{"str_cfg_branding_mail":U.value});C.Messenger.WindowManager.confirm(T,L,null,S,null,P,A.get("str_delete"));});return;}C.Messenger.WindowManager.confirm(T,L,null,S,null,P,A.get("str_delete"));},blockUser:function(O){var M=B.REQUESTS.BLOCK_USER,L=O.user,N=O.network||"yahoo";C.Global.fire(K.ACK_CONVERSATION,{"alias":G.get("loggedInId"),"user":L,"network":N});J.issueRequest({successCallback:C.bind(function(P){this._ignoredUsers.push({user:L,network:N});C.Global.fire(K.USER_BLOCKED,{user:L,network:N});O.successCallback&&O.successCallback(P);},this),errorCallback:O.errorCallback,method:M.method,path:M.path,postBody:{members:[{"id":L,"network":N}]}});},unblockUser:function(L){this.unblockUsers({members:[{id:L.user,network:L.network}]});},unblockUsers:function(M){var L=B.REQUESTS.UNBLOCK_USER;J.issueRequest({method:L.method,path:L.path,postBody:{members:M.members},successCallback:C.bind(function(P){var O,N,Q;for(O=0;O<M.members.length;O++){Q=M.members[O];for(N=0;N<this._ignoredUsers.length;N++){if(this._ignoredUsers[N].user==Q.id){this._ignoredUsers.splice(N,1);break;}}C.Global.fire(K.USER_UNBLOCKED,{user:Q.id,network:Q.network||"yahoo"});}M.successCallback&&M.successCallback(P);},this),errorCallback:M.errorCallback});},showReportAbuseDialog:function(L){C.Global.fire(K.SHOW_WINDOW,D.REPORT_ABUSE_WINDOW,null,{user:L.user,alias:G.get("loggedInId"),network:L.network||"yahoo"});},reportSpam:function(O){var W=B.REQUESTS.REPORT_SPAM,X,V,P,S=O.alias,Q=O.user,N=O.network,M=O.initiatedBy,R,T,U=O.spims||[],L;if(!U.length){X=H.getConversationId(S,Q,N);V=C.Messenger.ConversationManager.getConversation(X);if(!P&&V){P=V.getMessages();}if(!P||!P.length){this.reportAbuse(O);return;}for(R=0,T=P.length;R<T&&R<50;R++){L={message:P[R].content,initiatedBy:P[R].fromSelf?1:2};if(P[R].hash){L.hash=P[R].hash;}U.push(L);}}if(!M){M=U[0].initiatedBy;}J.issueRequest({method:W.method,path:W.path,postBody:{spammerId:Q,spammedAs:S,initiatedBy:M,network:N,spims:U},successCallback:O.successCallback,errorCallback:O.errorCallback});},reportAbuse:function(R){if(R!==null){var M=H.getYidFromEmailAddr(R.user,R.network),L=M.value,P=R.network,N=R.alias||G.get("loggedInId");if(L&&P){var S=H.getConversationId(N,L,P),O,Q;if(S){Q=C.Messenger.ConversationManager.getConversation(S);O=Q.getMessages();this.openReportAbuseWindow(N,L,P,O);}}}},openReportAbuseWindow:function(V,S,O,R){var L=A.get("str_urls_report_abuse"),P,X="\r\n{{userid}} ({{time}}): {{message}}",U,W,M,Q="";if(window.launchData&&E.intl!=="us"){window.open(L,"_blank");return;}for(U=0,W=R.length;U<W;U++){M=R[U];var N=M.time?new Date(M.time*1000):new Date(),Y=C.DataType.Date.format(N,{format:E.dtf}),T=document.createElement("DIV");T.innerHTML=M.content;Q+=H.substitute(X,{userid:M.fromSelf===true?V:S,time:Y,message:T.textContent||T.innerText});}P={reporterYID:V,abuserYID:S,messengerAbuseChatLog:Q};H.postToURL(L,P);},addToVisibleList:function(M){var L=B.REQUESTS.VISIBLE_LIST_ADD;if(this.isContactOnInvisibleList(M.user,M.network)){this.removeFromInvisibleList(M);}J.issueRequest({method:L.method,path:L.path,postBody:{members:[{id:M.user,network:M.network}]},successCallback:C.bind(function(N){this._visibleList.push({user:M.user,network:M.network});M.successCallback&&M.successCallback(N);C.Global.fire(K.VISIBILITY_CHANGED,{user:M.user,network:M.network,visible:true});},this),errorCallback:M.errorCallback});},removeFromVisibleList:function(O){var M=B.REQUESTS.VISIBLE_LIST_DELETE,L=O.user,N=O.network;J.issueRequest({method:M.method,path:M.path,postBody:{members:[{id:L,network:N}]},successCallback:C.bind(function(S){var Q,P,R;for(Q=0,P=this._visibleList.length;Q<P;Q++){R=this._visibleList[Q];if(R.user==L&&R.network==N){this._visibleList.splice(Q,1);break;}}O.successCallback&&O.successCallback(S);C.Global.fire(K.VISIBILITY_CHANGED,{user:L,network:N,visible:this.isContactVisible(L,N)});},this),errorCallback:O.errorCallback});},addToInvisibleList:function(M){var L=B.REQUESTS.INVISIBLE_LIST_ADD;if(this.isContactOnVisibleList(M.user,M.network)){this.removeFromVisibleList(M);}J.issueRequest({method:L.method,path:L.path,postBody:{members:[{id:M.user,network:M.network}]},successCallback:C.bind(function(N){this._invisibleList.push({user:M.user,network:M.network});
M.successCallback&&M.successCallback(N);C.Global.fire(K.VISIBILITY_CHANGED,{user:M.user,network:M.network,visible:false});},this),errorCallback:M.errorCallback});},removeFromInvisibleList:function(O){var M=B.REQUESTS.INVISIBLE_LIST_DELETE,L=O.user,N=O.network;J.issueRequest({method:M.method,path:M.path,postBody:{members:[{id:L,network:N}]},successCallback:C.bind(function(S){var Q,P,R;for(Q=0,P=this._invisibleList.length;Q<P;Q++){R=this._invisibleList[Q];if(R.user==L&&R.network==N){this._invisibleList.splice(Q,1);break;}}O.successCallback&&O.successCallback(S);C.Global.fire(K.VISIBILITY_CHANGED,{user:L,network:N,visible:this.isContactVisible(L,N)});},this),errorCallback:O.errorCallback});},getContacts:function(P,N){var M=[],L;for(var O in this._contacts){L=this._contacts[O];if(this._contacts.hasOwnProperty(O)&&(!P||L.presence.state>-1)&&(N||L.network!="sms")){M.push(C.clone(L));}}return M;},getFacebookContacts:function(){var M=[],L;for(var N in this._contacts){L=this._contacts[N];if(this._contacts.hasOwnProperty(N)&&(L.network=="facebook")){M.push(C.clone(L));}}return M;},isContactInGroup:function(O,M){var L=this.getContactGroups(M),N;for(N=0;N<L.length;N++){if(L[N]==O){return true;}}return false;},findContactWithMobileNo:function(M){var N,L;for(N in this._contacts){if(this._contacts.hasOwnProperty(N)){L=this._contacts[N];if(L.mobileno&&H.normalizeNumber(L.mobileno)==M){return L;}}}},getContactById:function(P){var M=this._contacts[P];if(M){return C.clone(M);}else{var L=P.split("~"),N=L[0],O=L[1];return this._normalizeContact({user:N,network:O,type:"temporary"});}},isUserInContactList:function(L,M){if(this._contacts[[L,M].join("~")]){return true;}return false;},getContactGroups:function(L){if(!L.groups&&!L.displayGroup&&window.openmail){if(L.network==="facebook"){L.displayGroup=A.get("str_cont_list_facebook_group_id");}else{if(L.network=="sms"){L.displayGroup=A.get("str_cont_list_default_mobile_group_id");}else{L.displayGroup=A.get("str_cont_list_default_group_id");}}}return L.displayGroup?[L.displayGroup]:L.groups;},isPresenceAvailable:function(){return this._presenceReceived;},getIncomingAddRequests:function(){return this._incomingAddRequests;},_startListening:function(){J.addListeners([{id:"buddyInfo",callback:C.bind(this._handleBuddyInfo,this)},{id:"logOff",callback:C.bind(this._handleBuddyLogoff,this)},{id:"ignoreList",callback:C.bind(this._handleIgnoreList,this)},{id:"invisibleList",callback:C.bind(this._handleInvisibleList,this)},{id:"buddyStatus",callback:C.bind(this._handleBuddyStatus,this)},{id:"buddyAuthorize",callback:C.bind(this._handleBuddyAuthorize,this)},{id:"displayImage",callback:C.bind(this._handleDisplayImage,this)},{id:"removeBuddy",callback:C.bind(this._handleRemoveBuddy,this)},{id:"addResponse",callback:C.bind(this._handleAddResponse,this)},{id:"buddyMove",callback:C.bind(this._handleBuddyMove,this)},{id:"renameGroup",callback:C.bind(this._handleRenameGroup,this)},{id:"editIgnoreList",callback:C.bind(this._handleEditIgnore,this)},{id:"editInvisibleList",callback:C.bind(this._handleEditInvisible,this)},{id:"editVisibleList",callback:C.bind(this._handleEditVisible,this)},{id:"avatarImage",callback:C.bind(this._handleAvatarImage,this)},{id:"displayImagePrefs",callback:C.bind(this._handleDisplayImgPrefs,this)}]);},_handleAddressBookData:function(L){if(!this._abUtils){this._abUtils=new C.Messenger.ABUtils();}this._abUtils.parse(L,C.bind(function(M){this.addContacts(M);this.set("ABDataReceived",true);C.later(1000,this,this._subscribeABContacts);},this));},_subscribeABContacts:function(){if(!G.isOnline()){return;}var P,L,O,M=[],N=G.get("presenceSubscriptionsMaxPerRequest");for(P in this._contacts){if(this._contacts.hasOwnProperty(P)){L=this._contacts[P];if(!L.subscribed&&L.type=="addressbook"&&L.network!="sms"&&!G.isSelfUser(L.user)){O={id:L.user};if(L.network!="yahoo"){O.network=L.network;}L.subscribed=true;M.push(O);if(M.length==N){this.subscribeForPresence(M);M=[];}}}}if(M.length){this.subscribeForPresence(M);}},subscribeForPresence:function(L){var M=B.REQUESTS.SUBSCRIBE_PRESENCE;J.issueRequest({type:"PRESENCE",method:M.method,path:M.path,args:M.args,postBody:{members:L}});},unsubscribeForPresence:function(L){var M=B.REQUESTS.UNSUBSCRIBE_PRESENCE;J.issueRequest({type:"PRESENCE_OFF",method:M.method,path:M.path,args:M.args,postBody:{members:L}});},_handleConnectionChange:function(L){if(!L.isOnline){for(var M in this._contacts){if(this._contacts.hasOwnProperty(M)){this._contacts[M].presence={state:-1,message:""};if(this._contacts[M].type=="addressbook"){this._contacts[M].subscribed=false;}}}this._presenceReceived=false;}else{this._subscribeABContacts();}},isContactVisible:function(N,P){var Q=[N,P].join("~"),O,M,L;if(G.isInvisible()){return this.isContactOnVisibleList(N,P);}else{return !this.isContactOnInvisibleList(N,P);}},isContactOnVisibleList:function(N,P){var O,M,L;for(O=0,M=this._visibleList.length;O<M;O++){L=this._visibleList[O];if(L.user==N&&L.network==P){return true;}}return false;},isContactOnInvisibleList:function(N,P){var O,M,L;for(O=0,M=this._invisibleList.length;O<M;O++){L=this._invisibleList[O];if(L.user==N&&L.network==P){return true;}}return false;},isUserBlocked:function(L,M){return this.isUserIgnored(L,M)||this.isBlockedNonContact(L,M);},isUserIgnored:function(M,P){var N,L,O;for(N=0,L=this._ignoredUsers.length;N<L;N++){O=this._ignoredUsers[N];if(O.user==M&&O.network==P){return true;}}return false;},isBlockedNonContact:function(L,M){return F.get("blockNonContacts")&&(M!=="sms")&&!this.isUserInContactList(L,M);},getPendingAddRequest:function(L,M){return this._incomingAddRequests[[L,M||"yahoo"].join("~")];},getPendingAddRequests:function(){var M,L=[];for(M in this._incomingAddRequests){if(this._incomingAddRequests.hasOwnProperty(M)){L.push(this._incomingAddRequests[M]);}}return L;},addContacts:function(N){var M,L;for(M=0;M<N.length;M++){L=N[M].contact||N[M];this._addContact(L);}},processBuddies:function(O){var N,M,L;for(N=0,M=O.length;N<M;N++){L=O[N].contact||O[N];
L.type="buddy";O[N]=L;}this.addContacts(O);},_addContact:function(L){L.user=L.user||L.id||L.sender;L.network=L.network||"yahoo";var N=[L.user,L.network].join("~"),M;if(!this._contacts[N]){L.hash=I++;M=this._normalizeContact(L);if(L.network==="facebook"&&L.displayname===L.user){return null;}this._contacts[N]=M;H.arrayFire(K.CONTACTS_ADDED,[L]);}else{this._updateContact(L);}if(L.network=="sms"){this._mobileContacts++;}else{this._imContacts++;}return this._contacts[N];},_updateContact:function(M){M.user=M.user||M.id||M.sender;M.network=M.network||"yahoo";var N=[M.user,M.network].join("~"),L=this._contacts[N];if(!L){return this._addContact(M);}else{C.mix(L,this._normalizeContact(M,true),true,null,0,true);H.arrayFire(K.CONTACTS_UPDATED,[this._contacts[N]]);}return this._contacts[N];},viewFacebookProfile:function(L){var O="",N="",M=L.network;if(M=="facebook"){O=(L.user).replace("@chat.facebook.com","").replace("-","");O=encodeURIComponent(O);N="http://www.facebook.com/profile.php?id="+O;window.open(N,"_newtab");}},getContact:function(L,M){return this.getContactById([L,M].join("~"));},updateContact:function(N,P,M){var S=this._contacts[[N,P].join("~")],O,L,R=M.mobileno,Q=S.mobileno;if(!S){return null;}this._updateContact(M);if(R&&R!==Q){O=B.REQUESTS.UPDATE_USER;L={addressbook:{id:M.addressbookId,mobileno:R}};J.issueRequest({method:O.method,path:H.substitute(O.path,{user:encodeURIComponent(N),network:encodeURIComponent(P)}),postBody:L});}},getContactDisplayImage:function(L,M){if(typeof(L)!="object"){L=this._contacts[L];}M=M||"32";var N=L&&L.imageUrl?L.imageUrl:this._getContactDisplayImage(L);return H.substitute(N,{"pixels|32|48":M});},isNonBuddyInterOpUser:function(M,N){N=N||"yahoo";var P,L,O=false;if(N!=="yahoo"&&N!=="sms"&&N!=="facebook"){P=M+"~"+N;L=this._contacts[P];O=!(L&&L.type==="buddy"&&L.authorized);}return O;},_getContactDisplayImage:function(L){if(L.url){if(L.network=="facebook"){delete L.url;return H.getImageUrl(L);}else{return L.url;}}else{return H.getImageUrl(L);}},_normalizeContact:function(N,M){N.user=N.user||N.id||N.sender;N.network=N.network||"yahoo";var P,L;if(typeof N.presenceState!="undefined"){N.presence=H.normalizePresenceState(N);}else{if(!M){N.presence=N.presence||{state:-1,message:""};}}if(typeof(N.authorized)!="undefined"||!M){N.authorized=N.authorized===0?false:true;}var O=N.clientCapabilities;if(O!==undefined&&O!==""&&C.Lang.isNumber(O)){N.clientCapabilities={};N.clientCapabilities.richText=!!(O&1);N.clientCapabilities.smileys=!!(O&2);N.clientCapabilities.buzz=!!(O&4);N.clientCapabilities.fileXfer=!!(O&32768);N.clientCapabilities.voice=!!(O&65536);N.clientCapabilities.video=!!(O&4194304);N.clientCapabilities.typing=!!(O&8388608);N.clientCapabilities.videoDevice=!!(O&16777216);}else{if(!M){N.clientCapabilities={};if(N.network==="yahoo"){N.clientCapabilities.richText=true;N.clientCapabilities.smileys=true;N.clientCapabilities.buzz=true;N.clientCapabilities.fileXfer=true;N.clientCapabilities.voice=true;N.clientCapabilities.video=true;N.clientCapabilities.typing=true;N.clientCapabilities.videoDevice=true;}}}if(!M){N.clientType=N.clientType||"0";if(!N.type){N.type=N.addressbook?"addressbook":"buddy";}}if(N.addressbook){C.aggregate(N,N.addressbook,false);N.displayname=this.getContactDisplayName(N);}else{if(!M){N.displayname=N.displayName||N.user;}}if(window.openmail){if(N.network==="facebook"){N.displayGroup=A.get("str_cont_list_facebook_group_id");}else{if(N.network=="sms"){N.displayGroup=A.get("str_cont_list_default_mobile_group_id");}else{N.displayGroup=A.get("str_cont_list_default_group_id");}}}if(N.groups||!M){N.groups=N.groups||[];for(P=0,L=N.groups.length;P<L;P++){if(N.groups[P].group){N.groups[P]=N.groups[P].group;}if(N.groups[P].name){N.groups[P]=N.groups[P].name;}}}return N;},getContactDisplayName:function(N){var P="",M=C.Lang.trim,L,O;if(N.displayname){return N.displayname;}if(N.nickname&&N.nickname!=N.user){P=N.nickname;}else{if(N.firstname){if(N.lastname){L=A.get("str_session_display_name_order_no_trans");O=H.substitute(L?L:"{{first}} {{last}}",{first:N.firstname,last:N.lastname});P=O;}else{P=N.firstname;}}else{if(N.lastname){P=N.lastname;}else{if(N.user){P=N.user;}else{if(N.mobileno){P=N.mobileno;}}}}}P=H.escapeHtml(P);return P;},_handleBuddyInfo:function(O){this._presenceReceived=true;var N=O.contact,M;if(!N){return;}if(!N.length){N=[N];}for(M=0;M<N.length;M++){var L=N[M];L.user=L.sender;if(L.displayName){L.displayname=L.displayName;}this._updateContact(L);}},_handleBuddyLogoff:function(O){var M=O.buddy,N=O.network||"yahoo",L;if(O.echo){return;}L=this._contacts[[M,N].join("~")];if(L){L.presence.state=-1;L.presence.message="";H.arrayFire(K.CONTACTS_UPDATED,[L]);}},_handleIgnoreList:function(O){this._ignoredUsers=[];var P=O.ignoredUsers,L,M,N;for(M=0;M<P.length;M++){N=P[M].ignoredUser;this._ignoredUsers.push({user:N.id,network:N.network||"yahoo"});C.Global.fire(K.USER_BLOCKED,{user:N.id,network:N.network||"yahoo"});}},_handleInvisibleList:function(P){this._invisibleList=[];var R=P.users,L,N,Q,M,O;for(N=0;N<R.length;N++){Q=R[N].user;M=Q.id;O=Q.network||"yahoo";this._invisibleList.push({user:M,network:O});C.Global.fire(K.VISIBILITY_CHANGED,{user:M,network:O,visible:false});}},_handleEditIgnore:function(P){var M=P.userName,O=P.network||"yahoo",N,L;if(!P.errorCode&&P.type==1&&M){if(P.state==1){this._ignoredUsers.push({user:M,network:O});C.Global.fire(K.USER_BLOCKED,{user:M,network:O});}else{for(N=0,L=this._ignoredUsers.length;N<L;N++){if(this._ignoredUsers[N].user==M&&this._ignoredUsers[N].network==O){this._ignoredUsers.splice(N,1);C.Global.fire(K.USER_UNBLOCKED,{user:M,network:O});break;}}}}},_handleEditInvisible:function(Q){var S=Q.buddyList,O,N,L,M,P,R;if(!Q.errorCode&&Q.type==1){if(Q.command==3){while(this._invisibleList.length){M=this._invisibleList.pop();if(!G.isInvisible()||this.isOnVisibleList(M.user,M.network)){C.Global.fire(K.VISIBILITY_CHANGED,{user:M.user,network:M.network,visible:this.isContactVisible(M.user,M.network)});}}}else{for(O=0,L=S.length;O<L;O++){M=S[O].buddy;
P=S[O].network||"yahoo";if(Q.command==1){this._invisibleList.push({user:M,network:P});C.Global.fire(K.VISIBILITY_CHANGED,{user:M,network:P,visible:false});}else{for(N=0;N<this._invisibleList.length;N++){if(this._invisibleList[N].user==M&&this._invisibleList[N].network==P){this._invisibleList.splice(N,1);C.Global.fire(K.VISIBILITY_CHANGED,{user:M,network:P,visible:this.isContactVisible(M,P)});break;}}}}}}},_handleEditVisible:function(Q){var R=Q.buddyList,O,N,L,M,P;if(!Q.errorCode&&Q.type==1){if(Q.command==3){while(this._visibleList.length){M=this._visibleList.pop();C.Global.fire(K.VISIBILITY_CHANGED,{user:M.user,network:M.network,visible:this.isContactVisible(M.user,M.network)});}}else{for(O=0,L=R.length;O<L;O++){M=R[O].buddy;P=R[O].network||"yahoo";if(Q.command==1){this._visibleList.push({user:M,network:P});C.Global.fire(K.VISIBILITY_CHANGED,{user:M,network:P,visible:true});}else{for(N=0;N<this._visibleList.length;N++){if(this._visibleList[N].user==M&&this._visibleList[N].network==P){this._visibleList.splice(N,1);C.Global.fire(K.VISIBILITY_CHANGED,{user:M,network:P,visible:this.isContactVisible(M,P)});break;}}}}}}},_handleBuddyStatus:function(M){if(M.echo){return;}var L={contact:[M]};this._handleBuddyInfo(L);},_handleBuddyAuthorize:function(N){var M,L;N.network=N.network||"yahoo";N.user=N.user||N.sender;N.alias=N.receiver;L=[N.user,N.network].join("~");if(!N.echo&&N.status==0||N.status==3){if(this._addReqThrottleTimer){this._addReqThrottleTimer.cancel();delete this._addReqThrottleTimer;}this._incomingAddRequests[L]=N;this._addReqThrottleTimer=C.later(1000,this,function(){var O=this.getPendingAddRequests();if(O.length==1){C.Global.fire(K.CONTACT_AUTHORIZE_REQUEST,O[0]);}else{C.Global.fire(K.MULTIPLE_CONTACT_AUTHORIZE_REQUEST,O);}delete this._addReqThrottleTimer;});}else{if(N.status==1){N.authResponse=N.authState==1?"allow":"deny";if(this._contacts[L]){this._contacts[L].authorized=N.authState==1?1:0;}this._incomingAddRequests[L]&&delete this._incomingAddRequests[L];C.Global.fire(K.CONTACT_AUTHORIZE_RESPONSE,N);}else{M=[{user:N.receiver,network:N.network,authorized:0,mobileno:N.mobileNumber,firstname:N.fname,lastname:N.lname,nickname:N.nickName}];this.addContacts(M);C.Global.fire(K.CONTACTS_ADDED,M);}}},_handleDisplayImage:function(O){var M=O.sender,N=O.network||"yahoo",L=this._contacts[[M,N].join("~")];if(G.isSelfUser(M)){G.set("displayImage",O.url);C.Global.fire(K.SELF_IMAGE_UPDATED);}else{if(L){L.url=O.url;L.checksum=O.checksum;if(N=="facebook"){L.imageUrl=H.getImageUrl(L);delete L.url;}else{L.imageUrl=O.url;}C.Global.fire(K.CONTACT_IMAGE_UPDATED,L);}}},_handleAvatarImage:function(N){var M=N.sender,L=this._contacts[[M,"yahoo"].join("~")];if(L){L.avatarHash=N.avatarHash;L.url="";L.imageUrl=this._getContactDisplayImage(L);C.Global.fire(K.CONTACT_IMAGE_UPDATED,L);}},_handleDisplayImgPrefs:function(P){var M=P.sender,O=P.network||"yahoo",L=this._contacts[[M,O].join("~")],N;if(L){L.url="";L.imageUrl="";L.checksum=P.checksum;L.avatarHash=P.avatarHash;L.avatarPreference=P.avatarPreference;L.imageUrl=this._getContactDisplayImage(L);C.Global.fire(K.CONTACT_IMAGE_UPDATED,L);}else{if(!M&&G.isSelfUser(P.receiver)){P.network="yahoo";P.user=G.get("loggedInId");N=H.getImageUrl(P);G.set("displayImage",N);C.Global.fire(K.SELF_IMAGE_UPDATED);}}},_handleRemoveBuddy:function(R){if(R.type==1&&!R.errorCode){var N=R.buddy,Q=R.network||"yahoo",S=R.groupName,P=[N,Q].join("~"),M=this._contacts[P],O,L;if(M){if(S){for(O=0,L=M.groups.length;O<L;O++){if(M.groups[O]==S){M.groups.splice(O,1);break;}}}else{M.groups=[];}C.Global.fire(K.CONTACT_REMOVED_FROM_GROUP,{"user":N,"network":Q,"group":S});if(M.groups.length===0){C.Global.fire(K.CONTACT_DELETED,M);delete this._contacts[P];}}}},_handleAddResponse:function(N){var O=N.buddy?[{buddy:N.buddy,network:N.network||"yahoo"}]:N.buddyList,P,M,L;for(M=0,L=O.length;M<L;M++){P=[O[M].buddy,O[M].network||"yahoo"].join("~");if(this._pendingAddRequests[P]){if(N.errorCode){this._pendingAddRequests[P].errorCallback&&this._pendingAddRequests[P].errorCallback(N);}else{this._pendingAddRequests[P].successCallback&&this._pendingAddRequests[P].successCallback(N);}delete this._pendingAddRequests[P];}}},_handleBuddyMove:function(P){if(P.type==1&&P.buddyInfo){var O,N,R,S,Q,T,L,M;for(Q=0,T=P.buddyInfo.length;Q<T;Q++){if(!P.buddyInfo[Q].errorCode){O=P.buddyInfo[Q].buddy;N=P.buddyInfo[Q].network||"yahoo";R=[O,N].join("~");S=this._contacts[R];L=P.buddyInfo[Q].group;M=P.buddyInfo[Q].targetGroup;if(S){for(Q=0,T=S.groups.length;Q<T;Q++){if(S.groups[Q]==L){S.groups.splice(Q,1);break;}}S.groups.push(M);C.Global.fire(K.CONTACT_MOVED,{contact:S,oldGroup:L,newGroup:M});}}}}},_handleRenameGroup:function(P){if(P.type==1&&!P.errorCode){var R=P.groupName,O=P.newGroupName,M,N,L,Q;for(Q in this._contacts){if(this._contacts.hasOwnProperty(Q)){M=this._contacts[Q];for(N=0,L=M.groups.length;N<L;N++){if(M.groups[N]==R){M.groups[N]=O;break;}}}}C.Global.fire(K.GROUP_RENAMED,{groupName:R,newGroupName:O});}}});YUI.Messenger.ContactsManager=new B();}C.namespace("Messenger").ContactsManager=YUI.Messenger.ContactsManager;C.Command.registerModule("yim",C.Messenger.ContactsManager);},"@VERSION@",{requires:["base-base","requestmanager","command","yim-intl","commonutils","events","abutils"]});YUI.add("om-window-api",function(A){if(!YUI.namespace("Messenger").WindowAPI){YUI.Messenger.WindowAPI=(function(){var B=openmail.Application,C=10;return{LoadHidden:function(F,E,D){this.LoadWindow(F,E,{hidden:true});},LoadWindow:function(L,F,O,J){var N={id:F,view:launchData.blankHtml,target:O.target||"overlay",title:O.title,options:O},M=!O.hidden,G=0;N.options.hidden=true;if(N.target=="tab"){N.view=launchData.blankTabHtml;}if(F=="yimapp_mintymainwindow"){N.target="folderpane";}function P(Q){try{if(Q.document&&Q.document.body&&Q.document.body.className.indexOf("yim-basic-skin")>-1){return true;}}catch(R){}return false;}if(O.new_browser_window){var K,E,D=false,I;if(launchData.isSecure){I=window.location.href.split("messenger.html")[0]+"sblank.html?#vid="+F;}else{I=window.location.href.split("messenger.html")[0]+"blank.html?#vid="+F;}K=window.open(I,"_blank","resizable=1,status=0,toolbar=0,menubar=0,location=0,scrollbars=0,height="+O.height+",width="+O.width);if(K===null){throw new Error("Couldn't create a popout window - probably due to a popup blocker.  Window ID = "+F);}if(J){K.onabort=K.onunload=function(Q){if(K.closed){J({loadError:"Window closed before load completed."});}};if(!A.UA.ie){K.onload=function(Q){K.onabort=K.onunload=null;J(K);};}else{function H(Q){Q=Q||0;if(Q>200){return;}try{if(P(K)){K.onabort=K.onunload=null;D=true;J(K);}else{E=A.later(100,this,H,++Q);}}catch(R){}}E=A.later(100,this,H);K.attachEvent("onload",A.bind(function(){if(!D&&P(K)){if(E){E.cancel();E=null;}D=true;try{K.onabort=K.onunload=null;J(K);}catch(Q){}}},this));}}}else{G=B.openView(N,A.bind(function(){if((O.top||O.bottom)&&(O.left||O.right)){this.MoveTo(F,O.left,O.top,O.right,O.bottom);}if(M){this.Show(F);}if(!J){return;}function T(){var W=null;for(var V=top.frames.length;V--;){try{W=top.frames[V];if(W.openmail.Application.sendMessage.viewId==F){break;}}catch(X){}}return W;}var U,R=false,S=A.later(2000,null,function(){var V=T();R=true;J(V);});function Q(V,W){W=W||0;if(S){S.cancel();S=null;}if(W>1000){return;}if(R){return;}try{U=top.frames[V.id]||T();if(!P(U)){U=T();}if(P(U)){R=true;J(U);}else{A.later(10,null,function(){Q(V,W++);});}}catch(X){}}B.callWebService({url:"apps://",method:"GET",parameters:{cmd:"getFrameNameByViewId",args:{id:F}}},Q);},this));if(G){}}return G;},Unload:function(D){B.closeView({id:D});},GetViewport:function(D){callInternal("getViewport",null,function(E){D&&D({x0:E.scrollX,y0:E.scrollY,dx:E.width,dy:E.height});});},Restore:function(D){callInternal("restoreView",{id:D});A.Global.fire("ytogo.WindowRestored",D);},Minimize:function(F,E,D){D=D||27;callInternal("minimizeView",{id:F,width:E,height:D});A.Global.fire("ytogo.WindowMinimized",F);},Hide:function(D){callInternal("hideView",{id:D});A.Global.fire("ytogo.WindowHidden",D);},Show:function(D){callInternal("showView",{id:D});A.Global.fire("ytogo.WindowShown",D);},MakeTopMostDiv:function(D){callInternal("makeTopMostView",{id:D});A.Global.fire("ytogo.WindowBroughtToFront",D);},Focus:function(D){callInternal("focusView",{id:D});},SetTitle:function(E,D){D.id=E;callInternal("setTabTitle",D);},BeginMove:function(D){this.MakeTopMostDiv(D);callInternal("beginMoveView",{id:D});},Move:function(F,E,D){callInternal("moveView",{id:F,dx:E,dy:D});},EndMove:function(D){callInternal("endMoveView",{id:D});},MoveTo:function(I,H,G,E,D,F){callInternal("moveViewTo",{id:I,"left":H,"top":G,"right":E,"bottom":D});if(F){this.RestrictToViewport(I);}},MoveToCenter:function(G,D,E,F){this.GetViewport(A.bind(function(H){var J=(H.dx/2-D/2)+H.x0,I=(H.dy/2-E/2)+H.y0;this.MoveTo(G,J,I,J+D,I+E);if(F){F();}},this));},DemoDock:function(D){callInternal("dockView",{id:D});},DemoUndock:function(D){callInternal("undockView",{id:D});},BeginResize:function(D){callInternal("beginResizeView",{id:D});},Resize:function(H,E,D,G,F){callInternal("resizeView",{id:H,dx:E,dy:D,left:G,top:F});A.Global.fire("ytogo.WindowResized",H);},EndResize:function(D){callInternal("endResizeView",{id:D});A.Global.fire("ytogo.WindowResized",D);},SetSize:function(G,E,D,F){callInternal("setViewSize",{id:G,width:E,height:D});A.Global.fire("ytogo.WindowResized",G);if(F){this.RestrictToViewport(G);}},GetPosAndSize:function(E,D){callInternal("getViewRegion",{id:E},D);},RestrictToViewport:function(F,D){var E=D&&D.top&&D.left&&D.width&&D.height?D:null;if(!E){this.GetPosAndSize(F,A.bind(function(G){this.RestrictToViewport(F,G);},this));}else{this.GetViewport(A.bind(function(G){var H=G.dy-C,J=G.dx-C,K=D.left,I=D.top;if(D.left<0){K=0;}else{if(D.left+D.width>J){K=J-D.width;}}if(D.top<0){I=0;}else{if(D.top+D.height>H){I=H-D.height;}}if(I!=D.top||K!=D.left){this.MoveTo(F,K,I);}},this));}}};})();}A.namespace("Messenger").WindowAPI=YUI.Messenger.WindowAPI;},"@VERSION@");YUI.add("oui-window-modder",function(A){A.namespace("Messenger").WindowModder=function(Q,K){K=K||{};var i=Q||A.config.win,H=i.document,P,m;var W=false,q=(i.external&&typeof i.XMLHttpRequest=="undefined"),L=false,Y=A.Messenger.WindowAPI,l="",T=0,C=0,O,J=false,S=false,R=false,G,e=false,b=false,a=false,o={},V,j=K.rtl||false;if(typeof(i.IOWA)==="object"){if(typeof(i.IOWA.rpc)==="object"){L=i.IOWA.rpc;}}function k(r){if((typeof(console)==="object")&&(typeof(console.log)==="function")){console.log(H.URL+": "+r);}}function Z(t,s,u,r){if(typeof r==="undefined"){r=false;}if(t.addEventListener){t.addEventListener(s,u,r);}else{t.attachEvent("on"+s,u);}}function c(t,s,u,r){if(typeof r==="undefined"){r=false;}if(t.removeEventListener){t.removeEventListener(s,u,r);}else{t.detachEvent("on"+s,u);}}function N(r){if(typeof(r)==="string"){r=A.one(H.body).one(r);}if(r){r.set("unselectable","on");r.setStyle("MozUserSelect","none");r.setStyle("WebkitUserSelect","none");}}function g(r){if(typeof(r)==="string"){r=A.one(H.body).one(r);}if(r){r.set("unselectable","off");r.setStyle("MozUserSelect","");r.setStyle("WebkitUserSelect","");}if(i.getSelection){var s=i.getSelection();s.collapse(H.body,0);}}function D(){if(i.getSelection){var s=i.getSelection();s.removeAllRanges();}else{try{if(H.selection.createRange){var r=H.selection.createRange();H.selection.empty();}}catch(t){}}}function f(r){i=r;H=i.document;}function M(r){if(r.move_only_x){S=r.move_only_x;}if(r.move_only_y){R=r.move_only_y;}if(r.resize_only_x){b=r.resize_only_x;}if(r.resize_only_y){a=r.resize_only_y;}}function h(r){if(O!==undefined){c(O,"mousedown",F);O=undefined;}if(r&&r!==""){var s=H.getElementById(r);if(s){O=s;Z(s,"mousedown",F);}}}function I(s,r){if(o[s]!==undefined){c(o[s],"mousedown",U);o[s]=undefined;}if(r&&r!==""){var t=H.getElementById(r);if(t){o[s]=t;Z(t,"mousedown",U);}}}function F(r){if(J){return;}J=true;n(r);}function U(r){if(e){return;}e=true;n(r);}function n(s){s=s||i.event;var r;var t;D();N(A.one(H.body));t=s.target?s.target:s.srcElement;t&&t.setCapture&&t.setCapture();if(P){Y.MakeTopMostDiv(m);Y.Show(m);Y.MakeTopMostDiv(l);}r=(t&&t.setCapture)?t:H;Z(r,"mousemove",B,true);Z(r,"mouseup",p,true);if(P){if(A.UA.ie){Z(P.document,"mousemove",B,true);Z(P.document,"mouseup",p,true);}else{Z(P,"mousemove",B,true);Z(P,"mouseup",p,true);}}T=s.screenX;C=s.screenY;if(J){Y.BeginMove(l);}if(e){V=t.id;Y.BeginResize(l);}}function p(s){s=s||i.event;var r;var t=s.target?s.target:s.srcElement;if(J){J=false;Y.EndMove(l);}if(e){e=false;Y.EndResize(l);}P&&Y.Hide(m);r=(t&&t.setCapture)?t:H;H.releaseCapture&&H.releaseCapture();c(r,"mouseup",p,true);c(r,"mousemove",B,true);if(P){if(A.UA.ie){c(P.document,"mousemove",B,true);c(P.document,"mouseup",p,true);}else{c(P,"mousemove",B,true);c(P,"mouseup",p,true);}}V=undefined;g(A.one(H.body));}function B(u){u=u||i.event;var t=(u.screenX-T),s=(u.screenY-C);if(J){if(S){s=0;}if(R){t=0;}if(W){k("calling OUI.window.Move("+l+", "+t+", "+s+")");}Y.Move(l,t,s);}else{if(e){if(b){s=0;}if(a){t=0;}var r,v;if(V=="IowaWindowResizerTop"){t=0;r=false;v=true;}else{if(V=="IowaWindowResizerBottom"){t=0;r=false;v=false;}else{if(V=="IowaWindowResizerLeft"){s=0;r=true;v=false;}else{if(V=="IowaWindowResizerRight"){s=0;r=false;v=false;}else{if(V=="IowaWindowResizerTopLeft"){r=true;v=true;}else{if(V=="IowaWindowResizerTopRight"){r=false;v=true;}else{if(V=="IowaWindowResizerBottomLeft"){r=true;v=false;}else{if(V=="IowaWindowResizerBottomRight"){r=false;v=false;}}}}}}}}if(j){r=!r;}Y.Resize(l,t,s,r,v);}}}function X(r){if(r.oui_div_id){l=r.oui_div_id;}if(typeof(r.gripper_element_id)!="undefined"){h(r.gripper_element_id);}if(typeof(r.resizer_element_id)!="undefined"){I(3,r.resizer_element_id);}if(typeof(r.top_resizer_element_id)!="undefined"){I(0,r.top_resizer_element_id);}if(typeof(r.top_right_resizer_element_id)!="undefined"){I(1,r.top_right_resizer_element_id);}if(typeof(r.right_resizer_element_id)!="undefined"){I(2,r.right_resizer_element_id);}if(typeof(r.bottom_right_resizer_element_id)!="undefined"){I(3,r.bottom_right_resizer_element_id);}if(typeof(r.bottom_resizer_element_id)!="undefined"){I(4,r.bottom_resizer_element_id);}if(typeof(r.bottom_left_resizer_element_id)!="undefined"){I(5,r.bottom_left_resizer_element_id);}if(typeof(r.left_resizer_element_id)!="undefined"){I(6,r.left_resizer_element_id);}if(typeof(r.top_left_resizer_element_id)!="undefined"){I(7,r.top_left_resizer_element_id);}}function d(s,r){P=r;m=s;}function E(){var r={};r.oui_div_id="";r.gripper_element_id="";r.resizer_element_id="";r.top_resizer_element_id="";r.top_right_resizer_element_id="";r.right_resizer_element_id="";r.bottom_right_resizer_element_id="";r.bottom_resizer_element_id="";r.bottom_left_resizer_element_id="";r.left_resizer_element_id="";r.top_left_resizer_element_id="";X(r);}return{setConstraints:M,setElementIds:X,clearElementIds:E,setBackingDiv:d,setWindowContext:f};};},"@VERSION@",{requires:["om-window-api"]});YUI.add("oui-basewindow",function(B){var F=B.Node,H="oui-modalwindow-event",A="oui-modalwindow-closed",D="oui-window-shown",J="oui-window-hidden",E="drag-backing-div",C=B.Messenger.WindowAPI,G=window.WINDOW_MOVEMENT_BACKER;function I(K){I.superclass.constructor.apply(this,arguments);}I.NAME="oui-basewindow";I.ATTRS={windowName:{value:"BaseWindow"},contentClass:{},requires:{},showChrome:{value:true},visible:{value:false},disabled:{value:false},waiting:{value:false},minimized:{value:false},modal:{value:false},startHidden:{value:false},startMinimized:{value:false},showClose:{value:true},showMaximize:{value:false},showMinimize:{value:false},allowResize:{value:true},allowMove:{value:true},startPosition:{value:{top:400,left:400}},startHeight:{value:200},startWidth:{value:200},minWidth:{value:0},minHeight:{value:0},limitToViewport:{value:true},centerOnShow:{value:false},cssFiles:{value:[]},cssClass:{value:""},cssLoaded:{value:false},contentObject:{value:null},srcWindow:{value:""},allowDisable:{value:true},title:{setter:function(L){if(L&&this._rendered&&this.get("showChrome")&&this._win){var K=B.one(this._win.document.body);if(K.one("#titleText")){K.one("#titleText")._node.innerHTML=L;}}if((this.get("windowType")=="browserWindow")&&this._win&&this._win.document){this._win.document.title=L;}else{if(this.get("windowType")=="mailTab"&&this._rendered){C.SetTitle(this.get("windowName"),{title:L});}}return L;}},windowContentType:{value:""},elementTitle:{value:""},rendered:{value:false},showPopOut:{value:false},showPopIn:{value:false},windowType:{value:"iframe"},ariaRole:{value:""},rtl:{value:false},iframeLocation:{value:"overlay"}};B.extend(I,B.Base,{initializer:function(K){this._eh=[];this._unloaded=false;if(K.initData){this._initData=K.initData;}},render:function(P,L){var K=this.get("windowName"),N=this.get("centerOnShow")?{}:this.get("startPosition")||{},M=this.get("windowType");if(this._rendered){throw new Error("Tried to render the same OUI window twice.  Window name = "+K);}this._rendered=true;N.id=K;N.hidden=true;N.height=this.get("startHeight");N.width=this.get("startWidth");N.minWidth=this.get("minWidth");N.minHeight=this.get("minHeight");N.limit_to_viewport=this.get("limitToViewport");N.title=this.get("title");N.store=false;N.elementTitle=this.get("elementTitle");N.ariaRole=this.get("ariaRole");if(M=="browserWindow"){N.new_browser_window=true;this.set("showMaximize",false);this.set("showMinimize",false);this.set("showClose",false);this.set("allowResize",false);this.set("allowMove",false);this.set("showPopIn",this.get("showPopOut"));this.set("showPopOut",false);}else{if(M=="mailTab"){N.target="tab";N.inactive=this.get("startHidden");this.set("showMaximize",false);this.set("showMinimize",false);this.set("showClose",false);this.set("allowResize",false);this.set("allowMove",false);this.set("showPopIn",false);this.set("showPopOut",false);}else{if(M=="iframe"){N.new_browser_window=false;N.target=this.get("iframeLocation");}}}if(!L){try{C.LoadWindow({},K,N,B.bind(function(Q){if(Q.loadError){if(M==="browserWindow"){this.set("windowType","iframe");this._rendered=false;this.render(P);}}else{this.initWindow(Q,P);}},this));}catch(O){if(M==="browserWindow"){this.set("windowType","iframe");this._rendered=false;this.render(P);}}}else{this.initWindow(L,P);}},initWindow:function(L,N){var K=this,M=this.get("windowType");this.set("rendered",true);this._win=L;this._win.windowName=this.get("windowName");if(this.get("ariaRole")!==""){this._win.document.body.setAttribute("role",this.get("ariaRole"));}if(this.get("allowResize")||this.get("allowMove")){this._windowModder=new B.Messenger.WindowModder(L,{rtl:this.get("rtl")});if(this._windowModder){if(!G){B.later(100,this,function(){C.LoadWindow({},E,{hidden:true,width:5000,height:5000,top:-500,left:-500,id:E},function(P){var O=B.one(P.document.body).one(".window-loading-div");if(O){O.setStyle("display","none");}window.WINDOW_MOVEMENT_BACKER=G=P;G.windowName=E;K._windowModder.setBackingDiv(E,G);});});}else{this._windowModder.setBackingDiv(E,G);}}}if(this.get("windowType")=="browserWindow"||!this.get("startHidden")){this.show();}this._injectContent(L,B.bind(function(O){if(M!="iframe"){if(M=="browserWindow"){if(this.get("title")){this._win.document.title=this.get("title");}this._addEventListener(this._win,"focus",B.bind(this.focus,this));this._addEventListener(this._win,"unload",B.bind(function(P){this.hide(true);},this));}else{this._win.focusHandler=B.bind(this.focus,this);this._win.closeHandler=B.bind(function(){this._unloaded=true;B.later(0,this,function(){this.hide(true);});},this);this._win.blurHandler=B.bind(this.blur,this);}this._addEventListener(this._win,"resize",B.bind(function(P){B.Global.fire("ytogo.WindowResized",this.get("windowName"));},this));}else{if(this.get("startMinimized")){this.minimize();}}N&&N(O);},this));},destructor:function(){B.each(this._eh,function(M){M.detach();});var K=this.get("contentObject");if(K&&K.destroy){try{K.destroy();}catch(L){}}if(!(this.get("windowType")=="browserWindow")){if(!this._unloaded){C.Unload(this.get("windowName"));}}else{this._win.close();}this._win=null;},show:function(N){if(!this._rendered){this.render();B.later(100,this,function(){this.show(N);});return;}if(!this.get("rendered")){B.later(100,this,function(){this.show(N);});return;}if(!this._pendingShowListener){if(!this.get("visible")){if(!this.get("cssLoaded")){this._pendingShowListener=this.after("cssLoadedChange",B.bind(function(){this._pendingShowListener.detach();this._pendingShowListener=null;this.show(N);},this));return;}var L=this.get("windowName"),M,K;if(this.get("centerOnShow")){C.MoveToCenter(L,this.get("startWidth"),this.get("startHeight"),B.bind(function(){C.Show(L);if(this.get("windowType")=="iframe"&&!this.get("disabled")){this.bringToFront();}},this));}else{C.Show(L);if(this.get("windowType")=="iframe"&&!this.get("disabled")){this.bringToFront();}}}this.onWindowShow(N);}},hide:function(M){if(this.get("visible")||M){var K=this.get("contentObject");if(K&&K.blur){try{K.blur();
}catch(L){}}this.onWindowHide();if(M){if(K&&K.onClose){K.onClose();}}else{if(this.get("windowType")=="browserWindow"){this.destroy();}}}},bringToFront:function(){if(this.get("windowType")=="browserWindow"){this.getDOMWindow().focus();this.focus();}else{if(this.get("windowType")=="mailTab"){openmail.Application.openView({id:this.get("windowName"),target:"tab",view:launchData.blankHtml});}else{C.MakeTopMostDiv(this.get("windowName"));}}},restore:function(){if((this.get("windowType")=="iframe")&&this.get("minimized")){var L=this.getDOMWindow(),K=B.one(L.document.body);this.set("minimized",false);K.removeClass("minimized");K.addClass("visible");if(this._windowModder){this._windowModder.setElementIds(this._modderIds);}C.Restore(this.get("windowName"));this.onWindowRestored();}},minimize:function(N){if((this.get("windowType")=="iframe")&&!this.get("minimized")){var M=this.getDOMWindow(),L=B.one(M.document.body);this.set("minimized",true);L.addClass("minimized");L.removeClass("visible");if(this._windowModder){this._windowModder.clearElementIds();}var K=this.get("windowName");C.Minimize(K);this.onWindowMinimized(N);}},onWindowMinimized:function(L){var K=this.get("contentObject");if(K&&K.onWindowMinimized){K.onWindowMinimized(L);}},onWindowRestored:function(){var K=this.get("contentObject");if(K&&K.onWindowRestored){K.onWindowRestored();}},onWindowShow:function(M){var L=this.get("windowName");this.set("visible",true);if(this.get("modal")){B.Global.fire(H,L);}var K=this.get("contentObject");if(K&&K.onWindowShow){K.onWindowShow(M);}},onWindowHide:function(){var L=this.get("windowName");if(this.get("modal")){B.Global.fire(A,L);}if(!(this.get("windowType")=="browserWindow")){C.Hide(L);}else{B.Global.fire("ytogo.WindowHidden",L);}this.set("visible",false);if(B.UA.ie===7){B.later(0,this,function(){try{this._win.document.body.className=this._win.document.body.className;}catch(M){}});}var K=this.get("contentObject");if(K&&K.onWindowHide){K.onWindowHide();}},focus:function(){var K=this.get("contentObject");if(!this.get("disabled")&&K&&K.focus){K.focus();}},blur:function(){var K=this.get("contentObject");if(K&&K.blur){K.blur();}},startWaiting:function(){if(this.get("waiting")){return;}this.set("waiting",true);var K=B.one(this._win.document.body);K.addClass("waiting");this.disableWindow(true);},stopWaiting:function(){if(!this.get("waiting")){return;}this.set("waiting",false);var K=B.one(this._win.document.body);K.removeClass("waiting");this.enableWindow();},disableWindow:function(N){var M,L=B.one(this._win.document.body);if(!this.get("disabled")&&(this.get("allowDisable")||N)){M=L.one("#disableOverlay");if(!M){M=this._win.document.createElement("div");M.id="disableOverlay";this._win.document.body.appendChild(M);M=B.one(M);this._eh.push(M.on("click",function(O){O.halt();}));this._eh.push(M.on("keydown",function(O){O.halt();}));this._eh.push(M.on("contextmenu",function(O){O.halt();}));this._eh.push(M.on("mousedown",function(O){O.halt();}));}else{M.removeClass("hidden");}this.set("disabled",true);var K=this.get("contentObject");if(K&&K.onWindowDisabled){K.onWindowDisabled();}}},enableWindow:function(){if(this.get("disabled")){B.one(this._win.document.body).one("#disableOverlay").addClass("hidden");this.set("disabled",false);var K=this.get("contentObject");if(K&&K.onWindowEnabled){K.onWindowEnabled();}}},getDOMWindow:function(){return this._win;},getBackingDiv:function(){return G;},loadFiles:function(L,K,N){var M=this;YUI().use("get",function(P){P.config.win=M._win;P.config.doc=M._win.document;var U=M._win,O=L.length,W=K=="css"?"css":"script",S,V={};function Q(){O--;if(O===0){N();}}function T(Y,a){a=a||0;var Z,b=U?U.document:P.config.doc,d=b.styleSheets,c=false;for(Z=d.length-1;Z>-1;Z--){if(d[Z].href===Y){if(P.UA.webkit){c=true;}else{try{d[Z].cssRules;c=true;}catch(X){if(X.code==X.INVALID_ACCESS_ERR){}else{c=true;}}}break;}}if(c||a>100){Q();}else{P.later(50,this,T,[Y,++a]);}}if(U){V.win=U;}V.onSuccess=function(X){if(K=="css"&&(P.UA.webkit||P.UA.gecko)){T(X.nodes[0].href);}else{Q();}};V.onFailure=function(X){X.purge();Q();};if(P.UA.ie){V.onSuccess=N;P.Get[W](L,V);}else{for(S=0;S<L.length;S++){try{P.Get[W](L[S],V);}catch(R){}}}});},loadModule:function(L,N){var M=this,K=this._win.Y;window.Y.use(L,function(O){K.config.bootstrap=true;K.use(L,function(P){P.config.bootstrap=false;M._copyCSS();N&&N();});});},_injectContent:function(N,Q){var P,K,L,O=this;function M(){var S,R,a=O.get("requires"),T=O.get("contentClass"),Y,W,X=window.Y,V,U=false,Z;if(T){W=T.split(".");for(V=0;V<W.length;V++){X=X[W[V]];}if(!X&&a){S=a;S.push(function(){O._copyCSS();M();});R=window.Y;R.use.apply(R,S);return;}}log("Doing YUI.use call for window "+O._win.windowName);R=YUI({win:O._win,bootstrap:false});Z=B.Object.keys(YUI.Env.mods);Z.unshift("intl");R.use(Z,function(b){log("YUI.use callback invoked for window "+O._win.windowName);O._win.Y=b;if(window.patchYUI&&b.Widget){b.Widget.prototype.oldWidgetDestructor=b.Widget.prototype.destructor;b.Widget.prototype.destructor=function(){var d=this.get("boundingBox"),c=this.get("contentBox");if(c===d){c.remove(true);d.remove=function(){};}this.oldWidgetDestructor();};}if(T){X=b;for(V=0;V<W.length;V++){X=X[W[V]];}Y=new X({windowName:O.get("windowName")});O.set("contentObject",Y);Y.render(P,O._initData);O._initData&&delete O._initData;}if(window.log){b["log"]=window.log;}if(!O.get("cssLoaded")){O.after("cssLoadedChange",function(){L.addClass("hidden");});}else{L.addClass("hidden");}Q&&Q(P);});}YUI().use("node",function(S){S.config.win=O._win;S.config.doc=O._win.document;P=S.one(N.document.body);L=P.one(".window-loading-div");function R(){var V=O.get("windowType"),U,T;if(!O.get("minimized")){P.addClass("visible");}if(V=="browserWindow"){P.addClass("poppedOut");}else{if(V=="mailTab"){P.addClass("mailTab");}}P.addClass(O.get("cssClass"));if(O.get("showChrome")){O._injectChrome(P);L=P.one(".window-loading-div");P=P.one("#iowaWindow-content-inner");}M();}O._copyCSS();R();});},_copyCSS:function(){this.set("cssLoaded",false);
var M=document.getElementsByTagName("link"),L=this._win.document.getElementsByTagName("link"),K,O,P,R,N=[],Q=this.get("cssFiles")||[];for(P=0;P<M.length;P++){K=M[P].href;if(K){R=false;for(O=0;O<L.length;O++){if(L[O].href==K){R=true;break;}}if(R){continue;}N.push(K);}}if(Q.length>0||N.length>0){this.loadFiles(N.concat(Q),"css",B.bind(function(){this.set("cssLoaded",true);},this));}else{this.set("cssLoaded",true);}},_injectChrome:function(P){var N,K,S,M,V=this.get("title"),O,Q=this.get("showClose"),T=this.get("showMinimize"),U=this.get("showPopOut"),L=this.get("showPopIn")&&!U;try{P.setContent(B.Messenger.OuiBaseWindow.baseTemplate);}catch(R){}B.later(0,this,function(){this._modderIds={oui_div_id:this.get("windowName")};if(this._windowModder){if(this.get("allowMove")){this._modderIds.gripper_element_id="titleBar";P.addClass("movable");}if(this.get("allowResize")){this._modderIds.resizer_element_id="resizeGripper";this._modderIds.left_resizer_element_id="IowaWindowResizerLeft";this._modderIds.right_resizer_element_id="IowaWindowResizerRight";this._modderIds.top_resizer_element_id="IowaWindowResizerTop";this._modderIds.bottom_resizer_element_id="IowaWindowResizerBottom";this._modderIds.top_left_resizer_element_id="IowaWindowResizerTopLeft";this._modderIds.top_right_resizer_element_id="IowaWindowResizerTopRight";this._modderIds.bottom_left_resizer_element_id="IowaWindowResizerBottomLeft";P.addClass("resizable");}this._windowModder.setElementIds(this._modderIds);}if(Q){K=P.one("#closeButton");O=K.get("parentNode");O.removeClass("hidden");this._eh.push(K.on("click",this.onCloseButtonClicked,this));this._eh.push(K.on("mousedown",function(W){W.halt();}));if(!T&&!U){O.addClass("left");}}if(T){N=P.one("#minMaxButton");O=N.get("parentNode");O.removeClass("hidden");this._eh.push(N.on("click",this.onMinimizeButtonClicked,this));this._eh.push(N.on("mousedown",function(W){W.halt();}));if(!Q&&!U){O.addClass("right");}}if(U){S=P.one("#popOutButton");O=S.get("parentNode");O.removeClass("hidden");this._eh.push(S.on("click",this.onPopOutButtonClicked,this));this._eh.push(S.on("mousedown",function(W){W.halt();}));if(!Q){O.addClass("right");}if(!T){O.addClass("left");}}if(L){M=P.one("#popInButton");O=M.get("parentNode");O.removeClass("hidden");if(!B.UA.ie){this._eh.push(M.on("click",this.onPopInButtonClicked,this));this._eh.push(M.on("mousedown",function(W){W.halt();}));}else{this._addEventListener(M._node,"click",B.bind(this.onPopInButtonClicked,this));}if(!Q){O.addClass("right");}if(!T){O.addClass("left");}}if(V){P.one("#titleText")._node.innerHTML=V;}else{P.one("#titleText").addClass("hidden");}});},_modifyChromeForNative:function(L){var M=L.one("#titleBar"),K=L.one("#resizeGripper");if(M){M.addClass("hidden");}if(K){K.addClass("hidden");}},onCloseButtonClicked:function(K){var L=this.get("contentObject");if(K){K.halt();}if(L&&L.onBeforeClose&&L.onBeforeClose()){return;}this.hide(true);},onMinimizeButtonClicked:function(K){var L=this.get("minimized");if(L){this.restore();}else{this.minimize(true);}K.halt();},onPopOutButtonClicked:function(K){var L=this.get("windowName");this.hide(false);B.Global.fire("ytogo:popoutWindow",L);},onPopInButtonClicked:function(K){B.Global.fire("ytogo:popinWindow",this.get("windowName"));},_addEventListener:function(M,L,K){if(M.addEventListener){M.addEventListener(L,K,false);}else{M.attachEvent("on"+L,K);}}});B.namespace("Messenger").OuiBaseWindow=I;I.baseTemplate='        <div id="IowaWindowDiv" class="iowa_window_div">\n\n	        <div class="header" id="titleBar">\n	            <h2 id="titleText"></h2>\n				<div class="shaded tools">\n		            <span class="btn small left hidden">\n		               <a id="minMaxButton" class="icon minimize" href="javascript:;"></a>\n		            </span>\n		            <span class="btn small hidden">\n                       <a id="popOutButton" class="icon pop_out" href="javascript:;"></a>\n                    </span>\n                    <span class="btn small hidden">\n                       <a id="popInButton" class="icon pop_in" href="javascript:;"></a>\n                    </span>\n		            <span class="btn small right hidden">\n		               <a id="closeButton" class="icon close" href="javascript:;"></a>\n		            </span>\n	            </div>\n	        </div>\n\n			<!-- CONTENT DIV -->\n			<div id="iowaWindow-content">\n                <div class="window-loading-div"></div>\n                <div id="iowaWindow-content-inner">\n                    <!-- Window content should be placed here -->\n                </div>\n			</div>\n\n	        <div id="resizeGripper">\n	        </div>\n	        \n	        <div class=\'iowa_window_div_overlay1\'></div>\n	        \n			<div id=\'IowaWindowResizerLeft\'  class=\'iowa_window_resizer_left\'></div>\n			<div id=\'IowaWindowResizerRight\' class=\'iowa_window_resizer_right\'></div>\n			\n			<div id=\'IowaWindowResizerTop\'    class=\'iowa_window_resizer_top\'></div>\n			<div id=\'IowaWindowResizerBottom\' class=\'iowa_window_resizer_bottom\'></div>\n			\n			<div id=\'IowaWindowResizerTopLeft\'  class=\'iowa_window_resizer_top_left\'></div>\n			<div id=\'IowaWindowResizerTopRight\' class=\'iowa_window_resizer_top_right\'></div>\n			\n			<div id=\'IowaWindowResizerBottomLeft\'  class=\'iowa_window_resizer_bottom_left\'></div>\n\n\n\n\n		</div>\n\n';},"@VERSION@",{requires:["intl","oui-window-modder","om-window-api","node"]});YUI.add("omapi",function(A){if(!YUI.namespace("Messenger").OMAPI){(function(){var D=openmail.Application,C=A.Messenger.Events,B;YUI.Messenger.OMAPI={setData:function(F,E){E=E||function(){};D.setData(F,E);},persistGroupToggle:function(G){var E=G.groupId,F=G.state,H={keys:{}};switch(E){case A.Messenger.ContactList.FACEBOOK_GROUP_ID:H.keys.fbgroupExpandPref=F=="collapsed"?0:1;break;case A.Messenger.ContactList.DEFAULT_GROUP_ID:H.keys.expandGroups=F=="collapsed"?0:1;break;default:return;}this.setData(H);},loadAddressBook:function(){callInternal("getAddressbook",null,function(E){var F=E.contactsync?E.contactsync.contacts:(E.contacts?E.contacts.contact:null);A.Global.fire(C.AB_DATA_RECEIVED,F);});},toggleBrowserTitle:function(E){callInternal("browser.toggleTitle",{title:E});},sendEmail:function(E){var F=E.email;if(!F&&E.network=="yahoo"){if(E.user.indexOf("@")>-1){F=E.user;}else{F=E.user+"@yahoo.com";}}openmail.Mail.compose({to:F});},deleteFromAB:function(G){if(!launchData.guid||!G.addressbookId){return;}var F=openmail.Application.getAuthService("delete"+G.addressbookId),E=["http://social.yahooapis.com/v1/user/",launchData.guid,"/contact/",G.addressbookId].join("");F.callWebService({url:E,method:"DELETE",parameters:{"format":"json"}},function(H){if(H.error){}else{callInternal("contactChanged",{});}});},showDialog:function(H,F){var G={hd:H,bd:F};var E=function(){};callInternal("alertDialog",G,E);}};A.Global.on(C.GROUP_COLLAPSE_CHANGE,YUI.Messenger.OMAPI.persistGroupToggle,YUI.Messenger.OMAPI);A.Global.on(C.DELETE_FROM_AB,YUI.Messenger.OMAPI.deleteFromAB);callInternal("setListener",{event:"mail.signout"},function(E){A.Messenger.SessionManager.quickLogout();});callInternal("setListener",{event:"contacts.changed"},function(J){var H=J.data.type,I=J.data.list,G,F,E;if(!I){A.Messenger.OMAPI.loadAddressBook();return;}for(G=0,F=I.length;G<F;G+=1){I[G]=+(I[G]);}if(H==="delete"){for(G=0,F=I.length;G<F;G+=1){A.Messenger.ContactsManager.abContactDeleted(I[G]);}}else{if(H==="add"||H==="update"){callInternal("getAddressbook",null,function(K){var L=K.contactsync?K.contactsync.contacts:(K.contacts?K.contacts.contact:null);if(L){A.Messenger.ABUtils.parseUpdate(L,I,H);}});}}});callInternal("setListener",{event:"themes:change"},function(E){if(!E||!E.css||!E.name){return;}A.Messenger.GlobalConfig.set("themeInfo",E);});openmail.Mail.sendKeyEvent=function(F){var E={keyCode:F.keyCode||0,charCode:F.charCode||0,type:F.type||"keydown",ctrlKey:F.ctrlKey||false,altKey:F.altKey||false,shiftKey:F.shiftKey||false,metaKey:F.metaKey||false};callInternal("sendKeyEvent",E);};A.Global.on(C.PRESENCE_PREF_UPDATED,function(F){var E=-1;F=Number(F);switch(F){case 9999:E=9999;break;case -1:E=12;break;case 0:E=0;break;case 2:E=2;break;case 999:default:}if(E!==-1){callInternal("setLoginPref",{value:E});}});A.Global.on(C.MESSAGE_SENT,function(){if(!B){B=A.later(0,null,function(){B=null;callInternal("triggerAds",{spaceId:"978500261",trace:"messenger",pageView:false});});}callInternal("trackEvent",{spaceId:"978500255",trace:"messenger"});});A.Global.on(C.IM_TAB_SWITCHED,function(){if(!B){B=A.later(500,this,function(){B=null;callInternal("triggerAds",{spaceId:"978500262",trace:"messenger",pageView:false});});}});A.Global.on(C.ADD_CONTACT_SENT,function(){callInternal("contactChanged",{});});})();A.Command.registerModule("yim",YUI.Messenger.OMAPI);}A.namespace("Messenger").OMAPI=YUI.Messenger.OMAPI;},"@VERSION@",{requires:["events"]});YUI.add("windowmanager",function(B){var H=YUI.namespace("Messenger"),K=B.Messenger.CommonUtils,L=H.Events,A=B.Messenger.Intl,J=B.Messenger.GlobalConfig,C=B.Messenger.GlobalConstants,G=B.Messenger.WindowAPI,I=window.log,E=B.Messenger.OMAPI,F=B.UA.ie===7?false:true,D=0;if(!H.WindowManager){H.WindowManager=(function(){function M(N){M.superclass.constructor.apply(this,arguments);}M.NAME="yim-windowmanager";M.ATTRS={};M.WINDOW_DEFINITIONS={"MintyMainWindow":{contentClass:"Messenger.MintyMainWindow",windowName:"MintyMainWindow",startHidden:false,startHeight:0,allowResize:false,showMaximize:false,allowMove:false,showChrome:false,limitToViewport:false,elementTitle:K.substitute(A.get("str_window_title_main"),{str_cfg_branding_messenger:J.getGenericAppName()}),allowDisable:true,ariaRole:"application",requires:["mintymainwindow"],iframeLocation:"folderpane",cssClass:"mintymainwindow"},"ContactMenuWindow":{showChrome:false,startHidden:true,startWidth:280,startHeight:184,requires:["contactmenuwindow"],contentClass:"Messenger.ContactMenuWindow"},"OptionsWindow":{allowResize:false,allowMove:true,showClose:true,allowDisable:true,showMaximize:false,showMinimize:false,centerOnShow:true,modal:false,startWidth:600,startHeight:500,elementTitle:K.substitute(A.get("str_window_title_options"),{str_cfg_branding_messenger:J.getGenericAppName()}),title:K.substitute(A.get("str_nav_opt_msg_title"),{str_cfg_branding_messenger:J.getGenericAppName()}),cssClass:"yim_dialog optionswindow",ariaRole:"application",requires:["optionswindow"],contentClass:"Messenger.OptionsWindow"},"SignoutWindow":{allowMove:true,allowResize:false,startHidden:false,showMaximize:false,showMinimize:false,showClose:true,centerOnShow:true,modal:true,startWidth:510,startHeight:B.UA.ie===7?197:178,limit_to_viewport:true,title:K.substitute(A.get("str_menu_sign_out_messenger"),{str_cfg_branding_messenger:J.getGenericAppName()}),elementTitle:K.substitute(A.get("str_window_title_signout"),{str_cfg_branding_messenger:J.getGenericAppName()}),cssClass:"yim_dialog signoutwindow",destroyOnHide:true,ariaRole:"application",requires:["signoutwindow"],contentClass:"Messenger.SignOutWindow"},"DialogWindow":{allowResize:false,allowMove:true,showChrome:true,startWidth:420,minWidth:420,startHeight:130,showMaximize:false,showMinimize:false,showClose:true,centerOnShow:true,startHidden:true,modal:true,cssClass:"dialogwindow yim_dialog",elementTitle:K.substitute(A.get("str_window_title_alert"),{str_cfg_branding_messenger:J.getGenericAppName()}),title:A.get("str_conv_dialog_alert"),ariaRole:"application",requires:["dialogwindow"],contentClass:"Messenger.DialogWindow"}};B.extend(M,B.Base,{initializer:function(){this._openWindows={};this._listeners=[];this._titleToggleState={};this._destroyListeners={};this._listeners.push(B.Global.on(L.SYNC_WINDOW_SIZE,this.syncWindowSize,this));this._openModalWindows=[];this._listeners.push(B.Global.on(L.MODAL_WINDOW_OPENED,B.bind(this._modalWindowOpened,this)));this._listeners.push(B.Global.on(L.MODAL_WINDOW_CLOSED,B.bind(this._modalWindowClosed,this)));this._listeners.push(B.Global.on(L.YTOGO_WINDOW_SHOWN,B.bind(this._windowShown,this)));this._listeners.push(B.Global.on(L.YTOGO_WINDOW_HIDDEN,B.bind(this._windowHidden,this)));this._listeners.push(B.Global.on(L.YTOGO_WINDOW_RESIZED,B.bind(this._windowResized,this)));this._listeners.push(B.Global.on(L.SET_WINDOW_FOCUS,B.bind(this._windowSetFocus,this)));this._listeners.push(B.Global.on(L.WINDOW_FOCUSED,this._setWindowFocus,this,true));this._listeners.push(B.Global.on(L.WINDOW_BLURRED,this._setWindowFocus,this,false));this._listeners.push(B.Global.on(L.SHOW_WINDOW,B.bind(this.showWindow,this)));this._listeners.push(B.Global.on(L.HIDE_WINDOW,B.bind(this.hideWindow,this)));this._listeners.push(B.Global.on(L.WAIT_WINDOW,B.bind(this.setWindowWaitState,this)));this._pendingBlurTimers={};if(B.UA.ie){window.attachEvent("onunload",B.bind(this._destroyPoppedOutWindows,this));}else{window.addEventListener("unload",B.bind(this._destroyPoppedOutWindows,this),false);}},destructor:function(){B.each(this._listeners,function(N){N.detach();});B.each(this._pendingBlurTimers,function(N){N.cancel();});this.destroyAllWindows();},addWindowDefinition:function(O,N){M.WINDOW_DEFINITIONS[O]=N;},getWindowDefinition:function(N){return M.WINDOW_DEFINITIONS[N];},_destroyPoppedOutWindows:function(){B.each(this._openWindows,function(O){if(O.get("windowType")=="browserWindow"){try{O.destroy();}catch(N){}}});},_modalWindowOpened:function(N){if(this._openModalWindows.length===0){B.each(this._openWindows,function(O,P){if(P!=N){O.disableWindow();}});this._openModalWindows.push(N);}else{if(this._openModalWindows[this._openModalWindows.length-1]!=N){this._openModalWindows.push(N);}}},_modalWindowClosed:function(){this._openModalWindows.pop();if(this._openModalWindows.length===0){B.each(this._openWindows,function(O){O.enableWindow();});}else{var N=this.getWindow(this._openModalWindows[this._openModalWindows.length-1]);N.bringToFront();N.enableWindow();}},_windowShown:function(N){var O=this.getWindow(N);if(O&&!O.get("modal")&&this._openModalWindows.length>0){G.MakeTopMostDiv(this._openModalWindows[this._openModalWindows.length-1]);}},_windowHidden:function(O){var T=this.getWindow(O),R,N,Q,U,S,P;if(T){if(T._childWindows){while(T._childWindows.length){U=this.getWindow(T._childWindows.pop());if(U){U.hide();}}}if(T._parentWindow){S=this.getWindow(T._parentWindow);if(S&&S._childWindows){for(P=0;P<S._childWindows.length;P++){if(S._childWindows[P]==O){S._childWindows.splice(P,1);break;}}}}R=T.get("srcWindow");if(R){N=this.getWindow(R);if(N&&!N.get("disabled")){N.focus();}}Q=T.__winType__;if(Q&&M.WINDOW_DEFINITIONS[Q].destroyOnHide){this.destroyWindow(O);}}},_windowSetFocus:function(N){var O=this.getWindow(N);if(O&&O.get("visible")&&!O.get("disabled")){O.focus();}},_windowResized:function(N){var P=this.getWindow(N),O;if(P){O=P.get("contentObject");if(O&&O.onResize){O.onResize();}}},showWindow:function(U,Q,O){var S=this.getWindow(U),T={},P=this,V,N,R;
if(O&&O.srcWindow){N=this.getWindow(O.srcWindow);if(N){R=N.get("windowType");if(R!="mailTab"){T.windowType=R;if(S&&S.get("windowType")!=T.windowType){this.destroyWindow(U);S=null;}}}}if(!S){if(Q){T.startPosition={left:Q.left||0,top:Q.top||0};T.startHidden=true;V=function(){S=P.getWindow(U);S.show(O);};}else{T.startHidden=false;}this.createWindow({windowType:U,initParms:T,callback:V,initData:O});}else{if(Q){G.MoveTo(U,Q.left||0,Q.top||0);}S.show(O);}},hideWindow:function(N){var O=this.getWindow(N);O&&O.hide();},setWindowWaitState:function(O,P){var N=this.getWindow(O);if(N){if(P){N.startWaiting();}else{N.stopWaiting();}}},createWindow:function(X){var R=X.windowType,Y=X.windowId,V=X.initParms,O=X.domWin,Z=X.callback,a=X.skipLoad,U,S=this,N;U=M.WINDOW_DEFINITIONS[R]||{};U=B.mix(U,V||{},true);U.initData=X.initData;if(!Y){Y=R;}if(this._openWindows[Y]){throw new Error("Duplicate createWindow calls for window with type = "+R+" and ID = "+Y);}U.windowName=Y;var Q="",W=[],P,T;if(A.isRTL()){Q="rtl/";W=[launchData.phonehomeData.comboBase+launchData.phonehomeData.root+"yimapp/build/assets/css/"+Q+"cssfix-min.css"];}if(A.isBIDI()){if(A.detectDirection&&B.Intl.detectDirection(U.title)=="rtl"){U.title+="&rlm;";}else{U.title+="&lrm;";}}T=J.get("themeInfo");if(T){if(T.css){W.push(T.css);}}U.cssFiles=W;this._openWindows[Y]=new B.Messenger.OuiBaseWindow(U);this._openWindows[Y].render(Z,O);this._openWindows[Y].__winType__=R;this._destroyListeners[Y]=this._openWindows[Y].after("destroy",B.bind(function(){this._windowDestroyed(Y);},this));},loadModule:function(P,O,Q){var N=this._openWindows[O];if(N){N.loadModule(P,Q);}},destroyWindow:function(O){var N=this._openWindows[O];if(N){N.destroy();}},_windowDestroyed:function(N){delete this._openWindows[N];if(this._titleToggleState[N]){if(this._titleToggleState[N].timerHandle){this._titleToggleState[N].timerHandle.cancel();}delete this._titleToggleState[N];}this._destroyListeners[N].detach();delete this._destroyListeners[N];},destroyAllWindows:function(){for(var N in this._openWindows){if(this._openWindows.hasOwnProperty(N)){this.destroyWindow(N);}}setTimeout(function(){G.Unload("messenger");},0);},getWindow:function(N){return this._openWindows[N];},syncWindowSize:function(V){var O=this.getWindow(V),T=O.getDOMWindow(),S=B.one(T.document.body),U,R,Q,X,P=O.get("minWidth")||O.get("startWidth"),N=0,W=O.get("minHeight")||0;if(O.get("windowType")=="mailTab"){return;}if(O.get("showChrome")){U=S.one("#iowaWindow-content-inner");R=S.one("#iowaWindow-content");Q=S.one(".dialog-buttons");if(!P){P=U.get("scrollWidth")-R.get("offsetWidth")+S.get("scrollWidth");}if(V==="yimapp_dialogwindow"){X=S.one("#checkBoxDiv");if(X){if(X.hasClass("hidden")){X=null;}else{X.addClass("hidden");}}if(Q){Q.addClass("hidden");}U.setStyle("position","static");N=U.get("scrollHeight")-R.get("offsetHeight")+S.get("scrollHeight");U.setStyle("position","absolute");if(X){N+=42;X.removeClass("hidden");}if(Q){N+=34;Q.removeClass("hidden");}}else{if(Q){N=Q.get("offsetTop")+Q.get("offsetHeight")+S.one("#titleBar").get("offsetHeight")+16;}else{U.setStyle("position","static");N=U.get("scrollHeight")-R.get("offsetHeight")+S.get("scrollHeight");U.setStyle("position","absolute");}}}else{U.setStyle("position","static");if(!P){P=S.get("scrollWidth");}N=S.get("scrollHeight");U.setStyle("position","absolute");}if(N<W){N=W;}if(O.get("windowType")=="browserWindow"){if(typeof(T.outerHeight)=="undefined"){D=60;}else{if((T.outerHeight-T.innerHeight)>D){D=T.outerHeight-T.innerHeight;}}N+=D;T.resizeTo(P,N);}else{G.SetSize(V,P,N);}},alert:function(Q,U,P,V,R,S){var O=this.getWindow(C.DIALOG_WINDOW);if(!O){this.createWindow({windowType:C.DIALOG_WINDOW,callback:B.bind(function(){this.alert(Q,U,P,V,R,S);},this)});}else{O.get("contentObject").alert(Q,U,P,V,R,S);function T(c){var W=c.left,b=c.top,Y=c.width,a=420,X,Z;X=W+((Y-a)/2);if(X<0){X=0;}Z=b+20;G.MoveTo(C.DIALOG_WINDOW,X,Z);O.show();}var N=B.Messenger.ConversationManager?B.Messenger.ConversationManager.getActiveWindow():null;if(N&&N.get("visible")&&!N.get("minimized")){G.GetPosAndSize(N.get("windowName"),B.bind(T,this));}else{G.MoveToCenter(C.DIALOG_WINDOW,420,130);O.show();}}},confirm:function(X,U,W,Q,V,R,S,O){var P=this.getWindow(C.DIALOG_WINDOW);if(!P){this.createWindow({windowType:C.DIALOG_WINDOW,callback:B.bind(function(){this.confirm(X,U,W,Q,V,R,S,O);},this)});}else{P.get("contentObject").confirm(X,U,W,Q,V,R,S,O);function T(e){var Y=e.left,d=e.top,a=e.width,c=420,Z,b;Z=Y+((a-c)/2);if(Z<0){Z=0;}b=d+20;G.MoveTo(C.DIALOG_WINDOW,Z,b);P.show();}var N=B.Messenger.ConversationManager?B.Messenger.ConversationManager.getActiveWindow():null;if(N&&N.get("visible")&&!N.get("minimized")){N._childWindows=N._childWindows||[];N._childWindows.push(C.DIALOG_WINDOW);P._parentWindow=N.get("windowName");G.GetPosAndSize(N.get("windowName"),B.bind(T,this));}else{G.MoveToCenter(C.DIALOG_WINDOW,420,130);P.show();}}},addWindowTitleToggle:function(V,S){if(window.openmail){var O=this.getWindow(V),R,Q,P=O.get("windowType"),U,T,N;if(P=="iframe"){E.toggleBrowserTitle(S);}else{if(P=="mailTab"){E.toggleBrowserTitle(S);}if(!this._titleToggleState[V]){this._titleToggleState[V]={strings:[O.get("title")],timerHandle:null,currentIndex:0};}R=this._titleToggleState[V];R.strings.push(S);if(!R.timerHandle){if(P=="mailTab"){openmail.Application.setTabCloseMessage({id:V,msg:A.get("str_conv_tab_close_confirm")});}R.timerHandle=B.later(1000,this,function(){if(O){R.currentIndex++;if(R.currentIndex>=R.strings.length){R.currentIndex=0;}if(P=="mailTab"){if(J.get("isFresh")){G.SetTitle(this.getWindow(V).get("windowName"),{className:"mim-flash"});}else{U=B.UA.ie?"#E0E0E0":"rgba(255, 255, 255, 0.5)";T=B.UA.gecko?"-moz-linear-gradient(rgba(255, 255, 255, 1), rgba(255, 255, 255, 0.0))":(B.UA.webkit?"-webkit-gradient(linear, left top, left bottom, color-stop(0%, rgba(255, 255, 255, 1)), color-stop(100%, rgba(255, 255, 255, 0)))":"none");N="progid:DXImageTransform.Microsoft.Gradient(startColorStr=#F0F0F0, endColorStr=#D0D0D0)";G.SetTitle(this.getWindow(V).get("windowName"),{style:R.currentIndex?{backgroundColor:U,backgroundImage:T,filter:N}:{backgroundColor:"",backgroundImage:"",filter:""}});
}}else{O.set("title",R.strings[R.currentIndex]);}}else{R.timerHandle.cancel();R.timerHandle=null;}},null,true);}}}},removeWindowTitleToggle:function(O){if(window.openmail){var N=this.getWindow(O),R,Q,P=N.get("windowType");if(P=="iframe"){E.toggleBrowserTitle(false);}else{if(P=="mailTab"){E.toggleBrowserTitle(false);}R=this._titleToggleState[O];if(R&&R.timerHandle){R.timerHandle.cancel();R.timerHandle=null;if(P=="mailTab"){openmail.Application.setTabCloseMessage({id:O,msg:""});G.SetTitle(N.get("windowName"),{style:{backgroundColor:"",backgroundImage:"",filter:""},removeClass:"mim-flash"});}else{N.set("title",R.strings[0]);}delete this._titleToggleState[O];}}}},_setWindowFocus:function(U,S){var N=this.getWindow(U),T,P,Q,R,O;if(!N){if(this._pendingBlurTimers[U]){this._pendingBlurTimers[U].cancel();delete this._pendingBlurTimers[U];}return;}O=N.getDOMWindow();if(!O||!O.document||!O.document.body){return;}T=B.one(O.document.body);Q=T.hasAttribute("data-focused");if(Q!==S){if(!S){if(!this._pendingBlurTimers[U]){this._pendingBlurTimers[U]=B.later(2000,this,function(){this._setWindowFocus(U,false);});return;}else{delete this._pendingBlurTimers[U];T.removeAttribute("data-focused");}}else{if(N.get("disabled")&&this._openModalWindows.length){R=this.getWindow(this._openModalWindows[this._openModalWindows.length-1]);R.bringToFront();R.focus();}else{P=this.getWindowInFocus();T.setAttribute("data-focused",true);if(P&&P!=U){this._setWindowFocus(P,false);}}}B.Global.fire(L.WINDOW_FOCUS_CHANGE,U,S);}else{if(S&&this._pendingBlurTimers[U]){this._pendingBlurTimers[U].cancel();delete this._pendingBlurTimers[U];}}},isMessengerInFocus:function(){return this.getWindowInFocus()?true:false;},isWindowInFocus:function(P){var N=this.getWindow(P).getDOMWindow(),O;if(N&&N.document){O=B.one(N.document.body);return O.hasAttribute("data-focused");}return false;},getWindowInFocus:function(){var R=null,P,N,O,Q;for(P in this._openWindows){if(this._openWindows.hasOwnProperty(P)){N=this._openWindows[P];O=N.getDOMWindow();if(O&&O.document){Q=B.one(O.document.body);if(Q.hasAttribute("data-focused")){if(!N.get("visible")){Q.removeAttribute("data-focused");}else{R=P;break;}}}}}return R;}});return new M();})();}B.namespace("Messenger").WindowManager=H.WindowManager;},"@VERSION@",{requires:["oui-basewindow","om-window-api"]});YUI.add("mim-application",function(D){if(!YUI.namespace("Messenger").Application){var B=window.launchData,A=D.Messenger.Events;function C(E){C.superclass.constructor.apply(this,arguments);}C.ATTRS={};D.extend(C,D.Base,{initializer:function(E){YUI.namespace("Messenger").Metrics={appInit:B.bootInit};},startMim:function(){var I=D.Messenger.GlobalConfig,G=I.get("lastActive"),E=(new Date()).getTime(),H=30*24*60*60*1000;D.Messenger.DelayLoader.start();D.Messenger.SessionManager.start();D.Messenger.ContactsManager.start();log("Application start method invoked");if(B.MINTY_CL_WINDOW){this._createContactList();}else{B.clCreateCallback=D.bind(this._createContactList,this);}D.Global.on(A.AUDIO_ALERT_NEWMESSAGE,this.playAudioNotification,this);function F(){I.set("lastActive",(new Date()).getTime());}D.Global.on(A.MESSAGE_SENT,F);D.Global.on(A.EXPLICIT_LOGIN,F);if(G=="never"){F();}else{if((E-G)>H){D.Global.fire(A.PRESENCE_PREF_UPDATED,9999);}}},_createContactList:function(){D.Messenger.WindowManager.createWindow({windowType:"MintyMainWindow",domWin:B.MINTY_CL_WINDOW,callback:function(){log("Contact list creation callback invoked");D.later(1000,null,function(){D.Global.fire(A.APP_INIT_COMPLETE);});D.later(5000,null,function(){D.Global.fire(A.DELAY_LOAD_EVENT);});D.later(15000,null,function(){var E={},F=B.urlParams.ymsgrdelay||0;E.t1=B.timers.getParametersCallback-F;E.t2=B.timers.yuiLoaded-F;E.t3=B.timers.serversConnected-F;E.t4=B.timers.appCodeLoaded-F;E.t_done=B.timers.loadedEvent-F;callInternal("event.fire",{event:"mim.perfdata",args:{timers:E}});});}});},playAudioNotification:function(){var I=null,H=D.one("body"),F,N,E=D.Messenger.CommonUtils.getHtml5AudioSupport(),G,M={},O=B.phonehomeData.base_url,L='<audio id="messageReceivedAudioTag" hidden="hidden"><source src="{mp3Source}" type="audio/mp3"/><source src="{wavSource}" type="audio/wav"/></audio>';if(E.audioObjectSupported&&E.audioPlaySupported&&(E.wavSupported||E.mp3Supported)){I=D.one("#messageReceivedAudioTag");if(!I){I=D.Node.create(D.substitute(L,{mp3Source:O+"yimapp/build/assets/receiveim.mp3",wavSource:O+"yimapp/build/assets/receiveim.wav"}));H.append(I);}D.Node.getDOMNode(I).play();}else{if(!this._flashPlayer){if(window.openmail){var K=D.Messenger.WindowManager.getWindow("MintyMainWindow");F=D.one(K._win.document.body);}else{F=H;}N=F.one("#flashplayerContainer");if(!N){if(!D.SWF){D.use("swf",function(P){P.Global.fire(A.AUDIO_ALERT_NEWMESSAGE);});return;}N=D.Node.create("<div id='flashplayerContainer' style='height:0px;width:0px'></div>");F.append(N);G=O+"yimapp/build/assets/audionotifier.swf";M.version="9";M.useExpressInstall=false;M.fixedAttributes={allowFullScreen:"true",scale:"noscale",allowScriptAccess:"always",allowNetworking:"all"};M.flashVars={};M.flashVars.autoplay="messagereceived";try{this._flashPlayer=new D.SWF(D.Node.getDOMNode(F.one("#flashplayerContainer")),G,M);}catch(J){}}}else{this._playFlashAudioNotification();}}},_playFlashAudioNotification:function(E){E=E||0;if(E>10){return;}try{D.Node.getDOMNode(bodyNode.one("#"+this._flashPlayer._id)).playNotificationMessageSound();}catch(F){D.later(250,this,this._playFlashAudioNotification,[++E]);}}});YUI.Messenger.Application=new C();}D.namespace("Messenger").Application=YUI.Messenger.Application;},"@VERSION@",{requires:["base-base","windowmanager","omapi"]});YUI.add('lang/mintymainwindow_en-US', function(Y){Y.namespace('Messenger.Templates').mintymainwindow={baseTemplate: "<div id=\"IowaWindowDiv\">	<!-- CONTENT DIV --></div><div id=\"bottomMarker\"></div>  <!-- Used for resizing -->"};}, '@VERSION@' ,{requires:[]});/*
YUI 3.7.2 (build 5639)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("widget-base",function(e,t){function R(e){var t=this,n,r,i=t.constructor;t._strs={},t._cssPrefix=i.CSS_PREFIX||s(i.NAME.toLowerCase()),e=e||{},R.superclass.constructor.call(t,e),r=t.get(T),r&&(r!==P&&(n=r),t.render(n))}var n=e.Lang,r=e.Node,i=e.ClassNameManager,s=i.getClassName,o,u=e.cached(function(e){return e.substring(0,1).toUpperCase()+e.substring(1)}),a="content",f="visible",l="hidden",c="disabled",h="focused",p="width",d="height",v="boundingBox",m="contentBox",g="parentNode",y="ownerDocument",b="auto",w="srcNode",E="body",S="tabIndex",x="id",T="render",N="rendered",C="destroyed",k="strings",L="<div></div>",A="Change",O="loading",M="_uiSet",_="",D=function(){},P=!0,H=!1,B,j={},F=[f,c,d,p,h,S],I=e.UA.webkit,q={};R.NAME="widget",B=R.UI_SRC="ui",R.ATTRS=j,j[x]={valueFn:"_guid",writeOnce:P},j[N]={value:H,readOnly:P},j[v]={value:null,setter:"_setBB",writeOnce:P},j[m]={valueFn:"_defaultCB",setter:"_setCB",writeOnce:P},j[S]={value:null,validator:"_validTabIndex"},j[h]={value:H,readOnly:P},j[c]={value:H},j[f]={value:P},j[d]={value:_},j[p]={value:_},j[k]={value:{},setter:"_strSetter",getter:"_strGetter"},j[T]={value:H,writeOnce:P},R.CSS_PREFIX=s(R.NAME.toLowerCase()),R.getClassName=function(){return s.apply(i,[R.CSS_PREFIX].concat(e.Array(arguments),!0))},o=R.getClassName,R.getByNode=function(t){var n,i=o();return t=r.one(t),t&&(t=t.ancestor("."+i,!0),t&&(n=q[e.stamp(t,!0)])),n||null},e.extend(R,e.Base,{getClassName:function(){return s.apply(i,[this._cssPrefix].concat(e.Array(arguments),!0))},initializer:function(t){var n=this.get(v);n instanceof r&&this._mapInstance(e.stamp(n)),this._applyParser&&this._applyParser(t)},_mapInstance:function(e){q[e]=this},destructor:function(){var t=this.get(v),n;t instanceof r&&(n=e.stamp(t,!0),n in q&&delete q[n],this._destroyBox())},destroy:function(e){return this._destroyAllNodes=e,R.superclass.destroy.apply(this)},_destroyBox:function(){var e=this.get(v),t=this.get(m),n=this._destroyAllNodes,r;r=e&&e.compareTo(t),this.UI_EVENTS&&this._destroyUIEvents(),this._unbindUI(e),n?(e.empty(),e.remove(P)):(t&&t.remove(P),r||e.remove(P))},render:function(e){return!this.get(C)&&!this.get(N)&&(this.publish(T,{queuable:H,fireOnce:P,defaultTargetOnly:P,defaultFn:this._defRenderFn}),this.fire(T,{parentNode:e?r.one(e):null})),this},_defRenderFn:function(e){this._parentNode=e.parentNode,this.renderer(),this._set(N,P),this._removeLoadingClassNames()},renderer:function(){var e=this;e._renderUI(),e.renderUI(),e._bindUI(),e.bindUI(),e._syncUI(),e.syncUI()},bindUI:D,renderUI:D,syncUI:D,hide:function(){return this.set(f,H)},show:function(){return this.set(f,P)},focus:function(){return this._set(h,P)},blur:function(){return this._set(h,H)},enable:function(){return this.set(c,H)},disable:function(){return this.set(c,P)},_uiSizeCB:function(e){this.get(m).toggleClass(o(a,"expanded"),e)},_renderBox:function(e){var t=this,n=t.get(m),i=t.get(v),s=t.get(w),o=t.DEF_PARENT_NODE,u=s&&s.get(y)||i.get(y)||n.get(y);s&&!s.compareTo(n)&&!n.inDoc(u)&&s.replace(n),!i.compareTo(n.get(g))&&!i.compareTo(n)&&(n.inDoc(u)&&n.replace(i),i.appendChild(n)),e=e||o&&r.one(o),e?e.appendChild(i):i.inDoc(u)||r.one(E).insert(i,0)},_setBB:function(e){return this._setBox(this.get(x),e,this.BOUNDING_TEMPLATE,!0)},_setCB:function(e){return this.CONTENT_TEMPLATE===null?this.get(v):this._setBox(null,e,this.CONTENT_TEMPLATE,!1)},_defaultCB:function(e){return this.get(w)||null},_setBox:function(t,n,i,s){return n=r.one(n),n||(n=r.create(i),s?this._bbFromTemplate=!0:this._cbFromTemplate=!0),n.get(x)||n.set(x,t||e.guid()),n},_renderUI:function(){this._renderBoxClassNames(),this._renderBox(this._parentNode)},_renderBoxClassNames:function(){var e=this._getClasses(),t,n=this.get(v),r;n.addClass(o());for(r=e.length-3;r>=0;r--)t=e[r],n.addClass(t.CSS_PREFIX||s(t.NAME.toLowerCase()));this.get(m).addClass(this.getClassName(a))},_removeLoadingClassNames:function(){var e=this.get(v),t=this.get(m),n=this.getClassName(O),r=o(O);e.removeClass(r).removeClass(n),t.removeClass(r).removeClass(n)},_bindUI:function(){this._bindAttrUI(this._UI_ATTRS.BIND),this._bindDOM()},_unbindUI:function(e){this._unbindDOM(e)},_bindDOM:function(){var t=this.get(v).get(y),n=R._hDocFocus;n||(n=R._hDocFocus=t.on("focus",this._onDocFocus,this),n.listeners={count:0}),n.listeners[e.stamp(this,!0)]=!0,n.listeners.count++,I&&(this._hDocMouseDown=t.on("mousedown",this._onDocMouseDown,this))},_unbindDOM:function(t){var n=R._hDocFocus,r=e.stamp(this,!0),i,s=this._hDocMouseDown;n&&(i=n.listeners,i[r]&&(delete i[r],i.count--),i.count===0&&(n.detach(),R._hDocFocus=null)),I&&s&&s.detach()},_syncUI:function(){this._syncAttrUI(this._UI_ATTRS.SYNC)},_uiSetHeight:function(e){this._uiSetDim(d,e),this._uiSizeCB(e!==_&&e!==b)},_uiSetWidth:function(e){this._uiSetDim(p,e)},_uiSetDim:function(e,t){this.get(v).setStyle(e,n.isNumber(t)?t+this.DEF_UNIT:t)},_uiSetVisible:function(e){this.get(v).toggleClass(this.getClassName(l),!e)},_uiSetDisabled:function(e){this.get(v).toggleClass(this.getClassName(c),e)},_uiSetFocused:function(e,t){var n=this.get(v);n.toggleClass(this.getClassName(h),e),t!==B&&(e?n.focus():n.blur())},_uiSetTabIndex:function(e){var t=this.get(v);n.isNumber(e)?t.set(S,e):t.removeAttribute(S)},_onDocMouseDown:function(e){this._domFocus&&this._onDocFocus(e)},_onDocFocus:function(e){var t=R.getByNode(e.target),n=R._active;n&&n!==t&&(n._domFocus=!1,n._set(h,!1,{src:B}),R._active=null),t&&(t._domFocus=!0,t._set(h,!0,{src:B}),R._active=t)},toString:function(){return this.name+"["+this.get(x)+"]"},DEF_UNIT:"px",DEF_PARENT_NODE:null,CONTENT_TEMPLATE:L,BOUNDING_TEMPLATE:L,_guid:function(){return e.guid()},_validTabIndex:function(e){return n.isNumber(e)||n.isNull(e)},_bindAttrUI:function(e){var t,n=e.length;for(t=0;t<n;t++)this.after(e[t]+A,this._setAttrUI)},_syncAttrUI:function(e){var t,n=e.length,r;for(t=0;t<n;t++)r=e[t],this[M+u(r)](this.get(r))},_setAttrUI:function(e){e.target===this&&this[M+u(e.attrName)](e.newVal,e.src)},_strSetter:function(t){return e.merge(this.get(k),t)},getString:function(e){return this.get(k)[e]},getStrings:function(){return this.get(k)},_UI_ATTRS:{BIND:F,SYNC:F}}),e.Widget=R},"3.7.2",{requires:["attribute","base-base","base-pluginhost","classnamemanager","event-focus","node-base","node-style"],skinnable:!0});
/*
YUI 3.7.2 (build 5639)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("widget-htmlparser",function(e,t){var n=e.Widget,r=e.Node,i=e.Lang,s="srcNode",o="contentBox";n.HTML_PARSER={},n._buildCfg={aggregates:["HTML_PARSER"]},n.ATTRS[s]={value:null,setter:r.one,getter:"_getSrcNode",writeOnce:!0},e.mix(n.prototype,{_getSrcNode:function(e){return e||this.get(o)},_applyParsedConfig:function(t,n,r){return r?e.mix(n,r,!1):n},_applyParser:function(t){var n=this,r=this._getNodeToParse(),s=n._getHtmlParser(),o,u;s&&r&&e.Object.each(s,function(e,t,s){u=null,i.isFunction(e)?u=e.call(n,r):i.isArray(e)?(u=r.all(e[0]),u.isEmpty()&&(u=null)):u=r.one(e),u!==null&&u!==undefined&&(o=o||{},o[t]=u)}),t=n._applyParsedConfig(r,t,o)},_getNodeToParse:function(){var e=this.get("srcNode");return this._cbFromTemplate?null:e},_getHtmlParser:function(){var t=this._getClasses(),n={},r,i;for(r=t.length-1;r>=0;r--)i=t[r].HTML_PARSER,i&&e.mix(n,i,!0);return n}})},"3.7.2",{requires:["widget-base"]});
/*
YUI 3.7.2 (build 5639)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("widget-skin",function(e,t){var n="boundingBox",r="contentBox",i="skin",s=e.ClassNameManager.getClassName;e.Widget.prototype.getSkinName=function(){var e=this.get(r)||this.get(n),t=new RegExp("\\b"+s(i)+"-(\\S+)"),o;return e&&e.ancestor(function(e){return o=e.get("className").match(t),o}),o?o[1]:null}},"3.7.2",{requires:["widget-base"]});
/*
YUI 3.7.2 (build 5639)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("widget-uievents",function(e,t){var n="boundingBox",r=e.Widget,i="render",s=e.Lang,o=":",u=e.Widget._uievts=e.Widget._uievts||{};e.mix(r.prototype,{_destroyUIEvents:function(){var t=e.stamp(this,!0);e.each(u,function(n,r){n.instances[t]&&(delete n.instances[t],e.Object.isEmpty(n.instances)&&(n.handle.detach(),u[r]&&delete u[r]))})},UI_EVENTS:e.Node.DOM_EVENTS,_getUIEventNode:function(){return this.get(n)},_createUIEvent:function(t){var n=this._getUIEventNode(),i=e.stamp(n)+t,s=u[i],o;s||(o=n.delegate(t,function(e){var t=r.getByNode(this);t&&t._filterUIEvent(e)&&t.fire(e.type,{domEvent:e})},"."+e.Widget.getClassName()),u[i]=s={instances:{},handle:o}),s.instances[e.stamp(this)]=1},_filterUIEvent:function(e){return e.currentTarget.compareTo(e.container)||e.container.compareTo(this._getUIEventNode())},_getUIEvent:function(e){if(s.isString(e)){var t=this.parseType(e)[1],n,r;return t&&(n=t.indexOf(o),n>-1&&(t=t.substring(n+o.length)),this.UI_EVENTS[t]&&(r=t)),r}},_initUIEvent:function(e){var t=this._getUIEvent(e),n=this._uiEvtsInitQueue||{};t&&!n[t]&&(this._uiEvtsInitQueue=n[t]=1,this.after(i,function(){this._createUIEvent(t),delete this._uiEvtsInitQueue[t]}))},on:function(e){return this._initUIEvent(e),r.superclass.on.apply(this,arguments)},publish:function(e,t){var n=this._getUIEvent(e);return n&&t&&t.defaultFn&&this._initUIEvent(n),r.superclass.publish.apply(this,arguments)}},!0)},"3.7.2",{requires:["node-event-delegate","widget-base"]});
