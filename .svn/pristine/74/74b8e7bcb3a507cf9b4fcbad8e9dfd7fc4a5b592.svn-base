YUI.add("_shared_module_offscreen_bin_menus_openmail_extension",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_offscreen_bin_menus_openmail_extension={base:"{{menu_item}}{{menu_group}}",selected:"active",checked:"checked",menu_item_shortcut:"<em>{{shortcut}}</em>",menu_item:'<li class="om {{selected}} {{checked}}" data-action="{{data_action}}" role="presentation"> <a href="#" role="menuitem"><span>{{label}}</span>{{menu_item_shortcut}}</a> </li>',menu_group:'<ul class="om" role="presentation">{{menu_items}}</ul>'};},"1.0.0");YUI.add("om-api-menu",function(B){var H=B.common.Utils.substitute,N=B.ui.Templates._shared_module_offscreen_bin_menus_openmail_extension,F={menu_items:function(Q){var R,P=[];while((R=Q.shift())){P.push(H(N.base,R,F));}return P.join("");},menu_item:function(P){return H(N.menu_item,{data_action:P.data_action,label:P.label,shortcut:P.shortcut,selected:P.selected,checked:P.checked},F);},menu_item_shortcut:function(P){return P.shortcut?H(N.menu_item_shortcut,P):"";},selected:function(P){return P.selected?N.selected:"";},checked:function(P){return P.checked?N.checked:"";}},G={},I={},A="-";function D(P){return P.replace(/^(btn-|menu-)/,"");}function C(P){return B.one("#menu-"+D(P));}function E(P){return B.one("#btn-"+D(P));}function K(W,T){var V,S,U,R=C(W),P=[],Q;R.all(".om").remove();while((S=T.menuObj.shift())&&S.label!=A){P.push(H(N.base,S,F));}if(P.length){Q=R.all("ul").pop();if(Q){Q.append(P.join(""));}}P=[];while(T.menuObj.length){U=[];while((S=T.menuObj.shift())&&S.label!=A){U.push(S);}if(U.length){P.push(H(N.menu_group,U,F));}}R.append(P.join(""));V=E(W);if(V&&V.menu){V.menu.checkDescendants(true);}}function M(U,S){var Q,R=S.id,P=S.remove,T;if(U.id in I){Q=I[U.id];}else{Q=I[U.id]=[];}if(P){B.Array.some(Q,function(W,V){if(W.id===R){Q.splice(V,1);return true;}});}else{T=B.Array.find(Q,function(W,V){if(W.id===R){Q[V]=S;return true;}});if(!T){Q.push(S);}}}function O(){var P=B.Object.getValue(NeoConfig,["neoJsHeader","headerClass"]);return(P&&NeoConfig.intl!=="jp")?B.Object.getValue(B,["mail","ui",P]):null;}function J(W){var S=W.rootObj,T=W.menuObj,U=this.instanceid,X=this.id,Y="om:"+U+":"+X+":",V=D(S.id),P,Q,R;for(R in T){if(T.hasOwnProperty(R)){P=T[R];P.data_action=Y+(P.data_action||"");P.id=Y+(P.id||P.label);}}if(S.id=="btn-uh-account"||S.id=="btn-options"){B.Array.each(T,function(Z){M(S,Z);});Q=O();if(Q&&Q.rendered){B.fire("menu:config",S,I[S.id]);}else{B.on("header:rendered",function(){B.fire("menu:config",S,I[S.id]);});}return;}if(C(V)){K(V,{rootObj:S,menuObj:T});}else{G[V]={rootObj:S,menuObj:T};}B.fire("menu:config",S,T);}function L(Q){var R=D(Q.get("id")),P=G[R];if(P){K(R,P);delete G[R];}}B.on("menu:created",L);B.namespace("om.api").Menu={setMenu:J};},"1.0.0",{requires:["om-common-apiutils","_shared_module_offscreen_bin_menus_openmail_extension"]});YUI.add("om-api-event",function(A){var H=A.om.common,I=H.APIUtils,F=I.APIError,E=I.APIReturn,G=I.APIOK,K=A.om.Controller.Openapi,J=A.om.common.Utils,C={};function D(N,P){var M=N.event,L=J.Event.encodeMailEvent(M),O;if(!C[M]){A.on(M,function(Q){A.fire(L,Q);});C[M]=true;}K.setListener(N.__ctx__,{event:L,crumb:N.__crumb__});}function B(M){if(!A.Lang.isString(M.event)){return;}var L=M.__ctx__;M.context={appId:L.appid,instanceId:L.instanceid};A.fire(M.event,M);}A.namespace("om.api").Event={listen:D,fire:B};},"1.0.0",{requires:["om-common-apiutils"]});YUI.add('openmail_strings', function(Y) {
Y.namespace("mail");
Y.mix(strings,{"str_om_error_legaldialog_fail":"Sorry, but we are unable to load this application at this time. Please try again in a moment.","str_om_app_uninstall_title":"Remove Application","str_om_app_uninstall_body":"Are you sure you want to remove \"{{app_name}}\" from {{str_branding_mail}}?<br\/>Removing this application means that all permissions for this application will be removed as well.","str_om_app_description_label":"Description","str_om_instance_list_loading":"The application list is still loading.","str_comp_message_not_sent":"Message Not Sent","str_comp_captcha_reader_hint":"Attention users who are both hearing- and vision-impaired: To complete this form you must enter a word that is part of an image or a few digits from an audio recording. If you cannot read the image or hear the audio, {{str_branding}} is happy to assist you. A representative from Customer Care will need to contact you. Please provide your phone number and email address and send your request by visiting this URL - <a href=\"{{conf_url_help_general}}\">{{conf_url_help_general}}<\/a> To request assistance with registration, please first read the {{str_branding}} Terms of Service located at <a href=\"{{conf_url_tos}}\">{{conf_url_tos}}<\/a> before submitting your request.","str_comp_captcha_header":"To help fight spam, please type in the characters from the box below.","str_comp_captcha_help":"Need help?","str_comp_captcha_enter_code":"Enter the code","str_comp_captcha_img_title":"Enter the characters displayed","str_comp_captcha_img_alt":"CAPTCHA Image","str_comp_captcha_numbers_only":"NUMBERS ONLY","str_comp_captcha_audio_playing":"Audio code is playing...","str_comp_captcha_replay":"Replay","str_comp_captcha_error":"Code you provided didn't match.Try again.","str_comp_captcha_btn_audio_code_attr":"Click here for an audio code","str_comp_captcha_btn_audio_code":"Audio code","str_comp_captcha_back_to_visual":"Back to visual code","str_cascd_ExceededMaxTo":"The message To: field exceeds the maximum number of recipients","str_cascd_ExceededMaxCc":"The message Cc: field exceeds the maximum number of recipients","str_cascd_ExceededMaxBcc":"The message Bcc: field exceeds the maximum number of recipients","str_cascd_ExceededMaxRecipients":"The message address fields exceed the maximum number of recipients","str_cascd_ExceededMaxHourlyMessages":"Number of hourly messages exceeded","str_cascd_ExceededMaxDailyMessages":"Number of daily messages exceeded","str_cascd_InvalidRecipientAddress":"The message To: Cc: or Bcc: field contains a malformed email address","str_btn_add_recipient_attr":"Add {{email_id}} to your Contacts","str_comp_original_msg":"Original Message","str_comp_email_sent":"Email Sent","str_comp_done":"Done","str_btn_recipient_lozenge_attr":"{{email_id}}","str_comp_auto_add_to_contacts":"Automatically add new recipients to Contacts","str_comp_recipients":"Recipients"});
}, '1.0.0');YUI.add("om-api-message",function(B){var O=B.om,D=O.Controller,N=D.Openapi,J=B.om.common,P=J.Utils,G=J.Constants,M=J.Errors,I=J.APIUtils,F=I.APIError,E=I.APIReturn,H=I.APIOK,A=B.common.persist.UserData;function C(R,S,T){var Q=S&&S.viewId?S.viewId:R.id;B.fire("om:msg:"+Q,"message.readAppTime",S);}function L(Q,R,S){if(R.fields){S({data:B.Array.hash(R.fields,B.Array.map(R.fields,function(T){return A.get(T);}))});}else{S({error:'Argument object requires "fields" field'});}}function K(Q,R,S){if(B.Lang.isArray(R.data)){B.use("mail-common-downloader-v"+(NeoConfig.downloaderVersion||"1"),function(T){T.mail.common.downloader.render(T.Array.map(R.data,function(U){return{fid:U.fid,mid:U.mid,pid:U.pid};}),{urlParams:R.params});});}}B.namespace("om.api").Message={readAppTime:C,getUserDataFields:L,downloadAttachment:K};},"1.0.0",{requires:["om-controller-openapi","om-common-apiutils","om-common-errors","om-common-constants"]});YUI.add("om-controller-internalapi",function(G){var M=G.om,N=M.Controller,X=N.extend("Internalapi"),I=N.Openapi,Q=N.Views,f=M.common.Utils,Z=M.common.Constants,P=M.common.Errors,F=M.model.DataStore,U=F.Registry,a=G.common.Utils,K=M.common.APIUtils,R=M.common.Constants,E=K.APIError,W=K.APIReturn,T=K.APIOK,H=G.common.Utils.rocketstats,J=G.Env._loader.groups.mail.modules,S=G.Lang;function B(g,Y){return F.ViewRegistry.get(Q.getInternalUserViewId(g,Y));}function d(i,j,Y,h){var g=B(j,Y);if(g&&g[i]){return g[i](h);}}function A(i,j,Y,h){var g=B(j,Y);if(g&&Q[i]){return Q[i](g,h);}}function e(h,g){var Y={ctrlKey:h.ctrlKey||false,altKey:h.altKey||false,shiftKey:h.shiftKey||false,metaKey:h.metaKey||false,keyCode:h.keyCode||0,charCode:h.charCode||0};YUI().use("node-event-simulate",function(i){i.one(g||document).simulate(h.type,Y);});}var D=(function(){var j,k,g,i,Y,h=1000;return function(l){if(g){clearInterval(k);clearInterval(g);clearTimeout(i);g=null;}else{j=document.title;}if(l===false){document.title=j;return;}document.title=l;g=setInterval(function(){document.title=l;},h*2);i=setTimeout(function(){document.title=j;k=setInterval(function(){document.title=j;},h*2);},h);};})();function b(){return f.getViewport();}function V(k,Y){var h,i,g,j;if(!k){g={"content_type":[Y[0].type+"/"+Y[0].subtype]};i=U.getAttachmentHandlerInfo(g);if(i===-1){return E(P.ERR_BAD_ARG,"bad search argument");}else{if(!i){return E(P.ERR_UNDEFINED,"no viewer registered");}}k=i.handlerId;}h=U.get(k);if(!h||!U.isAttachmentHandler(k)){return E(P.ERR_BAD_ARG,"no such attachment handler: "+k);}N.Views.runActions(h,"events","attachment_view",null,Y,null,null,true);return T();}function C(i,Y,k){var l,h,g,j;if(!i){return E(P.ERR_BAD_ARG,"need an appid");}if(G.Array.indexOf(["view","sign","save"],k)===-1){return E(P.ERR_BAD_ARG,"fxn name isn't allowed");}l=U.get(i);if(!l||!U.isAttachmentHandler(i)){return E(P.ERR_BAD_ARG,"no such attachment handler");}N.Views.runActions(l,"events","attachment_"+k,null,Y,null,null,true);return T();}function L(Y){if(Y.key){if(Y.value){H.stat("OM",Y.key,Y.value);}else{H.stat("OM",Y.key);}}}function O(AC,g){var AK={error:P.ERR_UNDEFINED,errorMsg:"callWebService is not available"},AJ=g.crumb||"",Ag=g.cmd||"",Aa=g.args,Al=Aa&&Aa.viewId?Aa.viewId:AC.id,n,AY,AS=(Aa&&Aa.ctx&&Aa.ctx.eventName)||"";var t=G.mail.persist.MetaData;(Ag!="log")&&f.log("_"+Ag,U.getAppName(AC.appid)+".API");if(!(AJ===NeoConfig.om.crumb)&&g.cmd!="returnEvent"&&!(AJ===NeoConfig.om.crumb&&U.isInternal(AC.appid))){I.returnAPI(AC,AK);return;}switch(Ag){case"alertDialog":G.use("common-ui-dialog-helper",function(i){i.common.ui.DialogHelper.alert({hd:Aa.hd,bd:Aa.bd},{ok:{handler:function(){I.returnAPI(AC,T());}}});});break;case"callWithContext":AC.restoreCallerContext=(function(o,m,i){return function(){AC.appid=o;AC.instanceid=m;AC.id=i;};})(AC.appid,AC.instanceid,AC.id);AC.appid=g.context.appId;AC.instanceid=g.context.instanceId;AC.id=g.context.viewId||AC.id;I.enforceRules(g.api.name,AC,g.api.args);break;case"confirmDialog":G.use("common-ui-dialog-helper",function(i){i.common.ui.DialogHelper.confirm({hd:Aa.hd,bd:Aa.bd},{ok:{handler:function(){var m={data:{value:Z.DIALOG_OK}};I.returnAPI(AC,m);}},cancel:{handler:function(){var m={data:{value:Z.DIALOG_CANCEL}};I.returnAPI(AC,m);}}});});break;case"hideView":d("hide",AC.appid,Aa.id,Aa);break;case"showView":d("show",AC.appid,Aa.id,Aa);break;case"beginMoveView":d("beginMove",AC.appid,Aa.id,Aa);break;case"endMoveView":d("endMove",AC.appid,Aa.id,Aa);break;case"moveView":d("move",AC.appid,Aa.id,Aa);break;case"beginResizeView":d("beginResize",AC.appid,Aa.id,Aa);break;case"endResizeView":d("endResize",AC.appid,Aa.id,Aa);break;case"resizeView":d("resize",AC.appid,Aa.id,Aa);break;case"moveViewTo":d("position",AC.appid,Aa.id,Aa);break;case"getViewRegion":var AZ=d("getRegion",AC.appid,Aa.id,Aa)||{};AZ.id=Aa.id;I.returnAPI(AC,AZ);break;case"makeTopMostView":A("makeTopMost",AC.appid,Aa.id,Aa);break;case"minimizeView":A("minimize",AC.appid,Aa.id,Aa);break;case"restoreView":A("restore",AC.appid,Aa.id,Aa);break;case"dockView":A("dock",AC.appid,Aa.id,Aa);break;case"undockView":A("undock",AC.appid,Aa.id,Aa);break;case"setViewSizeDelta":d("setSizeDelta",AC.appid,Aa.id,Aa);break;case"setViewSize":d("setSize",AC.appid,Aa.id,Aa);break;case"focusView":d("focus",AC.appid,Aa.id,Aa);break;case"browser.toggleTitle":D(Aa.title);break;case"getViewport":I.returnAPI(AC,b());break;case"getNeoYuiComponents":I.returnAPI(AC,{"url":NeoConfig.yuiURL,"base":YUI_config.base,"loaderPath":YUI_config.loaderPath,"comboBase":YUI_config.comboBase,"moduleRoot":YUI_config.root});break;case"log":var AG=U.getAppName(AC.appid);f.log(Aa.message,AG);break;case"trackEvent":if(!Aa.spaceId){return;}var Ab={type:"b",evt:{sp:Aa.spaceId,npv:!Aa.pageView,trace:"om_app_"+(Aa.trace||AC.appid)}};G.fire("darlaEvent",{action:Ab});break;case"triggerAds":if(!Aa.spaceId){return;}var Ab={type:"a",name:"VISIBLE",evt:{sp:Aa.spaceId,npv:false||!Aa.pageView,trace:"om_app_"+(Aa.trace||AC.appid)}};G.fire("darlaEvent",{action:Ab});break;case"relogin":G.use("common-net-error",function(i){i.common.net.Error.relogin(null,{stat:"OM_"+AC.appid});});break;case"createlist.command":G.use("contacts-ui-createlistdialog",function(o){var m=o.contacts.ui.CreateListDialog,r=m&&m[Aa.cmd],i;if(o.Lang.isFunction(r)){r.apply(m,[Aa.args,function(x){I.returnAPI(AC,W(null,x));}]);}else{I.returnAPI(AC,E(P.ERR_BAD_ARG,'unsupported method on interface "'+Ag+'"'));}});break;case"contacts.command":G.use("contacts-api-utils",function(r){var m=r.contacts.utils,o=m&&m[Aa.cmd],i;if(r.Lang.isFunction(o)){i=o.apply(m,Aa.args);I.returnAPI(AC,W(null,i));}});break;case"getAddressbook":G.use("contacts-api-utils","contacts-api",function(){var o=G.contacts,m=o.api,Aq=o.utils;if(!Aq.areContactsLoaded()){G.once("contacts:api:loaded",arguments.callee);m.load();}else{var Au=Aq.getResponseObject(),Av="",y=10;if(G.UA.webkit&&G.UA.webkit<534&&!G.UA.chrome&&Au.contacts&&Au.contacts.contact&&Au.contacts.contact.length>1000){var x=Au.contacts.contact,r=x.length,Ar=[],At="",As=0;
Au.$cbid=AC.cbid;Au.$apiVersion=AC.apiVersion;for(;As<r;As=As+y){At=G.JSON.stringify(x.slice(As,As+y));Ar.push(At.substring(1,At.length-1));}Au.contacts.contact=["!!PLACEHOLDER!!"];Av=G.JSON.stringify(Au).replace(/"!!PLACEHOLDER!!"/,Ar.join(","));I.returnAPI(AC,{},null,Av);return;}I.returnAPI(AC,Au);}});break;case"getMetaData":I.returnAPI(AC,t.getAttrs());break;case"setLoginPref":if("value" in Aa){if(S.isUndefined(t.get("cg"))){t.addAttr("cg",{pref:{im:{}}});t.set("cg",{pref:{im:{loginpref:Aa.value+""}}});t.save();}else{t.set("cg.pref.im.loginpref",Aa.value+"");}}break;case"setAppMetaData":G.om.api.AppData.setAppMetaData.call(AC,Aa);break;case"getAppMetaData":G.om.api.AppData.getAppMetaData.call(AC,function(i){I.returnAPI(AC,i);});break;case"social.init":G.use("om-api-social",function(i){i.om.api.Social.init(null,function(m){m=m||W();I.returnAPI(AC,m);});});break;case"social.auth":G.use("om-api-social",function(i){i.om.api.Social.auth(Aa,function(m){m=m||W();I.returnAPI(AC,m);});});break;case"social.revokeAuth":G.use("om-api-social",function(i){i.om.api.Social.revokeAuth(Aa,function(m){m=m||W();I.returnAPI(AC,m);});});break;case"social.sign":G.use("om-api-social",function(i){i.om.api.Social.sign(Aa,function(m){m=m||W();I.returnAPI(AC,m);});});break;case"social.getAuthUrl":G.use("om-api-social",function(i){i.om.api.Social.getAuthUrl(Aa,function(m){m=m||W();I.returnAPI(AC,m);});});break;case"social.send":G.use("om-api-social",function(i){i.om.api.Social.send(Aa,function(m){m=m||W();I.returnAPI(AC,m);});});break;case"social.status":G.use("om-api-social",function(i){i.om.api.Social.status(Aa,function(m){m=m||W();I.returnAPI(AC,m);});});break;case"getInstanceList":if(F.Loading.isLoading()){alert(strings["str_om_instance_list_loading"]);return;}else{var AF={},AM,AV=U.getAll();for(AM in AV){AF[AM]=AV[AM].instance;}AK.instanceList=AF;I.returnAPI(AC,AK);}break;case"getSelectedItem":var Ad={},Aj=NeoConfig&&NeoConfig.msgrData,AW=Aj&&Aj.message,AH=AW&&AW.part&&AW.part[0]&&AW.part[0].text;if(AW&&AH){var Ao=(AW.header.to||[])[0]||{},u=AW.header.from||{email:""},AP=AP||G.common.persist.UserData.get("userSendPref.defaultFromName")||Ao.email,Ac,Ae,AX,z,q=AH.replace(/^[\s\S]*({"messages"[\s\S]+})/,"$1");Aj.reply={alias:Ao.email,id:u.email};try{z=(G.JSON.parse(q)).messages||[];}catch(Ai){z=[];}for(Ae=0;(Ac=z[Ae]);Ae++){AX=u.email.replace(/[@%].*/,"")!==Ac.from.replace(/[@%].*/,"");if(Ae===0){Aj.spam.initiatedBy=AX?1:2;}if(typeof Ac.cloud_id==="number"){Aj.reply.cloud_id=Ac.cloud_id;Aj.spam.cloud_id=Ac.cloud_id;}if(!Aj.spam.spims){Aj.spam.spims=[];}Aj.spam.spims.push({initiatedBy:AX?1:2,hash:Ac.clt_msg_context||0,message:Ac.txt});}if(u.email==="mailbot@yahoo.com"){Aj.reply.id=u.name;Aj.reply.network="sms";Aj.reply.cloud_id=undefined;}}if(Aj&&Aj[Aa.context]){Ad=Aj[Aa.context];}I.returnAPI(AC,Ad);break;case"getFrameNameByViewId":var Ad={id:Q.getInternalUserViewId(AC.appid,Aa.id)};I.returnAPI(AC,Ad);break;case"getNeoString":if(Aa.keys instanceof Array){var Am={};G.Array.each(Aa.keys,function(i){Am[i]=window.strings[i]||"";});I.returnAPI(AC,Am,true);}else{I.returnAPI(AC,{value:window.strings[Aa.key||""]||""},true);}break;case"getNeoConfig":var w=S.isString(Aa.key)&&Aa.key.split("."),Ae,AA;if(S.isArray(w)&&w[0]==="NeoConfig"){try{AK=window["NeoConfig"];for(Ae=1,AA=w.length;Ae<AA;Ae++){AK=AK[w[Ae]];}}catch(Ai){AK=E(P.ERR_BAD_ARG,"bad key name");}}else{AK=E(P.ERR_BAD_ARG,"bad key name");}if(!S.isObject(AK)){AK={key:w,value:AK};}I.returnAPI(AC,AK,true);break;case"installApp":var s=Aa,AE={appName:s.appName,developerName:s.appDeveloper,appStatus:s.appStatus,appVersion:s.appVersion,source:"gallery",callback:function(i){if(AJ!=NeoConfig.om.crumb){i.crumb=NeoConfig.om.crumb;}I.returnAPI(AC,i);}};G.use("om-controller-addremoveapp",function(i){N.AddRemoveApp.installApp(s.appId,AE);});break;case"isActive":var Af=B(AC.appid,Aa.id),Y=Af&&Af.get("tab");I.returnAPI(AC,{isActive:!!(Y&&Y.elTab&&Y.elTab.hasClass("active"))});break;case"returnEvent":if(AS.indexOf("compose.")===0){G.fire(Aa.ctx.returnEventId,Aa);}else{G.fire("message.read"+Aa.ctx.mid,Aa,AC.appid,AC.instanceid);}break;case"rs":if(S.isArray(Aa)){G.Array.each(Aa,L);}else{if(S.isObject(Aa)){L(Aa);}}break;case"sendKeyEvent":var l=F.ViewRegistry.get(Al),AN=l.getNode();e(Aa,AN._node);break;case"setListener":Aa.crumb=AJ;I.setListener(AC,Aa);break;case"setMenuConfig":G.om.api.Menu.setMenu.call(AC,Aa);break;case"setPreviewPaneButtonConfig":var AO=Aa.buttonObj,Ap=AC.instanceid,Al=AC.id,p,Ae;for(Ae in AO){p=AO[Ae];p.data_action="om:"+Ap+":"+Al+":"+p.data_action;}G.fire("previewpane:config",AO);break;case"subjectSearch":G.fire("search:input",{query:'subject:"'+a.escapeHtml(Aa.query)+'"'});break;case"msgAttachmentDownloadSingle":if(Aa.fid&&Aa.mid&&Aa.pid){G.use("mail-common-downloader-v"+(NeoConfig.downloaderVersion||"1"),function(m){var i=[{fid:Aa.fid,mid:Aa.mid,pid:Aa.pid}];m.mail.common.downloader.render(i,{urlParams:Aa.params});});}else{G.fire("om:msg:"+Al,"downloadSingle",Aa);}break;case"msgAttachmentDownloadAll":G.fire("om:msg:"+Al,"downloadAll",Aa);break;case"msgAttachmentDownloadAllPhotos":G.fire("om:msg:"+Al,"downloadAllPhotos",Aa);break;case"msgAttachmentDownloadEverything":G.fire("om:msg:"+Al,"downloadEverything",Aa);break;case"setMsgFlag":G.fire("om:msg:"+Al,"setFlag",Aa);break;case"setMsgUnread":G.fire("om:msg:"+Al,"setUnread",Aa);break;case"sandboxStartStopwatch":G.fire("om:msg:"+Al,"sandboxStartStopwatch",Aa);I.returnAPI(AC,T());break;case"sandboxRenderComplete":G.fire("om:msg:"+Al,"sandboxRenderComplete",Aa);break;case"sandboxDOMSubtreeModified":G.fire("om:msg:"+Al,"sandboxDOMSubtreeModified",Aa);break;case"sandboxDOMSubtreeModifiedWidth":G.fire("om:msg:"+Al,"sandboxDOMSubtreeModifiedWidth",Aa);break;case"updateDocScroll":if(!NeoConfig.fullPage){break;}var l=f.getIFrameById(Al),Ak=l.get("offsetHeight"),AL=l.getY(),Ah=AL+Ak+Aa.deltaHeight,j=G.DOM.docHeight("body"),AR=Ah-j+1;if(AR>0){if(G.UA.ie>0){l.setStyle("height",Ak+Aa.deltaHeight+"px");setTimeout(function(){window.scrollBy(0,AR);
},0);}else{window.scrollBy(0,AR);}}else{if(G.UA.ie===8){l.setStyle("height",Ak+Aa.deltaHeight+"px");}}break;case"toggleShowDetails":G.fire("om:msg:"+Al,"toggleShowDetails",Aa);break;case"registerSandboxController":G.fire("om:msg:registerSandboxController",AC);break;case"sandboxViewReady":G.fire("om:msg:"+Al,"sandboxViewReady",Aa);break;case"getSandboxCss":G.fire("om:msg:getCss",AC);break;case"getSandboxConf":G.fire("om:msg:getConf",AC);break;case"getSandboxPostLaunchConfig":G.fire("om:msg:getSandboxPostLaunchConfig",AC);break;case"openMailToCompose":G.fire("om:msg:"+Al,"mailto",Aa);break;case"addCalEvent":G.use("calendar-ui-addEvent-listener",function(i){i.calendar.ui.addEvent.listener.fire("addEvent",{data:Aa,source:"om"});});break;case"newMessage":G.fire("newMessage");break;case"newConv":G.fire("previewpane:action",Aa&&Aa.action?Aa.action:"im");break;case"openMailToMRD":G.fire("om:msg:"+Al,"mrd",Aa);break;case"viewFullMsg":G.fire("om:msg:"+Al,"viewFullMsg",Aa);break;case"unblockImages":G.fire("om:msg:"+Al,"unblockImages",Aa);break;case"loadOptions":G.fire("om:msg:"+Al,"loadOptions",Aa);break;case"retryLoad":G.fire("om:msg:"+Al,"retryLoad",Aa);break;case"restartMessageRead":G.mail.model.DataStore.Messages.flushExt("openmail");break;case"switchFolder":var AI=Aa.newFid,An=Aa.newName;if(AI){G.mail.FoldersView.set("fid",{fid:AI,name:An});}break;case"showMore":G.fire("om:msg:"+Al,"showMore",Aa);break;case"uninstallApp":var AE={source:"gallery",callback:function(i){if(AJ!=NeoConfig.om.crumb){i.crumb=NeoConfig.om.crumb;}I.returnAPI(AC,i);}};G.use("om-controller-addremoveapp",function(i){N.AddRemoveApp.uninstallApp(Aa.appId,AE);});break;case"addContact":var AW=NeoConfig.msgrData.message;if(AW){G.use("mail-ui-messageevents",function(i){i.mail.ui.MessageEvents.handleUI({action:"addcontact"},AW.fid,Aa,[AW]);});}else{G.fire("addContact",Aa.name,Aa.email);}break;case"contact-card-menu":var h=f.getIFrameById(Al),AU=h.getX()+Aa.region.left,AT=h.getY()+Aa.region.top;G.use("contacts-ui-contact-popup",function(x){var i=(Aa.email==="mailbot@yahoo.com"&&(/^\d+$/).test(Aa.name)),r=null,o;r=x.one(".dummy_menu_node");if(x.Lang.isNull(r)){r=x.Node.create("<div class='dummy_menu_node'></div>");r.setStyles({position:"absolute",opacity:"0"});x.one("body").appendChild(r);}r.setStyles({width:Aa.region.width+"px",height:Aa.region.height+"px",display:"block"});r.setXY([AU,AT]);if(r.menu){try{if(r.menu.isVisible()){r.menu.getMenuNode().hide();}}catch(m){}r.menu=false;}o={email:Aa.email,name:Aa.name,editable:false,inAB:Aa.isInAB,copyable:true};if(Aa.targetId){o.stateChangeCB=function(y){if(y.state=="hide"){x.fire("om:msg:"+Al,"sandboxSetFocus",{selector:"#"+Aa.targetId});if(NeoConfig.isFresh){x.fire("om:msg:"+Al,"unpressLozenge",{selector:"#"+Aa.targetId});}}else{if(NeoConfig.isFresh&&y.state=="show"){x.fire("om:msg:"+Al,"pressLozenge",{selector:"#"+Aa.targetId});}}};}x.mail.ContactPopup.showContactMenu(x.mail.ContactPopup.TYPE_INTERMEDIATE,r,o);});break;case"iframe:event":G.one("#shellcontent").simulate(Aa.type,Aa);break;case"event.fire":Aa.__ctx__=AC;G.om.api.Event.fire(Aa);break;case"event.listen":Aa.__ctx__=AC;Aa.__crumb__=AJ;G.om.api.Event.listen(Aa,function(i){I.returnAPI(AC,i||W());});break;case"mail.send":G.use("om-api-mail",function(i){i.om.api.Mail.send(Aa,function(m){I.returnAPI(AC,m);});});break;case"mail.reply":G.use("om-api-mail",function(i){i.om.api.Mail.reply(Aa,function(m){I.returnAPI(AC,m);});});break;case"mail.replyall":G.use("om-api-mail",function(i){i.om.api.Mail.replyall(Aa,function(m){I.returnAPI(AC,m);});});break;case"mail.forward":G.use("om-api-mail",function(i){i.om.api.Mail.forward(Aa,function(m){I.returnAPI(AC,m);});});break;case"resolveStr":(function(){var i=G.common.Utils.substitute;function m(r){var o;if(S.isObject(r)){o=S.isArray(r)?[]:{};G.each(r,function(y,x){o[x]=m(y);});}else{if(S.isString(r)){o=i(r,0,0,0,strings);}else{o=r;}}return o;}AK={data:{value:m(Aa)}};})();I.returnAPI(AC,AK);break;case"contactChanged":G.fire("contacts:contactChanged",{});break;case"setTabTitle":var Af=B(AC.appid,Aa.id),Y=Af&&Af.get("tab");if(Y&&Y.elTab){if(Aa.fixedWidth){Y.elTab.setStyle("maxWidth",Y.elTab.getStyle("width"));}if(Aa.style){Y.elTab.setStyles(Aa.style);}if(Aa.className){Y.elTab.toggleClass(Aa.className);}if(Aa.removeClass){Y.elTab.removeClass(Aa.removeClass);}if(Aa.title){Y.set("title",Aa.title);}}break;case"setMessengerConfig":for(var w in Aa){if(Aa.hasOwnProperty(w)){NeoConfig.Messenger[w]=Aa[w];}}break;case"getAttachmentHandlerInfo":AK=U.getAttachmentHandlerInfo(Aa);if(AK===-1){AK=E(P.ERR_BAD_ARG,"bad search argument");}else{AK=T(AK);}I.returnAPI(AC,AK);break;case"getAttachmentHandlers":AK=U.getAttachmentHandlers(Aa);if(AK===-1){AK=E(P.ERR_BAD_ARG,"bad search argument");}else{AK=T(AK);}I.returnAPI(AC,AK);break;case"openAttachmentViewer":AK=V(Aa.handlerId||null,G.Array(Aa.attachments||Aa));I.returnAPI(AC,AK);break;case"openAttachmentHandler":AK=C(Aa.handlerId,G.Array(Aa.attachments),Aa.fxn);I.returnAPI(AC,AK);break;case"setSearchConfig":try{G.fire("search:config",Aa);AK=T();}catch(Ai){AK=E(P.ERR_BAD_ARG,"bad search config argument");}I.returnAPI(AC,AK);break;default:var AB=Ag.split(".");if(AB.length===2){var v=AB[0][0].toUpperCase()+AB[0].slice(1),k=AB[1],AD="om-api-"+AB[0],AQ=function(){var i=G.om.api[v];if(i&&i[k]){i[k].call(i,AC,Aa,function(m){m=m||W();I.returnAPI(AC,m);});}};if(G.om.api[v]){AQ();return;}else{if(J[AD]){G.use(AD,function(){AQ();});return;}}}f.log(Ag+" is not supported yet","InternalAPI");I.returnAPI(AC,AK);}}(function c(){G.on("signout",function(){G.fire(f.getEventName(null,"mail.signout"),{});});G.on("contacts:sendSms",function(g){G.fire(f.getEventName(null,"contacts.sendsms"),{id:g.id});});G.on("contacts:sendIM",function(g){G.fire(f.getEventName(null,"contacts.sendim"),{id:g.id});});G.on("chats:sendIM",function(g){G.fire(f.getEventName(null,"chats.sendim"),g);});G.on("chats:sendSms",function(g){G.fire(f.getEventName(null,"chats.sendsms"),g);});var Y={"ct:addcontact":"add","ct:deletecontact":"delete","ct:editcontact":"update"};
G.on("contacts:contactChanged",function(g){G.once("contacts:api:loaded",function(){g=g||{};G.fire(f.getEventName(null,"contacts.changed"),W(R.OK,{type:Y[g.type],list:g.id}));});});G.on("tabChange",function(g){G.fire(f.getEventName(null,"tab.changed"),{});});G.on("omsearch:input",function(g){G.fire(f.getEventName(null,"search.input"),g);});})();G.mix(X,{internalAPI:O},true);NeoConfig.Messenger=NeoConfig.Messenger||{};if(NeoConfig.setFinished){NeoConfig.setFinished("om");f.log("Set OM loading time in RTB");}},"1.0.0",{requires:["om-controller-base","om-common-utils","om-common-apiutils","om-model-datastore","om-controller-openapi","rocket-stats","om-api-appdata","om-api-menu","om-api-event","om-api-message"]});