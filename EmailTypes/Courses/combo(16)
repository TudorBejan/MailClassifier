YUI.add("tictac-base-ywa",function(a){function c(c){var d=this;d.callbacksWhileLoading=[],d.cfg=a.merge(b,c)}var b={name:"tictac",sourceUrl:"https://s.yimg.com/mi/ono/ywa.js",server:"ONO",appId:"",isSampled:!0,actionEnums:{invoke:1,unknown:50},customFieldEnums:{action:17,unknown:28}};c.prototype={doCallbacks:function(){var a=this,b=a.callbacksWhileLoading.length,c;for(c=0;c<b;c++)a.callbacksWhileLoading[c]()},load:function(a){var b=this;if(window.YWA)a&&a();else{b.callbacksWhileLoading.push(a);if(b.callbacksWhileLoading.length<=1){var c=document.createElement("script");c.type="text/javascript",c.readyState?c.onreadystatechange=function(){if(c.readyState==="loaded"||c.readyState==="complete")c.onreadystatechange=null,b.doCallbacks&&b.doCallbacks()}:c.onload=function(){b.doCallbacks&&b.doCallbacks()},c.src=b.cfg.sourceUrl,document.getElementsByTagName("head")[0].appendChild(c)}}},submit:function(a,b){var c=this,d=c.cfg.actionEnums,e=c.cfg.customFieldEnums,f=c.cfg.appId,g=d&&d[a],h,i=!0,j;if(!c.YWATracker)try{c.YWATracker=window.YWA.getTracker(f,c.cfg.server),c.YWATracker.setDocumentName("Tictac for "+c.cfg.name),c.YWATracker.setDocumentGroup("Tictac for "+c.cfg.name),i=!0}catch(k){}try{g||(g=d&&d.unknown);if(!!f&&!!g){c.YWATracker.setAction(g);for(j in b)b.hasOwnProperty(j)&&(h=e&&e[j],h&&c.YWATracker.setCF(h,""+b[j]));e.action&&c.YWATracker.setCF(e.action,a),i?c.YWATracker.submit():c.YWATracker.submit_action()}}catch(k){}},action:function(a,b){var c=this;c.cfg.isSampled&&c.load(function(){c.submit(a,b)})},stat:function(a,b){var c=this;c.action(a,b)}},a.namespace("Tictac.base").Ywa=c},"1.0.0",{requires:[]});YUI.add("tictac-att-attachment-tray",function(a){function b(){b.superclass.constructor.apply(this,arguments)}b.NAME="attachment-tray",b.ATTRS={attachments:{validator:a.Lang.isObject,value:null},slideDuration:{value:.25},thumbSize:{value:72},thumbMargin:{value:10},defaultHeight:{value:"122px"},collapsedHeight:{value:"38px"},count:{value:0},size:{value:0},collapsed:{value:!1},isRead:{value:!1},isCompose:{value:!1},hidden:{value:!1},composeMaxSize:{value:26214400},composeMaxCount:{value:50},instanceId:{value:"tray"}},b.getPrettySize=function(b){var c=a.Tictac.base.utils.getPrettySize(b);return(NeoConfig.bidi?"&rlm;":"")+a.Tictac.base.utils.subs(a.Tictac.att.strings[c.label],"size",c.value)},a.extend(b,a.Widget,{renderUI:function(){var b=this,c=b.get("contentBox");c.append(a.Tictac.att.rollups.tray(b._getBaseMarkup())),b._tray=c.one(".tictac-att"),b._spinner=b._tray.one(".tictac-att-header-spinner"),b._resizeThumbList()},bindUI:function(){var b=this,c=b.get("boundingBox");b._events=b._events||[],b._events.push(c.delegate("click",b._removeAll,".tictac-att-header-remove-all",b)),b._events.push(c.delegate("click",b._downloadAll,".tictac-att-header-save-comp",b)),b._events.push(c.delegate("click",b._viewAll,".tictac-att-header-view",b)),b._events.push(c.delegate("click",b.hideError,".tictac-att-error-dismiss",b)),b._events.push(c.delegate("click",b._toggle,".tictac-att-header, .tictac-att-state",b)),b._events.push(a.on("windowresize",function(){b._uiUpdateTray()})),b._events.push(c.delegate("click",function(){b.fire("norton")},".tictac-att-norton-logo"))},syncUI:function(){var b=this,c=b._tray.one(".tictac-att-thumb-cover"),d=c.one(".tictac-att-thumb-flow");b._slider=new a.Tictac.att.Slider({container:c,node:d,scrollMargin:24,imgWidth:72,imgMargin:10,slideCount:3}),b._attachmentMenu=new a.Tictac.att.AttachmentMenu({boundingBox:c,contentBox:d,attachments:b.get("attachments")}),b._attachmentMenu.on("item-selected",function(a){b.fire("menu-item-selected",a)},b),b._attachmentMenu.render(b._tray),b._slider.checkOverflow()},destructor:function(){var b=this;b._attachmentMenu&&b._attachmentMenu.destroy(),b._slider&&b._slider.destroy(),a.Array.each(b._events,function(a){a.detach()})},initializer:function(){var a=this;a.set("count",a.get("attachments").getCount()),a.set("size",a.get("attachments").getSize())},hide:function(){var a=this,b=a.get("boundingBox");b.addClass("hidden"),a.set("hidden",!0),a._uiUpdateTray()},show:function(){var a=this,b=a.get("boundingBox");b.removeClass("hidden"),a.set("hidden",!1)},_expand:function(){var b=this,c=b._tray;c.setStyle("height",b.get("collapsedHeight")),c.transition({duration:b.get("slideDuration"),height:{value:b.get("defaultHeight")},on:{start:function(){c.addClass("att-expanding"),c.removeClass("att-collapsed")},end:function(){b.set("collapsed",!1),c.removeClass("att-expanding"),c.one(".tictac-att-state").setAttribute("title",a.Tictac.att.strings.str_tictac_att_collapse)}}}),b.fire("expanded","expanded")},_collapse:function(){var b=this,c=b._tray;c.setStyle("height",b.get("defaultHeight")),c.transition({duration:b.get("slideDuration"),height:{value:b.get("collapsedHeight")},on:{start:function(){c.addClass("att-collapsing")},end:function(){c.addClass("att-collapsed"),c.removeClass("att-collapsing"),b.set("collapsed",!0),c.one(".tictac-att-state").setAttribute("title",a.Tictac.att.strings.str_tictac_att_expand)}}}),b.fire("collapsed","collapsed")},_toggle:function(){var a=this;a.get("collapsed")?a._expand():a._collapse()},showError:function(b,c){var d=this,e=d._tray,f,g;f=a.Tictac.att.attError(b,c&&c>1?{num:c}:null),g=a.Tictac.att.rollups.error,e.one(".tictac-att-header-error").setContent(g({error_message:f.message,error_class:f.cssClass})),e.removeClass("att-spinner"),e.addClass("att-error")},hideError:function(a){var b=this,c=b._tray;c.removeClass("att-error");if(a!==undefined)return a.halt(),!1},scanning:function(b,c){function f(b){var c;return b===1?c=a.Tictac.att.strings.str_tictac_att_scanning_singular:c=a.Tictac.base.utils.subs(a.Tictac.att.strings.str_tictac_att_scanning_plural,"num",b),c}var d=this,e=d._tray;d._scanCount=d._scanCount||0;if(b===undefined)return;b?(d._scanCount+=c,d._spinner.setContent(f(d._scanCount)),d.hideError(),e.addClass("att-spinner"),d._isScanning=!0):(d._scanCount-=c||1,d._spinner.setContent(f(d._scanCount)),d._scanCount===0&&(e.removeClass("att-spinner"),d._isScanning=!1))},uploading:function(b,c){var d=this,e=d._tray,f=a.Tictac.att.strings.str_tictac_att_compose_adding,g=-1;d.uploadingList||(d.uploadingList=[]),g=a.Array.indexOf(d.uploadingList,c),b?(e.addClass("att-spinner"),d._spinner.setContent(f),d.uploadingList.push(c)):g>-1&&(d.uploadingList.splice(g,1),d.uploadingList.length||(e.removeClass("att-spinner"),d._spinner.setContent("")))},addAttachment:function(b){var c=this,d=c.get("attachments"),e=a.Tictac.att.rollups,f;d.add(b),f=c._tray.one(".tictac-att-thumb-flow"),f&&f.append(e.attachment(b.getObject())),c._uiUpdateTray()},removeAttachment:function(a){var b=this,c=b.get("attachments"),d;d=b._tray.one('.tictac-att-thumb-flow li[data-id="'+a+'"]'),d.remove(),c.remove(a),b._uiUpdateTray()},_resizeThumbList:function(){var a=this,b;b=a._tray.one(".tictac-att-thumb-flow"),b&&b.setStyle("width",(a.get("thumbSize")+a.get("thumbMargin"))*a.get("count")-a.get("thumbMargin")+"px"),a._slider&&a._slider.checkOverflow()},_getComposeSizeString:function(){var b=this,c=a.Tictac.base.utils,d=a.Tictac.att.strings.str_tictac_att_compose_header_size,e=a.Tictac.att.AttachmentTray,f=e.getPrettySize(b.get("size")),g=e.getPrettySize(b.get("composeMaxSize"));return c.subs(d,{size:f,max_size:g})},_getCountString:function(){var b,c=this.get("count"),d=a.Tictac.att.strings,e=a.Tictac.base.utils;return c===1?b=d.str_tictac_att_attachment_singular:b=e.subs(d.str_tictac_att_attachment_plural,"num",c),b},_isRead:function(){return this.get("isRead")?!0:!1},_isCompose:function(){return this.get("isCompose")?!0:!1},_getBaseMarkup:function(){var b=this,c=a.Tictac.att.AttachmentTray,d=b.get("count"),e=b.get("attachments"),f;return f={tray_count:b._getCountString(),tray_size:c.getPrettySize(b.get("size")),is_read:b._isRead(),is_compose:b._isCompose(),is_hidden:b.get("hidden"),is_collapsed:b.get("collapsed"),is_bidi:NeoConfig.bidi?!0:!1,attachments:e.getArray(),is_single:d===1,has_images:e.getImageArray().length>0},f},_uiUpdateTray:function(){var b=this,c=a.Tictac.att.strings,d=a.Tictac.att.AttachmentTray,e=b.get("attachments"),f=b._tray.one(".tictac-att-header-remove-all a"),g=e.getCount()===1?c.str_tictac_att_file_remove:c.str_tictac_att_file_remove_all,h,i,j;b.set("count",e.getCount()),b.set("size",e.getSize()),b._resizeThumbList(),h=b._tray.all(".tictac-att-header-size"),h&&(b._isCompose()?h.setContent(b._getComposeSizeString()):h.setContent(d.getPrettySize(b.get("size")))),i=b._tray.one(".tictac-att-header-att"),i&&i.setContent(b._getCountString()),f&&f.setHTML(g),j=b._tray.one(".tictac-att-header-save-comp a"),j&&j.setHTML(b.get("count")===1?c.str_tictac_att_file_save_to_computer:c.str_tictac_att_header_save_all_to_computer)},_removeAll:function(a){return this.fire("removeall"),a.halt(),!1},_downloadAll:function(a){return a.halt(),!1},_viewAll:function(a){return a.halt(),!1}}),a.namespace("Tictac.att").AttachmentTray=b},"1.0.0",{requires:["widget","event-hover","handlebars-base","tictac-att-rollups","tictac-att-strings","tictac-base-utils","tictac-att-attachments","tictac-att-slider","transition","tictac-att-attachment-menu"]});YUI.add("tictac-att-filter",function(a){function c(){var a=window,b="inner",c,d;return"innerWidth"in window||(b="client",a=document.documentElement||document.body),c=a[b+"Width"]*.6,c=~~c,d=a[b+"Height"]-140,{width:c,height:d}}function d(a,b,c){switch(a){case"xlsx":case"excel":case"msexcel":case"x-dos_ms_excel":case"x-excel":case"x-ms-excel":case"x-msexcel":case"x-xls":case"vnd.ms-excel":case"vnd.openxmlformats-officedocument.spreadsheetml.sheet":case"vnd.openxmlformats-officedocument.spreadsheetml.template":case"vnd.ms-excel.sheet.macroEnabled.12":case"vnd.ms-excel.template.macroEnabled.12":return"xls";case"pptx":case"vnd.ms-powerpoint":case"vnd.openxmlformats-officedocument.presentationml.presentation":case"vnd.openxmlformats-officedocument.presentationml.template":case"vnd.openxmlformats-officedocument.presentationml.slideshow":return"ppt";case"docx":case"dot":case"microsoft_word":case"mswor2c sc2":case"msword":case"rtf":case"vnd.framemaker":case"vnd.ms-word":case"vnd.msword":case"winword":case"word":case"x-dot":case"x-fm":case"x-framemaker":case"x-maker":case"x-msw6":case"x-msword":case"x-rtf":case"x-soffice":case"text/richtext":case"text/rtf":case"text/vnd.graphviz":case"zz-winassoc-dot":case"vnd.openxmlformats-officedocument.wordprocessingml.document":case"vnd.ms-word.document.macroEnabled.12":return"doc";case"x-zip-compressed":case"x-compressed":case"zip":return"zip";case"pdf":case"acrobat":case"x-pdf":case"vnd.pdf":case"text/pdf":case"text/x-pdf":return"pdf";default:if(!c)return d(b,b,!0);return b?b:"file"}return"file"}function e(a,b){var c,e=a.split(".");return e.length>1&&(c=e[e.length-1]),d(b,c)}var b=10240;a.namespace("Tictac.att").filter={map:d,attachment:function(a,b){var d=this,f=c(),g={};if(!d.filter(a))return;g.disposition=a.disposition,g.size=a.size,g.filename=a.filename,g.pid=a.partId,g.type=a.type,g.tnefId=a.tnefId,g.downloadable=!0,g.filetype=e(a.filename,a.subtype),a.hasOwnProperty("thumbnailurl")&&a.thumbnailurl!==null&&(g.thumbnail=a.thumbnailurl,g.fullsize=g.thumbnail+"&w="+f.width+"&h="+f.height,g.viewable=!0);if(b)for(var h in b)b.hasOwnProperty(h)&&(g[h]=b[h]);return g},attachments:function(b,c){var d=this,e,f=[];return a.each(b,function(a){e=d.attachment(a,c),e&&f.push(e)}),f},filter:function(a){return a.disposition=a.type==="image"&&a.referencedInline===!0?"inline":a.disposition,a.type!=="image"||a.type==="image"&&a.referencedInline===!0&&a.size>=b||a.type==="image"&&a.referencedInline===!1?a:undefined}}},"1.0.0");YUI.add("tictac-att-attachment-compose",function(a){function c(){c.superclass.constructor.apply(this,arguments)}function d(){d.superclass.constructor.apply(this,arguments)}var b=a.Tictac.att;c.NAME="attachment",a.extend(c,b.Attachment,{activate:function(){var b=this,c=new a.Tictac.widget.Progressbar,d=this.getNode();c.render(b.getNode()),b.progressbar=c,d&&d.addClass("tt-progress").addClass("tictac-att-uploading")},setProgress:function(a){this.progressbar&&this.progressbar.set(a)},deactivate:function(){var a=this,b=this.getNode();a.progressbar&&(a.progressbar.cleanup(),a.progressbar=null),b&&b.removeClass("tictac-att-uploading")}}),b.AttachmentProgressbar=c,d.NAME="attachment",a.extend(d,b.Attachment,{activate:function(){this.getNode().addClass("tictac-att-uploading")},deactivate:function(){this.getNode().removeClass("tictac-att-uploading")}}),b.AttachmentSpinny=d},"1.0.0",{requires:["tictac-att-attachments","tictac-att-progressbar"]});YUI.add("tictac-att-attachment-error",function(a){function b(a){var b={};return a==="download:virus_not_downloadable"&&(b={save_to_computer:!1}),b}function c(a){var b="has-error";switch(a){case"tray:download_cleaned":case"tray:compose_warning":case"download:virus_detected_cleaned":case"download:password_protection":case"compose:virus_cleaned":case"compose:password_protection":case"compose:generic_warning":b="has-warning";break;case"tray:download_error":case"tray:compose_error":case"download:virus_not_downloadable":case"download:virus_scan_incomplete":case"download:retry_network_error":case"compose:virus_not_cleaned":case"compose:generic_error":b="has-error"}return b}function d(b,c){var d=a.Tictac.att.strings,e;switch(b){case"tray:download_cleaned":c&&c.num?e="str_tictac_att_file_download_success_plural":e="str_tictac_att_file_download_success_singular";break;case"tray:compose_error":c&&c.num&&c.num!==1?e="str_tictac_att_compose_no_send_plural":e="str_tictac_att_compose_no_send_singular";break;case"tray:compose_warning":c&&c.num&&c.num!==1?e="str_tictac_att_compose_warning_plural":e="str_tictac_att_compose_warning_singular";break;case"tray:download_error":c&&c.num&&c.num!==1?e="str_tictac_att_file_download_fail_plural":e="str_tictac_att_file_download_fail_singular";break;case"download:virus_not_downloadable":c&&c.virus_name?e="str_tictac_att_download_virus_named_not_downloadable":e="str_tictac_att_download_virus_not_downloadable";break;case"download:virus_scan_incomplete":e="str_tictac_att_download_virus_scan_incomplete";break;case"download:retry_network_error":e="str_tictac_att_download_retry_network_error";break;case"download:password_protection":e="str_tictac_att_download_password_protection";break;case"download:virus_detected_cleaned":c&&c.virus_name?e="str_tictac_att_download_virus_named_detected_cleaned":e="str_tictac_att_download_virus_detected_cleaned";break;case"compose:virus_cleaned":c&&c.virus_name?e="str_tictac_att_compose_named_virus_cleaned":e="str_tictac_att_compose_virus_cleaned";break;case"compose:virus_not_cleaned":c&&c.virus_name?e="str_tictac_att_compose_named_virus_not_cleaned":e="str_tictac_att_compose_virus_not_cleaned";break;case"compose:password_protection":e="str_tictac_att_compose_password_protected";break;case"compose:generic_error":e="str_tictac_att_compose_generic_error";break;case"compose:generic_warning":e="str_tictac_att_compose_generic_warning";break;default:e="str_tictac_att_file_download_fail_singular"}return d[e]?a.Tictac.base.utils.subs(d[e],c):null}a.namespace("Tictac.att").attError=function(a,e){return{message:d(a,e),cssClass:c(a),menuSettings:b(a)}}},"1.0.0",{requires:["tictac-base-utils","tictac-att-strings"]});YUI.add("tictac-att-download",function(a){function d(a,b){var c,d=!1,e=!1;switch(a){case"download_av_internal_error":case"download_av_server_down":case"download_av_error":c="download:retry_network_error",d=!0;break;case"download_has_virus":case"download_has_virus_cant_clean":c="download:virus_not_downloadable",d=!0;break;case"download_not_scannable":c="download:password_protection",e=!0;break;case"download_cleaned":c="download:virus_detected_cleaned",e=!0;break;case"download_av_no_virus":break;default:d=!0,c="download:retry_network_error"}return{failed:d||e,error:d,warning:e,code:c,extras:{virus_name:b}}}function e(){var b=new Date,c=a.Tictac.att.strings.str_tictac_att_attachments;return c+="_"+b.getFullYear(),c+=b.getMonth()+1,c+=b.getDate(),c}function f(b,d){function k(){e=document.createElement("iframe"),e.id=j,e.style.display="none",e.src=b,a.one("body").append(e)}var e,f=a.common.ui.DialogHelper.confirm,g,h,i,j="tictac-downloader-"+(new Date).getTime();a.UA.ie&&a.UA.ie<9?(i=c[d===1?"str_tictac_att_download_done_singular":"str_tictac_att_download_done_plural"],g={hd:c.str_tictac_att_download_title,bd:i},h={ok:{handler:k}},f(g,h,function(){var b=a.one("#modalOverlay");if(b)try{b.get("parentNode").get("parentNode").setStyle("zIndex","999999")}finally{}})):k()}function g(c,h,i){function m(d,e){var f,j,k,l;try{f=a.JSON.parse(e.response||e.responseText)}catch(m){h("failed",{}),b.stat("download_error_json");return}if(f&&f.error&&f.error.code==="Client.ClientRedirect.SessionIdReissue"&&!i){j=f.error.detail.url,k=j.match(/[\&|\?]wssid=([^\&\#]+)/),l=k.length>1?k[1]:NeoConfig.wssid,NeoConfig.wssid=l,g(c,h,!0);return}b.stat("download_error_general",{download_error_general:f.error.code+": "+f.error.message}),h("failed",{})}function n(e,g){var i=a.JSON.parse(g.response||g.responseText).result,j,k=new Date,m={},n;n={errors:0,warnings:0},i.hasOwnProperty("downloadArchiveUrl")?j=i.downloadArchiveUrl:i.hasOwnProperty("attachInfoResult")&&i.attachInfoResult.length>0&&i.attachInfoResult[0].hasOwnProperty("downloadUrl")&&(j=i.attachInfoResult[0].downloadUrl),i&&i.attachInfoResult&&(m=a.Array.map(i.attachInfoResult,function(e,f){var g=d(e.errorString,e.virusFound?e.virusFound[0]:null);return g.error?b.stat("download_success_error",{download_success_error:e.errorString}):b.stat("download_success_success",{download_success_type:e.attachmentType+"/"+e.attachmentSubtype,download_success_size:Math.round(e.fileSize/1024)}),g.warning&&b.stat("download_success_warning",{download_success_warning:e.errorString}),g.error?n.errors++:g.warning&&n.warnings++,a.merge(g,{aid:c[f].aid})}),a.mix(n,{attachments:m})),j?(f(j,c.length),h("success",n),b.stat("download_success",{download_success_count:i.attachInfoResult.length,download_success_time:k-l}),n.warnings>0&&b.stat("download_success_warnings",{download_warnings_total:i.attachInfoResult.length,download_warnings_count:n.warnings}),n.errors>0&&b.stat("download_success_errors",{download_errors_total:i.attachInfoResult.length,download_errors_count:n.errors})):(b.stat("download_success_nourl"),h("success",n))}var j=[window.location.protocol+"//",window.location.host,"/ws/mail/v2.0/jsonrpc?appid=YahooMailNeo","&m=VirusScanAttachments","&wssid="+NeoConfig.wssid,"&windowid="+NeoConfig.windowId,"&r="+(new Date).getTime()].join(""),k={method:"VirusScanAttachments",params:[{downloadInfo:c,archiveName:e(),archive:c.length>1?!0:!1}]},l=new Date;a.io(j,{data:a.JSON.stringify(k),method:"POST",headers:{"Content-Type":"application/json"},on:{success:n,failure:m}})}function h(b,c,d,e){var f=b.get("attachments"),g=a.Tictac.att.attError,h;d==="failed"?b.showError("tray:download_error",c.length):e.errors?b.showError("tray:download_error",e.errors):e.warnings&&b.showError("tray:download_cleaned",e.warnings);if(!e.attachments){a.Array.each(c,function(a){h=f.get(a.aid),h.updateProperty("error",g("download:retry_network_error"))});return}a.Array.each(e.attachments,function(a){h=f.get(a.aid),a.failed&&a.code?h.updateProperty("error",g(a.code,a.extras)):h.hasError()&&h.updateProperty("error",{})})}function i(a,c,d,e){e&&e.stat&&(b=e),a.scanning(!0,c.length),g(c,function(b,e){a.scanning(!1,c.length),h(a,c,b,e),d&&d()})}var b,c=a.Tictac.att.strings;a.namespace("Tictac.att").download=i},"1.0.0",{requires:["node","io","querystring-stringify-simple"]});YUI.add("tictac-base-stats",function(a){function b(b){var c=b.ywa?b.ywa:b;b.name=b.name?b.name:c.name,c.name=c.name?c.name:b.name,this.cfg=b,this.ywa=new a.Tictac.base.Ywa(c)}b.prototype={stat:function(a,b){var c=this.cfg;(!c.ultActions||c.ultActions&&c.ultActions[a])&&this.ultStat(a,b),(!c.ywa||c.ywa&&c.ywa.actionEnums[a])&&this.ywa.stat(a,b)},ultStat:function(b,c){var d=this.cfg.name+"_"+b,e;for(e in c)if(e.length>8){c="";break}c?a.fire("mt:click",{action:d,append:c}):a.fire("mt:click",{action:d})}},a.namespace("Tictac.base").Stats=b},"1.0.0",{requires:["tictac-base-ywa"]});/*
YUI 3.7.2 (build 5639)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("io-xdr",function(e,t){function a(e,t,n){var r='<object id="io_swf" type="application/x-shockwave-flash" data="'+e+'" width="0" height="0">'+'<param name="movie" value="'+e+'">'+'<param name="FlashVars" value="yid='+t+"&uid="+n+'">'+'<param name="allowScriptAccess" value="always">'+"</object>",i=s.createElement("div");s.body.appendChild(i),i.innerHTML=r}function f(t,n,r){return n==="flash"&&(t.c.responseText=decodeURI(t.c.responseText)),r==="xml"&&(t.c.responseXML=e.DataType.XML.parse(t.c.responseText)),t}function l(e,t){return e.c.abort(e.id,t)}function c(e){return u?i[e.id]!==4:e.c.isInProgress(e.id)}var n=e.publish("io:xdrReady",{fireOnce:!0}),r={},i={},s=e.config.doc,o=e.config.win,u=o&&o.XDomainRequest;e.mix(e.IO.prototype,{_transport:{},_ieEvt:function(e,t){var n=this,r=e.id,s="timeout";e.c.onprogress=function(){i[r]=3},e.c.onload=function(){i[r]=4,n.xdrResponse("success",e,t)},e.c.onerror=function(){i[r]=4,n.xdrResponse("failure",e,t)},t[s]&&(e.c.ontimeout=function(){i[r]=4,n.xdrResponse(s,e,t)},e.c[s]=t[s])},xdr:function(t,n,i){var s=this;return i.xdr.use==="flash"?(r[n.id]=i,o.setTimeout(function(){try{n.c.send(t,{id:n.id,uid:n.uid,method:i.method,data:i.data,headers:i.headers})}catch(e){s.xdrResponse("transport error",n,i),delete r[n.id]}},e.io.xdr.delay)):u?(s._ieEvt(n,i),n.c.open(i.method||"GET",t),n.c.send(i.data)):n.c.send(t,n,i),{id:n.id,abort:function(){return n.c?l(n,i):!1},isInProgress:function(){return n.c?c(n.id):!1},io:s}},xdrResponse:function(e,t,n){n=r[t.id]?r[t.id]:n;var s=this,o=u?i:r,a=n.xdr.use,l=n.xdr.dataType;switch(e){case"start":s.start(t,n);break;case"success":s.success(f(t,a,l),n),delete o[t.id];break;case"timeout":case"abort":case"transport error":t.c={status:0,statusText:e};case"failure":s.failure(f(t,a,l),n),delete o[t.id]}},_xdrReady:function(t,r){e.fire(n,t,r)},transport:function(t){t.id==="flash"&&(a(e.UA.ie?t.src+"?d="+(new Date).valueOf().toString():t.src,e.id,t.uid),e.IO.transports.flash=function(){return s.getElementById("io_swf")})}}),e.io.xdrReady=function(t,n){var r=e.io._map[n];e.io.xdr.delay=0,r._xdrReady.apply(r,[t,n])},e.io.xdrResponse=function(t,n,r){var i=e.io._map[n.uid];i.xdrResponse.apply(i,[t,n,r])},e.io.transport=function(t){var n=e.io._map["io:0"]||new e.IO;t.uid=n._uid,n.transport.apply(n,[t])},e.io.xdr={delay:100}},"3.7.2",{requires:["io-base","datatype-xml-parse"]});
/*
YUI 3.7.2 (build 5639)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("io-form",function(e,t){var n=encodeURIComponent;e.mix(e.IO.prototype,{_serialize:function(t,r){var i=[],s=t.useDisabled||!1,o=0,u=typeof t.id=="string"?t.id:t.id.getAttribute("id"),a,f,l,c,h,p,d,v,m,g;u||(u=e.guid("io:"),t.id.setAttribute("id",u)),f=e.config.doc.getElementById(u);for(p=0,d=f.elements.length;p<d;++p){a=f.elements[p],h=a.disabled,l=a.name;if(s?l:l&&!h){l=n(l)+"=",c=n(a.value);switch(a.type){case"select-one":a.selectedIndex>-1&&(g=a.options[a.selectedIndex],i[o++]=l+n(g.attributes.value&&g.attributes.value.specified?g.value:g.text));break;case"select-multiple":if(a.selectedIndex>-1)for(v=a.selectedIndex,m=a.options.length;v<m;++v)g=a.options[v],g.selected&&(i[o++]=l+n(g.attributes.value&&g.attributes.value.specified?g.value:g.text));break;case"radio":case"checkbox":a.checked&&(i[o++]=l+c);break;case"file":case undefined:case"reset":case"button":break;case"submit":default:i[o++]=l+c}}}return r?i.join("&")+"&"+r:i.join("&")}},!0)},"3.7.2",{requires:["io-base","node-base"]});
/*
YUI 3.7.2 (build 5639)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("io-upload-iframe",function(e,t){function o(t,n,r){var i=e.Node.create('<iframe src="#" id="io_iframe'+t.id+'" name="io_iframe'+t.id+'" />');i._node.style.position="absolute",i._node.style.top="-1000px",i._node.style.left="-1000px",e.one("body").appendChild(i),e.on("load",function(){r._uploadComplete(t,n)},"#io_iframe"+t.id)}function u(t){e.Event.purgeElement("#io_iframe"+t,!1),e.one("body").removeChild(e.one("#io_iframe"+t))}var n=e.config.win,r=e.config.doc,i=r.documentMode&&r.documentMode>=8,s=decodeURIComponent;e.mix(e.IO.prototype,{_addData:function(t,n){e.Lang.isObject(n)&&(n=e.QueryString.stringify(n));var i=[],o=n.split("="),u,a;for(u=0,a=o.length-1;u<a;u++)i[u]=r.createElement("input"),i[u].type="hidden",i[u].name=s(o[u].substring(o[u].lastIndexOf("&")+1)),i[u].value=u+1===a?s(o[u+1]):s(o[u+1].substring(0,o[u+1].lastIndexOf("&"))),t.appendChild(i[u]);return i},_removeData:function(e,t){var n,r;for(n=0,r=t.length;n<r;n++)e.removeChild(t[n])},_setAttrs:function(t,n,r){t.setAttribute("action",r),t.setAttribute("method","POST"),t.setAttribute("target","io_iframe"+n),t.setAttribute(e.UA.ie&&!i?"encoding":"enctype","multipart/form-data")},_resetAttrs:function(t,n){e.Object.each(n,function(e,n){e?t.setAttribute(n,e):t.removeAttribute(n)})},_startUploadTimeout:function(e,t){var r=this;r._timeout[e.id]=n.setTimeout(function(){e.status=0,e.statusText="timeout",r.complete(e,t),r.end(e,t)},t.timeout)},_clearUploadTimeout:function(e){var t=this;n.clearTimeout(t._timeout[e]),delete t._timeout[e]},_uploadComplete:function(t,r){var i=this,s=e.one("#io_iframe"+t.id).get("contentWindow.document"),o=s.one("body"),a;r.timeout&&i._clearUploadTimeout(t.id);try{o?(a=o.one("pre:first-child"),t.c.responseText=a?a.get("text"):o.get("text")):t.c.responseXML=s._node}catch(f){t.e="upload failure"}i.complete(t,r),i.end(t,r),n.setTimeout(function(){u(t.id)},0)},_upload:function(t,n,i){var s=this,o=typeof i.form.id=="string"?r.getElementById(i.form.id):i.form.id,a={action:o.getAttribute("action"),target:o.getAttribute("target")},f;return s._setAttrs(o,t.id,n),i.data&&(f=s._addData(o,i.data)),i.timeout&&s._startUploadTimeout(t,i),o.submit(),s.start(t,i),i.data&&s._removeData(o,f),s._resetAttrs(o,a),{id:t.id,abort:function(){t.status=0,t.statusText="abort";if(!e.one("#io_iframe"+t.id))return!1;u(t.id),s.complete(t,i),s.end(t,i)},isInProgress:function(){return e.one("#io_iframe"+t.id)?!0:!1},io:s}},upload:function(e,t,n){return o(e,n,this),this._upload(e,t,n)}})},"3.7.2",{requires:["io-base","node-base"]});
/*
YUI 3.7.2 (build 5639)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("queue-promote",function(e,t){e.mix(e.Queue.prototype,{indexOf:function(t){return e.Array.indexOf(this._q,t)},promote:function(e){var t=this.indexOf(e);t>-1&&this._q.unshift(this._q.splice(t,1)[0])},remove:function(e){var t=this.indexOf(e);t>-1&&this._q.splice(t,1)}})},"3.7.2",{requires:["yui-base"]});
/*
YUI 3.7.2 (build 5639)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("io-queue",function(e,t){function r(e,t){return n.queue.apply(n,[e,t])}var n=e.io._map["io:0"]||new e.IO;e.mix(e.IO.prototype,{_q:new e.Queue,_qActiveId:null,_qInit:!1,_qState:1,_qShift:function(){var e=this,t=e._q.next();e._qActiveId=t.id,e._qState=0,e.send(t.uri,t.cfg,t.id)},queue:function(t,n){var r=this,i={uri:t,cfg:n,id:this._id++};return r._qInit||(e.on("io:complete",function(e,t){r._qNext(e)},r),r._qInit=!0),r._q.add(i),r._qState===1&&r._qShift(),i},_qNext:function(e){var t=this;t._qState=1,t._qActiveId===e&&t._q.size()>0&&t._qShift()},qPromote:function(e){this._q.promote(e)},qRemove:function(e){this._q.remove(e)},qStart:function(){var e=this;e._qState=1,e._q.size()>0&&e._qShift()},qStop:function(){this._qState=0},qSize:function(){return this._q.size()}},!0),r.start=function(){n.qStart()},r.stop=function(){n.qStop()},r.promote=function(e){n.qPromote(e)},r.remove=function(e){n.qRemove(e)},r.size=function(){n.qSize()},e.io.queue=r},"3.7.2",{requires:["io-base","queue-promote"]});
/*
YUI 3.7.2 (build 5639)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("file-html5",function(e,t){var n=e.Lang,r=e.bind,i=e.config.win,s=function(e){var t=null;s.isValidFile(e)?t=e:s.isValidFile(e.file)?t=e.file:t=!1,s.superclass.constructor.apply(this,arguments),t&&s.canUpload()&&(this.get("file")||this._set("file",t),this.get("name")||this._set("name",t.name||t.fileName),this.get("size")!=(t.size||t.fileSize)&&this._set("size",t.size||t.fileSize),this.get("type")||this._set("type",t.type),t.hasOwnProperty("lastModifiedDate")&&!this.get("dateModified")&&this._set("dateModified",t.lastModifiedDate))};e.extend(s,e.Base,{initializer:function(t){this.get("id")||this._set("id",e.guid("file"))},_uploadEventHandler:function(e){var t=this.get("xhr");switch(e.type){case"progress":this.fire("uploadprogress",{originEvent:e,bytesLoaded:e.loaded,bytesTotal:this.get("size"),percentLoaded:Math.min(100,Math.round(1e4*e.loaded/this.get("size"))/100)}),this._set("bytesUploaded",e.loaded);break;case"load":if(t.status>=200&&t.status<=299){this.fire("uploadcomplete",{originEvent:e,data:e.target.responseText});var n=t.upload,r=this.get("boundEventHandler");n.removeEventListener("progress",r),n.removeEventListener("error",r),n.removeEventListener("abort",r),t.removeEventListener("load",r),t.removeEventListener("error",r),t.removeEventListener("readystatechange",r),this._set("xhr",null)}else this.fire("uploaderror",{originEvent:e,status:t.status,statusText:t.statusText,source:"http"});break;case"error":this.fire("uploaderror",{originEvent:e,status:t.status,statusText:t.statusText,source:"io"});break;case"abort":this.fire("uploadcancel",{originEvent:e});break;case"readystatechange":this.fire("readystatechange",{readyState:e.target.readyState,originEvent:e})}},startUpload:function(t,n,i){this._set("bytesUploaded",0),this._set("xhr",new XMLHttpRequest),this._set("boundEventHandler",r(this._uploadEventHandler,this));var s=new FormData,o=i||"Filedata",u=this.get("xhr"),a=this.get("xhr").upload,f=this.get("boundEventHandler");e.each(n,function(e,t){s.append(t,e)}),s.append(o,this.get("file")),u.addEventListener("loadstart",f,!1),a.addEventListener("progress",f,!1),u.addEventListener("load",f,!1),u.addEventListener("error",f,!1),a.addEventListener("error",f,!1),a.addEventListener("abort",f,!1),u.addEventListener("abort",f,!1),u.addEventListener("loadend",f,!1),u.addEventListener("readystatechange",f,!1),u.open("POST",t,!0),u.withCredentials=this.get("xhrWithCredentials"),e.each(this.get("xhrHeaders"),function(e,t){u.setRequestHeader(t,e)}),u.send(s),this.fire("uploadstart",{xhr:u})},cancelUpload:function(){this.get("xhr").abort()}},{NAME:"file",TYPE:"html5",ATTRS:{id:{writeOnce:"initOnly",value:null},size:{writeOnce:"initOnly",value:0},name:{writeOnce:"initOnly",value:null},dateCreated:{writeOnce:"initOnly",value:null},dateModified:{writeOnce:"initOnly",value:null},bytesUploaded:{readOnly:!0,value:0},type:{writeOnce:"initOnly",value:null},file:{writeOnce:"initOnly",value:null},xhr:{readOnly:!0,value:null},xhrHeaders:{value:{}},xhrWithCredentials:{value:!0},boundEventHandler:{readOnly:!0,value:null}},isValidFile:function(e){return i&&i.File&&e instanceof File},canUpload:function(){return i&&i.FormData&&i.XMLHttpRequest}}),e.FileHTML5=s},"3.7.2",{requires:["base"]});
/*
YUI 3.7.2 (build 5639)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("uploader-queue",function(e,t){var n=e.Lang,r=e.bind,i=e.config.win,s,o,u,a,f,l,c=function(e){this.queuedFiles=[],this.uploadRetries={},this.numberOfUploads=0,this.currentUploadedByteValues={},this.currentFiles={},this.totalBytesUploaded=0,this.totalBytes=0,c.superclass.constructor.apply(this,arguments)};e.extend(c,e.Base,{_currentState:c.STOPPED,initializer:function(e){},_uploadStartHandler:function(e){var t=e;t.file=e.target,t.originEvent=e,this.fire("uploadstart",t)},_uploadErrorHandler:function(e){var t=this.get("errorAction"),n=e;n.file=e.target,n.originEvent=e,this.numberOfUploads-=1,delete this.currentFiles[e.target.get("id")],this._detachFileEvents(e.target),e.target.cancelUpload();if(t===c.STOP)this.pauseUpload();else if(t===c.RESTART_ASAP){var r=e.target.get("id"),i=this.uploadRetries[r]||0;i<this.get("retryCount")&&(this.uploadRetries[r]=i+1,this.addToQueueTop(e.target)),this._startNextFile()}else if(t===c.RESTART_AFTER){var r=e.target.get("id"),i=this.uploadRetries[r]||0;i<this.get("retryCount")&&(this.uploadRetries[r]=i+1,this.addToQueueBottom(e.target)),this._startNextFile()}this.fire("uploaderror",n)},_startNextFile:function(){if(this.queuedFiles.length>0){var e=this.queuedFiles.shift(),t=e.get("id"),n=this.get("perFileParameters"),r=n.hasOwnProperty(t)?n[t]:n;this.currentUploadedByteValues[t]=0,e.on("uploadstart",this._uploadStartHandler,this),e.on("uploadprogress",this._uploadProgressHandler,this),e.on("uploadcomplete",this._uploadCompleteHandler,this),e.on("uploaderror",this._uploadErrorHandler,this),e.on("uploadcancel",this._uploadCancelHandler,this),e.set("xhrHeaders",this.get("uploadHeaders")),e.set("xhrWithCredentials",this.get("withCredentials")),e.startUpload(this.get("uploadURL"),r,this.get("fileFieldName")),this._registerUpload(e)}},_registerUpload:function(e){this.numberOfUploads+=1,this.currentFiles[e.get("id")]=e},_unregisterUpload:function(e){this.numberOfUploads>0&&(this.numberOfUploads-=1),delete this.currentFiles[e.get("id")],delete this.uploadRetries[e.get("id")],this._detachFileEvents(e)},_detachFileEvents:function(e){e.detach("uploadstart",this._uploadStartHandler),e.detach("uploadprogress",this._uploadProgressHandler),e.detach("uploadcomplete",this._uploadCompleteHandler),e.detach("uploaderror",this._uploadErrorHandler),e.detach("uploadcancel",this._uploadCancelHandler)},_uploadCompleteHandler:function(t){this._unregisterUpload(t.target),this.totalBytesUploaded+=t.target.get("size"),delete this.currentUploadedByteValues[t.target.get("id")],this.queuedFiles.length>0&&this._currentState===c.UPLOADING&&this._startNextFile();var n=t;n.file=t.target,n.originEvent=t;var r=this.totalBytesUploaded;e.each(this.currentUploadedByteValues,function(e){r+=e});var i=Math.min(100,Math.round(1e4*r/this.totalBytes)/100);this.fire("totaluploadprogress",{bytesLoaded:r,bytesTotal:this.totalBytes,percentLoaded:i}),this.fire("uploadcomplete",n),this.queuedFiles.length===0&&this.numberOfUploads<=0&&(this.fire("alluploadscomplete"),this._currentState=c.STOPPED)},_uploadCancelHandler:function(e){var t=e;t.originEvent=e,t.file=e.target,this.fire("uploadcacel",t)},_uploadProgressHandler:function(t){this.currentUploadedByteValues[t.target.get("id")]=t.bytesLoaded;var n=t;n.originEvent=t,n.file=t.target,this.fire("uploadprogress",n);var r=this.totalBytesUploaded;e.each(this.currentUploadedByteValues,function(e){r+=e});var i=Math.min(100,Math.round(1e4*r/this.totalBytes)/100);this.fire("totaluploadprogress",{bytesLoaded:r,bytesTotal:this.totalBytes,percentLoaded:i})},startUpload:function(){this.queuedFiles=this.get("fileList").slice(0),this.numberOfUploads=0,this.currentUploadedByteValues={},this.currentFiles={},this.totalBytesUploaded=0,this._currentState=c.UPLOADING;while(this.numberOfUploads<this.get("simUploads")&&this.queuedFiles.length>0)this._startNextFile()},pauseUpload:function(){this._currentState=c.STOPPED},restartUpload:function(){this._currentState=c.UPLOADING;while(this.numberOfUploads<this.get("simUploads"))this._startNextFile()},forceReupload:function(e){var t=e.get("id");this.currentFiles.hasOwnProperty(t)&&(e.cancelUpload(),this._unregisterUpload(e),this.addToQueueTop(e),this._startNextFile())},addToQueueTop:function(e){this.queuedFiles.unshift(e)},addToQueueBottom:function(e){this.queuedFiles.push(e)},cancelUpload:function(e){if(e){var t=e.get("id");if(this.currentFiles[t])this.currentFiles[t].cancelUpload(),this._unregisterUpload(this.currentFiles[t]),this._currentState===c.UPLOADING&&this._startNextFile();else for(var n=0,r=this.queuedFiles.length;n<r;n++)if(this.queuedFiles[n].get("id")===t){this.queuedFiles.splice(n,1);break}}else{for(var i in this.currentFiles)this.currentFiles[i].cancelUpload(),this._unregisterUpload(this.currentFiles[i]);this.currentUploadedByteValues={},this.currentFiles={},this.totalBytesUploaded=0,this.fire("alluploadscancelled"),this._currentState=c.STOPPED}}},{CONTINUE:"continue",STOP:"stop",RESTART_ASAP:"restartasap",RESTART_AFTER:"restartafter",STOPPED:"stopped",UPLOADING:"uploading",NAME:"uploaderqueue",ATTRS:{simUploads:{value:2,validator:function(e,t){return e>=1&&e<=5}},errorAction:{value:"continue",validator:function(e,t){return e===c.CONTINUE||e===c.STOP||e===c.RESTART_ASAP||e===c.RESTART_AFTER}},bytesUploaded:{readOnly:!0,value:0},bytesTotal:{readOnly:!0,value:0},fileList:{value:[],lazyAdd:!1,setter:function(t){var n=t;return e.Array.each(n,function(e){this.totalBytes+=e.get("size")},this),t}},fileFieldName:{value:"Filedata"},uploadURL:{value:""},uploadHeaders:{value:{}},withCredentials:{value:!0},perFileParameters:{value:{}},retryCount:{value:3}}}),e.namespace("Uploader"),e.Uploader.Queue=c},"3.7.2",{requires:["base"]});
/*
YUI 3.7.2 (build 5639)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("uploader-html5",function(e,t){function i(e){i.superclass.constructor.apply(this,arguments)}var n=e.substitute,r=e.Uploader.Queue;e.UploaderHTML5=e.extend(i,e.Widget,{_fileInputField:null,_buttonBinding:null,queue:null,initializer:function(){this._fileInputField=null,this.queue=null,this._buttonBinding=null,this._fileList=[],this.publish("fileselect"),this.publish("uploadstart"),this.publish("fileuploadstart"),this.publish("uploadprogress"),this.publish("totaluploadprogress"),this.publish("uploadcomplete"),this.publish("alluploadscomplete"),this.publish("uploaderror"),this.publish("dragenter"),this.publish("dragover"),this.publish("dragleave"),this.publish("drop")},renderUI:function(){var t=this.get("boundingBox"),n=this.get("contentBox"),r=this.get("selectFilesButton");r.setStyles({width:"100%",height:"100%"}),n.append(r),this._fileInputField=e.Node.create(i.HTML5FILEFIELD_TEMPLATE),n.append(this._fileInputField)},bindUI:function(){this._bindSelectButton(),this._setMultipleFiles(),this._setFileFilters(),this._bindDropArea(),this._triggerEnabled(),this.after("multipleFilesChange",this._setMultipleFiles,this),this.after("fileFiltersChange",this._setFileFilters,this),this.after("enabledChange",this._triggerEnabled,this),this.after("selectFilesButtonChange",this._bindSelectButton,this),this.after("dragAndDropAreaChange",this._bindDropArea,this),this.after("tabIndexChange",function(e){this.get("selectFilesButton").set("tabIndex",this.get("tabIndex"))},this),this._fileInputField.on("change",this._updateFileList,this),this.get("selectFilesButton").set("tabIndex",this.get("tabIndex"))},_rebindFileField:function(){this._fileInputField.remove(!0),this._fileInputField=e.Node.create(i.HTML5FILEFIELD_TEMPLATE),this.get("contentBox").append(this._fileInputField),this._fileInputField.on("change",this._updateFileList,this),this._setMultipleFiles(),this._setFileFilters()},_bindDropArea:function(e){var t=e||{prevVal:null};t.prevVal!==null&&(t.prevVal.detach("drop",this._ddEventHandler),t.prevVal.detach("dragenter",this._ddEventHandler),t.prevVal.detach("dragover",this._ddEventHandler),t.prevVal.detach("dragleave",this._ddEventHandler));var n=this.get("dragAndDropArea");n!==null&&(n.on("drop",this._ddEventHandler,this),n.on("dragenter",this._ddEventHandler,this),n.on("dragover",this._ddEventHandler,this),n.on("dragleave",this._ddEventHandler,this))},_bindSelectButton:function(){this._buttonBinding=this.get("selectFilesButton").on("click",this.openFileSelectDialog,this)},_ddEventHandler:function(t){t.stopPropagation(),t.preventDefault();switch(t.type){case"dragenter":this.fire("dragenter");break;case"dragover":this.fire("dragover");break;case"dragleave":this.fire("dragleave");break;case"drop":var n=t._event.dataTransfer.files,r=[],i=this.get("fileFilterFunction");i?e.each(n,function(t){var n=new e.FileHTML5(t);i(n)&&r.push(n)}):e.each(n,function(t){r.push(new e.FileHTML5(t))});if(r.length>0){var s=this.get("fileList");this.set("fileList",this.get("appendNewFiles")?s.concat(r):r),this.fire("fileselect",{fileList:r})}this.fire("drop")}},_setButtonClass:function(e,t){t?this.get("selectFilesButton").addClass(this.get("buttonClassNames")[e]):this.get("selectFilesButton").removeClass(this.get("buttonClassNames")[e])},_setMultipleFiles:function(){this.get("multipleFiles")===!0?this._fileInputField.set("multiple","multiple"):this._fileInputField.set("multiple","")},_setFileFilters:function(){this.get("fileFilters").length>0?this._fileInputField.set("accept",this.get("fileFilters").join(",")):this._fileInputField.set("accept","")},_triggerEnabled:function(){this.get("enabled")&&this._buttonBinding===null?(this._bindSelectButton(),this._setButtonClass("disabled",!1),this.get("selectFilesButton").setAttribute("aria-disabled","false")):!this.get("enabled")&&this._buttonBinding&&(this._buttonBinding.detach(),this._buttonBinding=null,this._setButtonClass("disabled",!0),this.get("selectFilesButton").setAttribute("aria-disabled","true"))},_getFileList:function(e){return this._fileList.concat()},_setFileList:function(e){return this._fileList=e.concat(),this._fileList.concat()},_updateFileList:function(t){var n=t.target.getDOMNode().files,r=[],i=this.get("fileFilterFunction");i?e.each(n,function(t){var n=new e.FileHTML5(t);i(n)&&r.push(n)}):e.each(n,function(t){r.push(new e.FileHTML5(t))});if(r.length>0){var s=this.get("fileList");this.set("fileList",this.get("appendNewFiles")?s.concat(r):r),this.fire("fileselect",{fileList:r})}this._rebindFileField()},_uploadEventHandler:function(e){switch(e.type){case"file:uploadstart":this.fire("fileuploadstart",e);break;case"file:uploadprogress":this.fire("uploadprogress",e);break;case"uploaderqueue:totaluploadprogress":this.fire("totaluploadprogress",e);break;case"file:uploadcomplete":this.fire("uploadcomplete",e);break;case"uploaderqueue:alluploadscomplete":this.queue=null,this.fire("alluploadscomplete",e);break;case"file:uploaderror":case"uploaderqueue:uploaderror":this.fire("uploaderror",e);break;case"file:uploadcancel":case"uploaderqueue:uploadcancel":this.fire("uploadcancel",e)}},openFileSelectDialog:function(){var e=this._fileInputField.getDOMNode();e.click&&e.click()},upload:function(t,n,r){var i=n||this.get("uploadURL"),s=r||this.get("postVarsPerFile"),o=t.get("id");s=s.hasOwnProperty(o)?s[o]:s,t instanceof e.FileHTML5&&(t.on("uploadstart",this._uploadEventHandler,this),t.on("uploadprogress",this._uploadEventHandler,this),t.on("uploadcomplete",this._uploadEventHandler,this),t.on("uploaderror",this._uploadEventHandler,this),t.on("uploadcancel",this._uploadEventHandler,this),t.startUpload(i,s,this.get("fileFieldName")))},uploadAll:function(e,t){this.uploadThese(this.get("fileList"),e,t)},uploadThese:function(t,n,i){if(!this.queue){var s=n||this.get("uploadURL"),o=i||this.get("postVarsPerFile");this.queue=new r({simUploads:this.get("simLimit"),errorAction:this.get("errorAction"),fileFieldName:this.get("fileFieldName"),fileList:t,uploadURL:s,perFileParameters:o,retryCount:this.get("retryCount"),uploadHeaders:this.get("uploadHeaders"),withCredentials:this.get("withCredentials")}),this.queue.on("uploadstart",this._uploadEventHandler,this),this.queue.on("uploadprogress",this._uploadEventHandler,this),this.queue.on("totaluploadprogress",this._uploadEventHandler,this),this.queue.on("uploadcomplete",this._uploadEventHandler,this),this.queue.on("alluploadscomplete",this._uploadEventHandler,this),this.queue.on("uploadcancel",this._uploadEventHandler,this),this.queue.on("uploaderror",this._uploadEventHandler,this),this.queue.startUpload(),this.fire("uploadstart")}else this.queue._currentState===r.UPLOADING&&(this.queue.set("perFileParameters",this.get("postVarsPerFile")),e.each(t,function(e){this.queue.addToQueueBottom(e)},this))}},{HTML5FILEFIELD_TEMPLATE:"<input type='file' style='visibility:hidden; width:0px; height: 0px;'>",SELECT_FILES_BUTTON:"<button type='button' class='yui3-button' role='button' aria-label='{selectButtonLabel}' tabindex='{tabIndex}'>{selectButtonLabel}</button>",TYPE:"html5",NAME:"uploader",ATTRS:{appendNewFiles:{value:!0},buttonClassNames:{value:{hover:"yui3-button-hover",active:"yui3-button-active",disabled:"yui3-button-disabled",focus:"yui3-button-selected"}},dragAndDropArea:{value:null,setter:function(t){return e.one(t)}},enabled:{value:!0},errorAction:{value:"continue",validator:function(e,t){return e===r.CONTINUE||e===r.STOP||e===r.RESTART_ASAP||e===r.RESTART_AFTER}},fileFilters:{value:[]},fileFilterFunction:{value:null},fileFieldName:{value:"Filedata"},fileList:{value:[],getter:"_getFileList",setter:"_setFileList"},multipleFiles:{value:!1},postVarsPerFile:{value:{}},selectButtonLabel:{value:"Select Files"},selectFilesButton:{valueFn:function(){return e.Node.create(n(e.UploaderHTML5.SELECT_FILES_BUTTON,{selectButtonLabel:this.get("selectButtonLabel"),tabIndex:this.get("tabIndex")}))}},simLimit:{value:2,validator:function(e,t){return e>=1&&e<=5}},uploadURL:{value:""},uploadHeaders:{value:{}},withCredentials:{value:!0},retryCount:{value:3}}}),e.UploaderHTML5.Queue=r},"3.7.2",{requires:["widget","node-event-simulate","substitute","file-html5","uploader-queue"]});
YUI.add('tictac-attach-templates', function(Y) {
Y.namespace('tictac.attach.templates');
Y.tictac.attach.templates.dragdrop =  Y.Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  helpers = helpers || Handlebars.helpers; data = data || {};
  


  return "<div id='uploader-droparea' class='tictac-attach-droparea'><div>Drag and drop attachments here</div></div>";}

);
}, "1.0.0", {requires: ["handlebars-base"]});YUI.add("tictac-attach-strings", function(Y) {
	Y.namespace("tictac.attach").strings = {
		"str_attach_drag_here": "Drag and drop attachments here",
		"str_attach_html5_attach_button": "Attach File<br>[or Drag and Drop]",
		"str_attach_form_fallback_dialog_title": "Upload Error",
		"str_attach_form_fallback_dialog_body": "We're having trouble attaching this file. Try attaching again.",
		last: null
	};
}, "1.0.0");YUI.add("mail-ui-fullcompose",function(AR){var Ar=AR.Lang.trim,U=AR.Node.create,S=AR.mail.Controller.Compose,AY=[],AV=AR.common.Utils,W=AV.substitute,Aa=AV.escapeHtml,I=AV.unescapeHtml,As=AR.ui.Templates,k=As._shared_module_compose,Aj=As._shared_module_rte_well_tabs_compose,e=As._shared_module_rte_well_content_format.page_inoutdent_menu,R=As._shared_module_toolbar_compose,Ao=AR.common.persist.UserData,J=AR.mail.persist.MetaData,AU="hidden",AS="focus",Ae=500,t="",Ag="neo.pref.compose.wellDisplay",f={none:{well:null,tab:null,isRTE:true},atch:{well:".attachments-pane",tab:".rte .attachments",isRTE:false},emo:{well:".emoticons-pane",tab:".rte .emoticons",isRTE:true},fmt:{well:".format-pane",tab:".rte .rich-text",isRTE:true}},V={"align-l":"justifyleft","align-c":"justifycenter","align-r":"justifyright",inserthrule:"inserthorizontalrule",insertlink:"createlink",setfontstyle:"fontname",setfontsize:"fontsize",insertnumberedlist:"insertorderedlist",color:"notyet",hilitecolor:"notyet"},Ax=As._shared_module_compose_loading,j=[10,13,16,18,24,32,48],T=[8,10,12,14,18,24,36],A0=2000,E=7000,AP=AR.EditorBase.NC_KEYS,Au="offscreen",AW="restore",a="move",AB=AR.contacts,h=AB.api,m=AB.utils;var AQ=function(Y,A2,A4,A3){var A6=this,A1={};AQ.superclass.constructor.apply(A6,arguments);A6.lastACEl=null;A6.acInputs=null;A6.firstRender=true;A6.tab=null;A6.rtSwitch=null;A6.rtSwitch2=null;A6.rteArea=null;A6.formatButtons=null;A6.fontFamilyOptions=null;A6.fontSizeOptions=null;A6.spellCheckView=null;A6.scView=null;A6.slowOriginReqTimer=null;A6.keepHdrFocus=false;A6.formatShortcutTimer=null;A6.mouseFocusEvent=false;A6.composeViewRendered=false;A6.resizeHandle=null;A6.type="fullCompose";A6.evt=[];A6.numRetries=0;A6.canRetry=true;A6.lastSendState=null;A6.closeSrc="closeBtn";A1={bidi:NeoConfig.bidi,fullpage:NeoConfig.fullPage,isRTL:NeoConfig.isRTL,isFullSSL:NeoConfig.isFullSSL,isRich:A6._isRTEActive(),getDefaultFontInfo:S.getDefaultFontInfo,convertToPlain:S.convertToPlain};A6.editor=new AR.mail.RTEView(A1);A6.addChild(A6.editor);A6.wellTabFormatters={page_well_format:function(){return t=="format"?Aj.page_well_format:"";},page_well_emoticons:function(){return t=="emoticons"?Aj.page_well_emoticons:"";},page_well_attachments:function(){return t=="attachments"?Aj.page_well_attachments:"";},page_well_photos:function(){return t=="photos"?Aj.page_well_photos:"";},page_compose_email:function(){return W(Aj.page_compose_email,{},A6.wellTabFormatters,null,strings,As);}};A6.loadFormatters={start:function(A8,A7){return(A7=="start")?W(Ax.start,null,null,null,strings):"";},slow:function(A8,A7){return(A7=="slow")?W(Ax.slow,null,null,null,strings):"";},error:function(A8,A7){return(A7=="err")?W(Ax.error,null,A6.loadFormatters,null,strings):"";},populate:function(A8,A7){return(A7=="pop")?W(Ax.populate,null,null,null,strings):"";},can_retry:function(A8,A7){return(A6.canRetry)?W(Ax.can_retry,null,null,null,strings):"";}};A6.tbFormatters={lastsaved:function(){if(A6.lastSaveType===-1){return W(strings.str_comp_saveasdraftfail,0,0,0,{autosave_time:A6.lastSave});}else{if(A6.lastSave){if(A6.lastSaveType===1){return W(strings.str_comp_autosave,0,0,0,{autosave_time:A6.lastSave});}else{return W(strings.str_comp_saved,0,0,0,{saved_time:A6.lastSave});}}}return"";},isDirty:function(){return A6.enableSaveDraft?"":W(R.isDirty,null,null,null,strings);}};if(NeoConfig.bidi){AR.use("comms-intl-bidihighlight");}A6.evt.push(A6.on("closeChange",A6.handleCloseChange,A6));A6.evt.push(A6.on("activeChange",A6.handleActiveChanged,A6));var A5=Y.get("origin");A6.enableSaveDraft=(A5&&A5.oMsg)?true:false;};function n(){var A1=this,Y;if(A1.isSending){return;}Y=U(W(R.base,{},A1.tbFormatters,0,strings,As));A1.author.attachToolbar(new AR.mail.ui.Toolbar({root:Y}));}function AI(A2){var A3=this,Y,A1;if(A2.newVal){A3.updateToolbar();if(A3.composeViewRendered){if(A3.isDraft){Y="draft";}else{A1=(A3.cdo&&A3.cdo.get&&A3.cdo.get("origin"));Y=A1?A1.action:null;}Y=Y||"new";AR.Lang.later(90,null,function(){A3.fire("darlaEvent",{action:"compose_"+Y});});}A3.attView&&A3.attView.reposAttachObj(AW);if(AR.UA.ie){AR.Lang.later(20,null,function(){A3._resizeComposePage();});}}else{A3.header.hideACWidget();if(A3.dirty&&A3.dirty!=="ForceClose"&&NeoConfig.saveOnHideCompose){A3._invokeSaveDraft({auto:true});AV.rocketstats.stat("savemessage","switchingTab");}if(A3.hiliteCP){A3.hiliteCP.hide();}if(A3.textCP){A3.textCP.hide();}A3.attView&&A3.attView.reposAttachObj(Au);}if(A2.cbk){A2.cbk();}}function Ap(A6){var A7=this,A4=A7.attView,A5=A4&&A4.uploader,Y=A7.cdo,A3=Y.get("origin"),A1=A7.closeSrc,A2;if(A3&&A3.action!=null){A3=A3.action;}else{A3="new";}A2={action:"cmps_tab_cls",append:{t1:"cmpsTb",ltxt:A3}};switch(A1){case"closeBtn":break;case"escKey":A2.append.actn="keybrd";break;case"cancelBtn":A2.action="tlbr_cancelcompose";break;}AR.fire("mt:click",A2);A7.blockSave=true;if(A7.saveTimer){A7.saveTimer.cancel();}A7._clearOriginTimers();if(A7.hiliteCP){A7.hiliteCP.hide();}if(A7.textCP){A7.textCP.hide();}if(A7.resizeHandle){A7.resizeHandle.detach();}if(!AR.Lang.isNull(A7.spellCheckView)&&!AR.Lang.isUndefined(A7.spellCheckView)){A7.spellCheckView.destroy();}delete A7.spellCheckView;if(A4){A4.cleanUp&&A4.cleanUp();delete A7.attView;}if(Y){AR.each(Y.handles,function(A8){A8.detach&&A8.detach();});AR.each(Y.get("attachments"),function(A8){if(A8.timeout){clearTimeout(A8.timeout);A8.timeout=null;}});delete A7.cdo;}A7.fontFamilyOptions&&A7.fontFamilyOptions.remove().destroy(true);A7.fontSizeOptions&&A7.fontSizeOptions.remove().destroy(true);A7.formatButtons&&A7.formatButtons.remove().destroy(true);A7.fontFamilyOptions=null;A7.fontSizeOptions=null;A7.formatButtons=null;if(A7.baseNode){AR.each(A7.evt,function(A8){A8.detach();});delete A7.evt;A7.baseNode.remove().destroy(true);}A7.header.destroy();A7.header=null;A7.formatters=null;A7.author=null;}function b(A1){var A2=this,Y=A2.baseNode.one(".ac-input.focus .recipient-input input");if(Y){A2.header._lozengeIt(Y);}setTimeout(function(){A2._invokeSend(true,{saveBeforeSend:A1});
},0);}function F(A6){var A5=this,A1=A6?A6.dataAction:0,A3=(A6&&A6.rawEvent&&A6.rawEvent.shiftKey)?A6.rawEvent.shiftKey:false,A7={},Y="",A9=A5.cdo.get("origin");if(A9&&A9.action!=null){A9=A9.action;}else{A9="new";}switch(A1){case"send":A7.spid="sent";if(A5.lastSendState){Y=A5.lastSendState;}case"savedraft":A7.append={t1:"cmpsTb"};A7.action="tlbr_"+A1;if(Y){A7.append.ltxt=Y;}AR.fire("mt:click",A7);break;}switch(A1){case"send":A5._handleSendAction(A3);break;case"savedraft":A5.blockSave=true;A5._invokeSaveDraft();break;case"cancelcompose":A5.closeSrc="cancelBtn";A5.set("close",1);break;case"insertsignature":var BA=A5.cdo.get("isRichText"),A4,A2,A8=S.getSignature(A5.header.getHeader().from.email);if(A8){A4=A5.assembleSendBody();A2=A4.html;A2=S.injectSignature(A2,BA,A8);A5.cdo.set("content",A2,{textConvert:true});}break;default:break;}}function C(){var A8=this,BE,A5,Y,BA,A3,A1,A6,A4,A7,BD,A2,BC=A8.cdo,BB,A9=A8.evt;A9.push(A8.baseNode.delegate("click",function(BH){var BI=BH.currentTarget.get("className").replace(/emoticon_(\d+)/,A8.formatters.global_path_img()+"/emoticons/emo$1.gif"),BF=BH.currentTarget.getAttribute("title"),BG;BF=BF.replace(/"/,"&quot;").replace(/</,"&lt").replace(/>/,"&gt;").replace(/&/,"&amp;");BG='<img src="'+BI+'" alt="'+BF+'">';BH.target.blur();A8._invokeRTECommand("insertandfocus",BG);},".emoticons-pane li"));A9.push(A8.baseNode.delegate("keydown",function(BG){var BH,BF;if(BG.keyCode===13){BH=BG.target.get("nodeName");if(BH==="A"){BG.target.blur();BF=A8.baseNode.one("div.attachments-pane #attachment-button-input");BF&&BF.set("tabIndex","0");BG.target.simulate("click");BG.preventDefault();}else{if(AR.UA.ie&&AR.UA.ie<=9&&BH==="INPUT"){BG.preventDefault();}else{if(AR.UA.gecko>1.92&&BH==="INPUT"){BG.target._node&&BG.target._node.click();BG.preventDefault();}}}}},"#attachment-button-input,span.attachment-button-removeall a"));if(NeoConfig.bidi){A8.baseNode.all(".cm-subject-field").plug(AR.Plugin.BidiTextEntry);}if(!BC.handles){BC.handles=[];}if(NeoConfig.backButton&&(typeof window.history.state==="object")){if(!window.history.state||!window.history.state.id){window.history.pushState({id:"1"},document.title,window.location.pathname+window.location.search);}if(!window.location.hash.length){window.history.replaceState({id:"1"},document.title,"#mail");}}BB=BC.handles;BB.push(BC.on("compose:downloadAttachment",function(BG,BF){var BH=function(){AR.use("mail-common-downloader-v"+(NeoConfig.downloaderVersion||"1"),"mail-controller-messages",function(){var BK="Draft",BJ=A8.draftMID,BI={success:function(BS){var BR=[],BO=BC.get("attachments")[BF],BP,BQ,BN,BM=BS.attachments.length,BL;for(BL=0;BL<BM;BL++){BP=BS.attachments[BL];if((!BO.state.cancelled)&&(Ar(BP.filename)==BO.filename)){BQ={fid:BK,mid:BS.mid,pid:BP.partId,filename:BP.filename};BN=BP.tnefId;if(typeof BN!="undefined"){BQ.tnefid=BN;}BR.push(BQ);break;}}AR.mail.common.downloader.render(BR);},failure:function(BL){}};if(BJ){AR.mail.Controller.Messages.get({fid:BK,msg:{mid:BJ}},BI);}});};if(A8.draftMID){BH();}else{A8.downloadHandle=A8.on("compose:saveSuccess",function(){A8.downloadHandle.detach();BH();});A8._invokeSaveDraft();}}));A9.push(AR.on("mousedown",function(){A8.attView&&A8.attView.reposAttachObj(AW);},A8.baseNode.one(".attachment-button-attach")));A9.push(A8.editor.on({keyDown:function(BG){var BF=false;if(BG.ctrlKey||BG.metaKey||BG.altKey||BG.shiftKey){BF=A8.author?A8.author.onKeyDown(BG):A8.onKeyDown(BG);}if(BF){BG.halt();}else{A8._setDirty();}},nodeChange:function(BF){A8._updateRTToolbar(BF);},focus:function(BF){A8._registerFocus(BF.editor);},mousedown:function(BF){A8.header._removeLozengeHighlights();},drop:function(BH){var BF=A8.attView,BG=BF&&BF.uploader;A8._setDirty();if(BG&&BG.uploaderType===AR.mail.UploaderService.UPLOADER_TYPE_HTML5&&BG._ddEventHandler&&A8.author.get("active")){BG._ddEventHandler(BH);}},paste:function(){A8._setDirty();},ready:function(){if(A8.focusNode){A8.setFocus(A8.focusNode);}}}));BB.push(BC.on("compose:restoreFocus",function(){if(A8.focusNode instanceof AR.Node){A8._restoreFocus();}else{A8.setFocus("body",0,1);}},A8));A9.push(AR.on("click",function(BF){AR.fire("mt:click",{action:"cmps_stchpt",append:{t1:"cmpsTb",ltxt:(A8._isRTEActive()?"plaintext":"richtext")}});BF.halt(false);if(A8.allowEdit){A8._cmdTextSwitch();}},A8.rtSwitch));A9.push(AR.on("click",function(BF){BF.halt(false);if(A8.allowEdit){A8._cmdTextSwitch();}},A8.rtSwitch2));A9.push(AR.on("click",function(BH){BH.halt(false);if(A8.allowEdit){var BF=BH.currentTarget.get("parentNode").get("id")=="btn-show-bcc",BG="cmps_"+(BF?"shwbcc":"hdbcc");AR.fire("mt:click",{action:BG,append:{t1:"cmpsTb"}});A8.header._cmdBccSwitch(BF,"bcc");}A8._restoreFocus();},A8.baseNode.all("span.bcc-btn a")));A9.push(A8.baseNode.delegate("click",function(){A8._clearOriginTimers();A8._displayLoading();S.fetchOrigin(BC,A8.isDraft);},"a.retryOrigin"));A8.once("renderComplete",function(){A8.contentLoaded=true;AR.use("mail-controller-sendconfirm","mail-ui-sendconfirmview-base",function(BF){});});if(NeoConfig.fullPage||(AR.UA.ie&&AR.UA.ie>=8)){A8.resizeHandle=AR.on((AR.UA.ie&&AR.UA.ie<8)?"resize":"windowresize",function(){A8._resizeComposePage();});}if(NeoConfig.intl!=="jp"){A8._addFocusListeners();}A9.push(A8.baseNode.delegate("keydown",function(BG){var BF;if(BG.keyCode===13){BG.halt();A8.focusNode=BG.target;BF=BG.target.one("b");BF&&BF.simulate("click");}},"div.rte-well-container a"));A2=A8.baseNode.one("#attachment-button-input");if(A2){A9.push(A2.on({focus:function(BF){A2.ancestor("span").addClass("focused");},blur:function(BF){A2.ancestor("span").removeClass("focused");},click:function(BF){if(A8.attView.uploader&&A8.attView.uploader.uploaderType===AR.mail.UploaderService.UPLOADER_TYPE_YUI&&!A8.attView.formUploader){A8.attView.switchToFormUploader({skipDefault:true});}}}));}A8.evt.push(A8.on("compose:dirty",function(BH){if(!A8.enableSaveDraft){var BG=A8.author.get("contentToolbar"),BF=BG&&BG.root.one(".savedraft");BF&&BF.removeClass("disabled");A8.enableSaveDraft=true;
}}));}function At(){var A6=this,A4,A8,BD,A1=["bold","italic","underline"],A2,BE,A5,BA,BC,A7,BB,Y,A3,A9=A6.evt;A6.baseNode.all("div.gwell").addClass(AU);A6.baseNode.one("div.attachments-well").addClass(AU);Y=A6.baseNode.one("div.rte");if((A3=Y.one("li.active"))){A3.removeClass("active");A3.one("a").removeAttribute("aria-selected");}A2=Y.one("b.emoticons");BA=function(BF){AR.fire("mt:click",{action:"cmps_emo",append:{t1:"cmpsTb"}});if(A6.baseNode.one("div.emoticons-pane").hasClass(AU)&&(A6.baseNode.one("div.rich-text-switch-pane").hasClass("hidden")||!Y.one("b.emoticons").get("parentNode").get("parentNode").hasClass("active"))){A6._switchWell("emo",BF);}else{A6._closeWell(BF);}BF.preventDefault();};A9.push(A2.on("click",BA));BE=Y.one("b.rich-text");BB=A6.baseNode.one("div.format-pane");BC=function(BF){AR.fire("mt:click",{action:"cmps_fmt",append:{t1:"cmpsTb"}});if(BB.hasClass(AU)&&(A6.baseNode.one("div.rich-text-switch-pane").hasClass(AU)||!Y.one("b.rich-text").get("parentNode").get("parentNode").hasClass("active"))){A6._switchWell("fmt",BF);}else{A6._closeWell(BF);}BF.preventDefault();};A9.push(BE.on("click",BC));A5=Y.one("b.attachments");A7=function(BF){AR.fire("mt:click",{action:"cmps_attch",append:{t1:"cmpsTb"}});if(A6.attView.attachPaneHidden){A6._switchWell("atch",BF);}else{A6._closeWell(BF);}BF.preventDefault();};A9.push(A5.on("click",A7));A8=BB.all("select");A9.push(AR.on("change",function(BF){A6._invokeAction(BF.currentTarget.get("parentNode"),BF.currentTarget.get("value"));},A8));A9.push(BB.one(".showFontStyle").on("click",function(BF){if(BF.target.get("tagName")=="SELECT"){AR.fire("mt:click",{action:"cmps_wl_btn-fontname",append:{t1:"cmpsTb"}});}}));A9.push(BB.one(".showFontSize").on("click",function(BF){if(BF.target.get("tagName")=="SELECT"){AR.fire("mt:click",{action:"cmps_wl_btn-fontsize",append:{t1:"cmpsTb"}});}}));formatButtons=BB.all(".btn");A9.push(AR.on("click",function(BH){var BG=BH.currentTarget,BF=BG.getAttribute("data-action"),BI="cmps_wl_";if(BF=="menu"){BI+=BG.get("id");}else{BI+=BF;}AR.fire("mt:click",{action:BI,append:{t1:"cmpsTb"}});BH.preventDefault();A6._invokeAction(BH.currentTarget,"");},formatButtons));formatButtons.each(function(BG){var BH,BF=A1.length,BI=BG.getAttribute("data-action");if(BI){for(BH=0;BH<BF;BH++){if(A1[BH]==BI){BG.addClass("btnpress");}}}});BD=A6.baseNode.all("div.rte-pane span.close");A9.push(AR.on("click",function(BF){A6._closeWell(BF);A6._restoreFocus();},BD));A6._intlBindUIRTE();}function AM(A3){var A6=this,A2,A4;if(A3){A6.parent=A3;A2=W(k.base,A6.cdo,A6.formatters,null,strings,As);A3.append(A2);A6.baseNode=A3.one(".compose.content");A6.attView=new AR.mail.AttachmentView(A6.cdo,A6.parent);A6.compArea=A6.baseNode.one("div.compose-message").one("div.inner");A6.rtSwitch=A6.baseNode.one("b.plaintext");A6.rtSwitch2=A6.baseNode.one("div.rich-text-switch-pane").one("a");A6.rteArea=A6.compArea.one("div.cm-rtetext");A6.loadingArea=A6.compArea.one("div.cm-loadingpane");fo=S.getDefaultFontInfo(!A6._isRTEActive());A6.richFontInfo.fontFamily=fo.fontFamily;A6.richFontInfo.fontSize=fo.fontSize;A4=A6.baseNode.one("div.cm-plaintext");if(A4){A4.get("parentNode").removeChild(A4);}if(AR.UA.gecko&&!NeoConfig.fullPage){A6.compArea.ancestor("td").setStyle("height","0");}A6._switchEditMode(A6._isRTEActive());A6.header.enableHeader(false);A6.baseNode.all("div.gwell").addClass(AU);if(NeoConfig.low_bandwidth){var Y=A6.baseNode.all(".rte li"),A5=Y.size(),A1;Y.item(0).addClass("end-grp");for(A1=1;A1<A5;A1++){Y.item(A1).addClass(AU);}}A6.bindUI();A6.header.render();A6.composeViewRendered=true;}}function Af(){var A4=this,A1=A4.evt;function Y(A6){var A9=A6.params,A8={attachments:1,format:1};if(!A8.hasOwnProperty(A9.tab)){return;}if(!A4.baseNode){return;}A9.tooltip=A9.tooltip||"";var A5=["<span class='btn left right menu' data-app='",A6.appInstance,"'>","<a href='#' title='",A9.tooltip,"'>",A9.label,"</a>","</span>"].join(""),A7=U(A5);A4.baseNode.one("."+A9.tab+"-pane").one(".om-buttons").append(A7);A1.push(A7.on("click",function(BA){BA.preventDefault();A6.handler(AR.stamp(A7),A4);}));}function A2(A5){if(!A4.baseNode){return;}A4.baseNode.all('.om-buttons > span[data-app="'+A5+'"]').remove().destroy(true);}function A3(A7,A6){var A5=A4.baseNode.one("."+A6+"-pane").one(".om-buttons");A5=A5.one('span[data-app="'+A7+'"] > a');if(A5){A5.simulate("click");}}AR.each(AY,Y);A1.push(AR.on("om:compose_add_btn",function(){Y(AY[AY.length-1]);}));A1.push(AR.on("om:click_btn",function(A5){if(!A5.app||!A5.app.instance||!A5.tab){return;}A3(A5.app.instance,A5.tab);}));A1.push(AR.on("om:compose_remove_btns",A2));}function Ah(){var A6=this,A8,A4,A1,A3,BC,A9,Y,A2,A7,BA=A6.cdo,BB;A6.editor.render(A6.baseNode);A6._bindWellUI();BB=A6.baseNode.one("div.format-pane");A6.formatButtons=BB.all(".btn");A6.fontFamilyOptions=BB.all("span.showFontStyle select option");A6.fontSizeOptions=BB.all("span.showFontSize select option");A6._bindCDO();if(A6._isOrigin()){A6.slowOriginReqTimer=setTimeout(function(){A6._handleSlowOriginRequest();},E);A6.loadingTimer=setTimeout(function(){A6._displayLoading();},A0);if(AR.UA.ie){A6.rteArea.setStyle("display","none");}if(A6.cdo&&A6.cdo.get("passive")){text=A6.cdo.get("content");A6.contentChangeAfter(text);A6.replyheaderChangeAfter();A6.replyContentChangeAfter(text);if(A6.cdo.get("attachments")){var A5=BA.oComposeData.attachments.length;for(i=0;i<A5;i++){A6.attView.addNewAttachment(i);}}}else{S.fetchOrigin(BA,A6.isDraft,A6.stopwatch,function(){if(A6.isDraft&&BA&&BA.oComposeData&&BA.oComposeData.origin&&BA.oComposeData.origin.oMsg){A6.draftMID=BA.oComposeData.origin.oMsg.mid;}});}if(A6.isDraft){AR.Lang.later(90,null,function(){A6.fire("darlaEvent",{action:"compose_draft"});});A6.hasHardDraft=true;A6.draftMID=BA.oComposeData.origin.oMsg.mid;}else{A7=BA.get("origin");AR.Lang.later(90,null,function(){A6.fire("darlaEvent",{action:"compose_"+A7.action});});}A1=BA.oComposeData.origin.oMsg;A3=A1&&A1.header&&A1.header.to;BC=A6.baseNode.all("#from-field option");AR.Array.some(A3||[],function(BD){BC.each(function(BF,BE){var BG=BF.get("value").replace(/.+\<(.+)\>/,"$1");
if(BD.email==BG){AR.later(100,A6,function(){BF.get("parentNode").set("selectedIndex",BE);});return true;}});});if(A1.header.from&&A6.isDraft){AR.later(10,A6,function(){A6.header._setFromMenu(A1.header.from);});}}else{A8=BA.get("header");A6.header.setHeader(A8);A6._allowEditing(BA.get("content"));A6.dirty=BA.get("prePopulated");A6.setFocus((A8.to&&A8.to.length>0)?"body":"to");A6.fire("darlaEvent",{action:"compose_new"});}if(NeoConfig.fullPage){A6._resizeComposePage();}else{if(A6.editor.get("ready")){A6.editor.resize(true);}}if(BA.get("passive")){A6.dirty=1;}Y=A6.richFontInfo.fontFamily;A2=A6.richFontInfo.fontSize;A6.fontFamilyOptions.each(function(BD){var BE=BD.get("value");if(BE===Y){BD.set("selected",true);}});if(A2){A9=parseInt(A2.replace("pt",""));A9=AR.Array.indexOf(T,A9);if(A9>=0){A6.fontSizeOptions.item(A9).set("selected",true);}}A6._initOpenMailButtons();}function An(){var A6=this,A3,Y,A5,A4,A2=A6.baseNode.one("div.emoticons-pane ul"),A1=A6.evt;A2.plug(AR.comms.ui.NodeFocusBase,{descendants:"li",keys:{next:"39",previous:"37"}});A1.push(A2.delegate("keydown",function(A7){if(A7.keyCode===9&&!A7.shiftKey){A4=A6.baseNode.one(".attachments-well");if(A4&&!A4.hasClass(AU)){A3=A4.one('li.attachmentVisible span.left a[tabIndex="0"]');if(!A3){A3=A4.one("li.attachmentVisible span.left a");A3&&A3.set("tabIndex","0");}}else{A7.target.blur();A6.setFocus("body");A7.halt();}}else{if(AR.UA.gecko&&A7.keyCode===9){A3=AR.one('.rte li a[tabIndex="0"]');A3&&A6.setFocus(A3);A7.halt();}else{if(A7.keyCode===13||A7.keyCode===32){A7.target.simulate("click");A7.halt();}}}},"li"));A2=A6.baseNode.one("div.attachments-pane");A2.plug(AR.comms.ui.NodeFocusBase,{descendants:"input[type=file],span.attachment-button-removeall a",keys:{next:"39",previous:"37"}});A1.push(A2.delegate("keydown",function(A7){A3=null;if(A7.keyCode===9){if(!A7.shiftKey){A4=A6.baseNode.one(".attachments-well");if(A4&&!A4.hasClass(AU)){A3=A4.one('li.attachmentVisible span.left a[tabIndex="0"]');if(!A3){A3=A4.one("li.attachmentVisible span.left a");A3&&A3.set("tabIndex","0");}}else{A7.target.blur();A6.setFocus("body");A7.halt();}}else{A6.baseNode.all("div.rte li a").each(function(A8){if(A8.get("tabIndex")=="0"&&!A3){A3=A8;}});if(!A3){A3=A6.baseNode.one("div.rte li a");}A3.focus();A7.halt();}}},"span"));A2=A6.baseNode.one("div.rte-well-container div.rte");A2.plug(AR.comms.ui.NodeFocusBase,{descendants:"a[role=tab]",keys:{next:"39",previous:"37"}});A1.push(A2.delegate("keydown",function(A8){if(A8.keyCode===9&&!A8.shiftKey){var A7=A6.baseNode.one("div.rte-well-container .rte li.active a");if(!A7||(AR.UA.ie&&AR.UA.ie<8&&A7.get("target")=="attachments")){A4=A6.baseNode.one(".attachments-well");if(A4&&!A4.hasClass(AU)){A3=A4.one('li.attachmentVisible span.left a[tabIndex="0"]');if(!A3){A3=A4.one("li.attachmentVisible span.left a");A3&&A3.set("tabIndex","0");}}else{A8.target.blur();A6.setFocus("body");A8.halt();}}}},"a"));A2=A6.baseNode.one(".attachments-well");A1.push(A2.delegate("keydown",function(A7){A5=null;Y=null;A3=null;switch(A7.keyCode){case 8:case 46:A7.target.blur();A7.target.set("tabIndex","-1");Y=A7.target.ancestor("li");A3=Y.previous(".attachmentVisible")||Y.next(".attachmentVisible");if(A3){A3=A3.one("span.left a");if(A3){A3.set("tabIndex","0");A6.setFocus(A3);}}else{A6.setFocus("body",0,1);}Y.one(".lozengeremove a").simulate("click");break;case 9:if(!A7.shiftKey){A7.target.blur();A6.setFocus("body");A7.halt();}break;case 37:case 38:A5="previous";case 39:case 40:A5=(A5?A5:"next");Y=A7.target.ancestor("li")[A5](".attachmentVisible");if(Y){A3=Y.one("span.left a");if(A3){A7.target.set("tabIndex","-1");A3.set("tabIndex","0");A6.setFocus(A3);}}break;}},"a"));A2=A6.baseNode.one(".rich-text-switch-pane");A1.push(A2.delegate("keydown",function(A7){if(A7.keyCode===9&&!A7.shiftKey){A4=A6.baseNode.one(".attachments-well");if(A4&&!A4.hasClass(AU)){A3=A4.one('li.attachmentVisible span.left a[tabIndex="0"]');if(!A3){A3=A4.one("li.attachmentVisible span.left a");A3&&A3.set("tabIndex","0");}}else{A7.target.blur();A6.setFocus("body");A7.halt();}}else{if(A7.keyCode===13||A7.keyCode==32){if(A7.keyCode===32){A7.target.simulate("click");}A7.preventDefault();A7.target.blur();A6.setFocus("body");}}},"a"));A2=A6.baseNode.one("div.format-pane div.format-inner");A1.push(A2.on("keydown",function(BA){var A9=BA.target,BC=A9.get("nodeName"),A7=A9.ancestor("span"),A8;if(!A7||(BC!="A"&&BC!="SELECT")){return;}switch(BA.keyCode){case 9:if(A7.hasClass("showFontSize")&&!BA.shiftKey){var BB=A6.baseNode.one('.format-pane .format-inner a[tabIndex="0"]');if(BB){BB.focus();}else{A6.baseNode.one(".format-pane .format-inner a").focus();}BA.halt();}else{if(A7.hasClass("showFontStyle")&&BA.shiftKey){var BB=A6.baseNode.one('.rte li a[tabIndex="0"]');if(BB){BB.focus();}else{A6.baseNode.one(".rte li a").focus();}BA.halt();}else{if(BC=="A"&&!BA.shiftKey){A4=A6.baseNode.one(".attachments-well");if(A4&&!A4.hasClass(AU)){A3=A4.one('li.attachmentVisible span.left a[tabIndex="0"]');if(!A3){A3=A4.one("li.attachmentVisible span.left a");A3&&A3.set("tabIndex","0");}}else{BA.target.blur();A6.setFocus("body");BA.halt();}}}}break;case 13:case 32:if(BC=="A"){A9.simulate("click");}break;case 37:case 39:if(BC!="A"){return;}if(BA.keyCode===37){if(A7.one("a")&&A7.one("a").hasClass("bold")){return;}A8=A7.previous("span");}else{if(BA.keyCode===39){if(A7.get("id")==="btn-spell-langs"){return;}A8=A7.next("span");}}if(A8){A8=A8.one("a");if(A8){A9.set("tabIndex","-1");A8.set("tabIndex","0");A8.focus();}}break;default:}}));}function l(BE){var BD=this,A7=BE.keyCode,A8,A4=(BE.ctrlKey||BE.metaKey)&&(!BE.altKey&&!BE.shiftKey),A6=AR.UA.os,BF=(BE.ctrlKey&&(A6=="windows"||A6=="win"))||(BE.metaKey&&(A6=="macintosh"||A6=="mac")),Y=BF&&A4,BH=null,BC,A5=false;switch(A7){case 85:if((BF&&BE.shiftKey)&&!AR.UA.ie&&(!AR.UA.gecko||AR.UA.gecko>1.92)&&(BC=BD.baseNode.one("#attachment-button-input"))){if(!BD.baseNode.one("ul[role=tablist] li").hasClass("active")){BD._switchWell("atch",BE);}BC._node.click();BE.halt();}break;case 13:if(BF&&!BE.altKey){A5=(BE.shiftKey?true:false);
var A2={spid:"sent",append:{t1:"cmpsTb",actn:"keybrd"},action:"tlbr_send"};if(BD.lastSendState){A2.append.ltxt=BD.lastSendState;}AR.fire("mt:click",A2);BD._handleSendAction(A5);if(BE.frameEvent){BE.frameEvent.halt();}BE.halt();return true;}else{if(BE.target.get("nodeName")=="A"){BE.target.simulate("click");return true;}}break;case 83:if(A4){BD._invokeSaveDraft();if(BE.frameEvent){BE.frameEvent.halt();}BE.halt();return true;}break;case 89:if((BE.ctrlKey||BE.metaKey)&&BE.shiftKey){BE.halt();if(BD.allowEdit){BD._cmdTextSwitch();}return true;}break;case 219:case 221:AR.fire("tabview:handleKeyDown",BE);break;default:break;}if(BE.frameEvent){if(A4||(NeoConfig.bidi&&BE.ctrlKey)){switch(A7){case 66:BH="bold";break;case 73:BH="italic";break;case 85:BH="underline";break;case 16:if(NeoConfig.bidi){BH="bidi";}break;case 86:BD._setDirty();break;default:break;}if(BH){if(BD._isRTEActive()){BH=BD.baseNode.one(".format-pane .btn[data-action="+BH+"]");clearTimeout(BD.formatShortcutTimer);BD.formatShortcutTimer=setTimeout(function(){BD._invokeAction(BH,"",true);},100);}BE.frameEvent.halt();return true;}}else{if(BE.shiftKey){if(A7==9){var A1=BD.baseNode.one("div.rte-well-container"),A3=A1.one("li.active b"),A9,BA=A1.one(".rich-text-switch-pane"),BB=A1.one(".attachments-well"),BG;if(BB&&!BB.hasClass(AU)){BB.all("li.attachmentVisible span.left a").each(function(BI){if(!A9&&BI.get("tabIndex")=="0"){A9=BI;}});if(!A9){A9=BB.one("li.attachmentVisible span.left a");A9.set("tabIndex","0");}}else{if(!A3){BD.baseNode.all("div.rte li a").each(function(BI){if(!A9&&BI.get("tabIndex")=="0"){A9=BI;}});if(!A9){A9=A1.one("li a");}}else{if(BA&&!BA.hasClass(AU)){A9=BA.one("a");}else{if(A3.hasClass("attachments")){BG=function(){BD.baseNode.all("#attachment-button-input, .attachments-pane span.attachment-button-removeall a").each(function(BI){if(!A9&&BI.get("tabIndex")=="0"){A9=BI;}});if(!A9){A9=BD.baseNode.one("#attachment-button-input");}if(AR.UA.ie&&AR.UA.ie<8){A9&&AR.later(0,A9,function(){BD.setFocus(A9);A9.simulate("keydown",{keyCode:9});});A9=null;}};if(BD.attView.uploader.uploaderType===AR.mail.UploaderService.UPLOADER_TYPE_YUI&&!BD.attView.formUploader){BG();BD.attView.switchToFormUploader({skipDefault:true});}else{BG();}}else{if(A3.hasClass("emoticons")){BD.baseNode.all("div.emoticons-pane li").each(function(BI){if(BI.get("tabIndex")=="0"){A9=BI;}});if(!A9){A9=BD.baseNode.one("div.emoticons-pane li");}}else{if(A3.hasClass("rich-text")){A9=BD.baseNode.one("div.format-pane .showFontStyle select");}}}}}}A9&&BD.setFocus(A9);BE.frameEvent.halt();return true;}}}}if(A4){return true;}return false;}function s(A1){var Y=AR.Node.getDOMNode(A1);if(Y!=null){return(Y.tagName.toUpperCase()=="DIV");}return false;}function AO(){var A2=this,Y=A2.cdo,A1;if(!Y.handles){Y.handles=[];}A1=Y.handles;A1.push(Y.after("contentChange",function(A3){A2.contentChangeAfter(A3);}));A1.push(Y.after("isRichTextChange",function(A3){A2.editor.set("isRich",!NeoConfig.low_bandwidth&&A3.newVal);A2._switchEditMode(A3.newVal);}));A1.push(Y.after("replyheaderChange",function(){A2.replyheaderChangeAfter();}));A1.push(Y.after("replycontentChange",function(A3){AV.rocketstats.stat("compose","TAE4:GDM:SUCCESS:"+A2.numRetries);A2.replyContentChangeAfter(A3);}));A1.push(Y.after("originerrorChange",function(A7){A2._clearOriginTimers();var A6=A7.newVal,A5=A6.data&&A6.data.status,A4={"MessageFetchFailed":true,"MessageIdsNotFound":true,"MessageNotFound":true,"GetMessageInvalidId":true,"MessageSelectionNotFound":true},A8;function A3(BA){var A9=BA&&(BA.match(/Client\.([\w\W]+)$/)||BA.match(/Server\.([\w\W]+)$/));return(A9&&A9[1])||BA;}A8=A3(A6.code);if(A4[A8]==true||(A2.numRetries>=3&&A6.reason==6)){A2.canRetry=false;AV.rocketstats.stat("compose","TAE4:GDM:NoRetry:"+A8);}if((A4[A8]==true||A6.reason==6)){AV.rocketstats.stat("compose","TAE4:GDM:FAILURE:"+A2.numRetries+":"+A6.reason);}A2.numRetries++;if(A6.code!=AR.common.net.Error.abort){A2._writeLoadingHtml("err");}}));A1.push(Y.on("CDO_ATTACHMENT_ADDED",function(A5,A4,A3){A2._setDirty();if(!A3){A2.attachmentsLoading[A4]=1;}A2.editor.resize();}));A1.push(Y.on("CDO_ATTACHMENT_DELETED",function(A4,A3){A2._setDirty();A2.editor.resize();A2.attachmentsLoading[A3]=0;if(AR.UA.os=="macintosh"&&AR.UA.chrome>=11){A2.setFocus("body",0,1);}else{A2._restoreFocus();}}));A1.push(Y.on("CDO_ATTACHMENT_PROCESSED",function(A4,A3){A2._setDirty();A2.attachmentsLoading[A3]=0;}));A1.push(Y.on("CDO_ATTACHMENT_FILES_SELECTED",function(A4){var A3=A2.baseNode.one("#attachment-button-input");if(A3){A3.blur();}if(AR.UA.os=="macintosh"&&(AR.UA.chrome||AR.UA.safari)){A2.setFocus("body",0,1);}else{A2._restoreFocus();}}));}function AN(Y){var A1=this;if(!Y.uiUpdate){Y.newVal?A1.editor.setContent(Y.newVal,!Y.textConvert||AR.UA.gecko):A1.editor.setContent(A1.cdo.get("content"));}}function Aw(){var A1=this,Y;A1.header.setHeader(A1.cdo.get("header"));Y=A1.cdo.get("header").subject;A1.author.updateTabTitle(Aa(I(Y)));if(NeoConfig.bidi){A1.author.updateTabDirection(AR.Intl.detectDirection(Y));}}function w(Y){var A2=this;A2._allowEditing(Y.newVal);A2.header.enableSwitchReplyButton();A2.dirty=false;var A1=A2.cdo.get("header");A2.setFocus((A1.to&&A1.to.length>0)?"body":"to");}function G(Y){var A2=this,A1;A2.rtSwitch.setContent(strings[Y?"str_rte_plaintext":"str_rte_richtext"]);A2._toggleRTEWellMode(Y);}function Am(){var A4=this,Y={content:A4.getContent()},A2,A3;A4.cdo.updateData(Y);if(A4._isRTEActive()){function A1(){A4._setDirty();S.toPlainText(A4.cdo,A4.editor.get("content"));A4.setFocus("body");}if(A4.editor.hasContent()){A3=true;A4.confirm(null,strings.str_comp_conf_plainText,A1);}else{A1();}}else{A4._setDirty();S.toRichText(A4.cdo);}!A3&&A4._restoreFocus();}function Av(){return !NeoConfig.low_bandwidth&&this.cdo.get("isRichText");}function Ay(){return(this.spellCheckView&&this._isRTEActive());}function Q(Y){return this.baseNode.one(".cm-"+Y+" ul li");}function A(){return this.editor.getContent();}function AH(){return this.editor.getRTE();}function Ai(A4,A3,Y){var A6=this,A2=true,A5,A1=A6.editor.getRTE();
if((typeof A4=="string")){A5=A6.baseNode.one(".compose-header");switch(A4){case"to":case"cc":case"bcc":case"subject":A5=A6.baseNode.one(".compose-header");A4=A5.one(".cm-"+A4+"-field");break;case"body":A4=A1;A2=(Y&&AR.UA.os=="macintosh"&&(AR.UA.chrome||AR.UA.safari))?0:A6.editor.get("ready");break;}}if(A2){if(A4==A1){A6.editor.setFocus(A3);}else{A4&&A4.focus();}}A4&&A6._registerFocus(A4);}function AZ(A1){var A2=this,Y;A2._clearOriginTimers();A2.header.enableHeader(true);if(AR.UA.ie){A2.rteArea.setStyle("display","block");}A2.rteArea.setStyle("visibility","");A2.loadingArea.addClass(AU);Y=J.get(Ag);if(AR.Lang.isUndefined(Y)||(typeof Y!="string")||AR.Lang.isUndefined(f[Y])){Y="fmt";J.set(Ag,Y);}if(NeoConfig.low_bandwidth){Y="none";}if(Y!="none"){A2._switchWellGuts(Y);}if(A1){A2.editor.setContent(A1,!A2.isDraft);}A2.header.allowEditing(A1);A2._adjustLowRes();A2.allowEdit=true;A2.fire("renderComplete");}function o(){var Y=this;if(!NeoConfig.fullPage&&screen.height<=600){if(Y.compArea.ancestor("TR").getY()>Y.baseNode.get("winHeight")-30){Y._closeWellGuts();}}}function p(Y,A2){var A4=this,A1=null,A3=A2;switch(Y){case"fontname":A1="userUIPref.composeFontFamily";break;case"fontsize":A4.fontSizeOptions.each(function(A5){if(A3==A5.get("value")){A2=A5.get("text");A1="userUIPref.composeFontSize";}});break;default:break;}if(A1&&A2){S.savePref(A1,A2);}}function c(Y,A3){var A4=this,A2,A1;if(A2=V[Y]){Y=A2;}if(Y=="notyet"){alert("not yet");}else{if(Y=="forecolor"){if(!A4._formatPane){A4._formatPane=A4.baseNode.one(".format-pane");}A1=A4._formatPane.one("#btn-forecolor i");A1.setStyle("backgroundColor",A3);}A4._setComposePreference(Y,A3);A4._invokeRTECommand(Y,A3);}}function AG(Y,A1){var A2=this;A2._setDirty();A2.setFocus("body",function(){A2.editor.execute(Y,A1);});}function AC(){var A3=this,A2,A1,Y=A3.evt;if(!A3._formatPane){A3._formatPane=A3.baseNode.one(".format-pane");}A2=A3._formatPane.one(".btn[data-action="+"spellcheck"+"]");A1=A2.next();Y.push(A2.on("click",function(A4){A3._doSpellCheck();A4.preventDefault();}));Y.push(A1.on("click",function(A4){A3._openSpellCheckMenu(A4);A4.preventDefault();}));}function Aq(A1,A2,A4){var A3=this,Y;AR.use("editor-lists","createlink-base",function(A5){A3.editor.plug(A5.Plugin.EditorLists);Y=A1.getAttribute("data-action");if(Y&&(Y==="color"||Y==="hilitecolor")){}else{if(Y&&Y!="menu"){if((Y=="bold")||(Y=="italic")||(Y=="underline")){A1.toggleClass("pressed");}else{if(Y&&Y==="insertlink"){A5.Plugin.CreateLinkBase.STRINGS.PROMPT=strings.str_comp_createlink_prompt;A5.Plugin.CreateLinkBase.STRINGS.DEFAULT=strings.str_comp_createlink_default;}else{if(Y&&Y==="bidi"){if(!A4){A2=A1.getAttribute("value");}}}}A3._invokeDataAction(Y,A2);}else{if(A1.hasClass("menu")){A3._showMenus(A1);}}}});}function AL(Y){var A6=this,A4,A9,A2,A1,A8,A7,A5,BA,BB,A3=false;if(Y.menu){return;}A9=Y.get("id");AR.use("common-ui-menu-helper","menus_css",function(){switch(A9){case"btn-indent":A4=e;break;case"btn-text-align":A4=As._shared_module_offscreen_bin_compose_menu_text_align.base;break;case"btn-list":A4=As._shared_module_offscreen_bin_compose_menu_list.base;break;case"btn-forecolor":case"btn-backcolor":A8=[["000000","111111","2d2d2d","434343","5b5b5b","737373","8b8b8b","a2a2a2","b9b9b9","d0d0d0","e6e6e6","ffffff"],["7f7f00","bfbf00","ffff00","ffff40","ffff80","ffffbf","525330","898a49","aea945","c3be71","e0dcaa","fcfae1"],["407f00","60bf00","80ff00","a0ff40","c0ff80","dfffbf","3b5738","668f5a","7f9757","8a9b55","b7c296","e6ebd5"],["007f40","00bf60","00ff80","40ffa0","80ffc0","bfffdf","033d21","438059","7fa37c","8dae94","acc6b5","ddebe2"],["007f7f","00bfbf","00ffff","40ffff","80ffff","bfffff","033d3d","347d7e","609a9f","96bdc4","b5d1d7","e2f1f4"],["00407f","0060bf","0080ff","40a0ff","80c0ff","bfdfff","1b2c48","385376","57708f","7792ac","a8bed1","deebf6"],["00007f","0000bf","0000ff","4040ff","8080ff","bfbfff","212143","373e68","444f75","585e82","8687a4","d2d1e1"],["40007f","6000bf","8000ff","a040ff","c080ff","dfbfff","302449","54466f","655a7f","726284","9e8fa9","dcd1df"],["7f007f","bf00bf","ff00ff","ff40ff","ff80ff","ffbfff","4a234a","794a72","936386","9d7292","c0a0b6","ecdae5"],["7f003f","bf005f","ff007f","ff409f","ff80bf","ffbfdf","451528","823857","a94a76","bc6f95","d8a5bb","f7dde9"],["800000","c00000","ff0000","ff4040","ff8080","ffc0c0","441415","82393c","aa4d4e","bc6e6e","d8a3a4","f8dddd"],["7f3f00","bf5f00","ff7f00","ff9f40","ffbf80","ffdfbf","482c1b","855a40","b27c51","c49b71","e1c4a8","fdeee0"]];A7=A8[0].length;A5=A8.length;A4=["<div id='menu-color-picker' class='optionMenu colorPickerMenu'>"];A1=(A9=="btn-forecolor")?"forecolor":"backcolor";for(BA=0;BA<A5;BA++){A4.push("<ul>");for(BB=0;BB<A7;BB++){A4.push("<li style='background-color:#",A8[BA][BB],";' data-action='",A1,"' data-value='#",A8[BA][BB],"'><a href='#'></a></li>");}A4.push("</ul>");}A4.push("</div>");A4=A4.join("");break;default:break;}if(A4){A2=A6._showRTEMenu(W(A4,null,null,null,strings),Y,function(BC){A6.evt.push(BC.on("menuSelected",function(BD){A6._invokeDataAction(BD.dataAction,BD.dataValue);}));});}});}function O(A5,BK){var BG=this,BH=BG.header.getHeader(),BB=true,A7=false,A6=0,BM=BG.cdo._getAttachments(),A3,Y,A8,BL,BJ,BC,BI,BE=true,A9,A1=BG.getRTEInstance(),BF,BA,A4;if(BG.isSending){return;}A4=function(BN){BG.allowSend=true;if(!BN){BG.setFocus("body",0,1);}else{BG._restoreFocus();}};if(BG.allowSend){if(BG.baseNode.one(".file-attach .downloading:not(.hidden)")){AR.use("common-ui-dialog-helper",function(BN){BG.allowSend=false;BN.common.ui.DialogHelper.alert({hd:strings.str_comp_dialogheader,bd:strings.str_comp_still_uploading,suppressRestoreFocus:true},{ok:{handler:A4},cancel:{handler:A4}});});BG.lastSendState="attInPrgrss";return;}}else{return;}if(BG.attView&&BG.attView.checkOverLimit()){BG.lastSendState="attOvrLmt";return;}while(BB&&BM[A6]){Y=BM[A6++].state;if(!Y.cancelled&&Y.failed){BB=false;}if(Y.failCause=="virus"){A7=true;}}if(!BB){BG._alertInvalidAttachments(A7);BG.lastSendState="attInvld";return;}if(!BH.validAddress){var BD=strings.str_comp_invalidAddressA+"<br><br>"+Aa(BH.currentAddress)+"<br><br>";
BD+=W(strings.str_comp_invalidAddressB,null,null,null,strings);BG._alertProblem(strings.str_comp_title_invalidAddr,BD);BG.lastSendState="addInvld";return;}if(BH.to.length<1&&BH.cc.length<1&&BH.bcc.length<1){BG._alertProblem(strings.str_comp_title_emptyToField,strings.str_comp_emptyToField);BG._registerFocus(AR.one("#to-field"));BG.lastSendState="addEmpty";return;}if(BK.saveBeforeSend){BG._invokeSaveDraft({saveBeforeSend:true});BG.lastSendState="svDrft";return;}BF=A1.all("a");BF.each(function(BO){var BN=BO.get("href");if(typeof(BN)==="string"){BN=BN.replace(/&amp;/g,"&");BO.set("href",BN);}});A9=new AV.Stopwatch("SendConfirm","start");A3=BG.assembleSendBody();var A2=function(){var BQ=BG.baseNode.one(".attachment-button-attach"),BO=BG.cdo.get("origin");if(BQ){BQ.fire("compose:close");}if(BG.isSending){return;}else{BG.isSending=true;}BG._cancelSaveTimer();BG.dirty=false;var BN={header:BG.header.getHeader(),content:A3.html,textcontent:A3.text};BG.cdo.updateData(BN);A8={draftMID:BG.draftMID,noScroll:A5,keepDraft:BK.keepDraft?BK.keepDraft:false,cid:BO.oMsg&&BO.oMsg.cid};var BP=BG.cdo.oComposeData.header;BG.author.invokeSend(BG.cdo,A8,A9);};BL=Ar(BH.subj);BJ=Ar(A3.text);if(BG.getRTEDocNode().one("body img")){BE=false;}if(BL.length<1&&BJ.length<1&&BE){BC=strings.str_modal_send_msg_title;BI=strings.str_comp_invalidSubjectAndContent;BA=strings.str_comp_send;BG.lastSendState="sbCntInvld";}if(BG.allowSend){if(BI){BG.allowSend=false;BG.confirm(BC,BI,function(){A2();},function(){A4(AR.one("#subject-field"));},BA);}else{A2();}}}function X(Y){var A3=this,A1,A2=A3.baseNode.one(".attachment-button-attach");if(Y){A1=A3.cdo.after("saveactionChange",function(A4){A1.detach();A3.author.set("forceClose",1);A3.author.set("close",1);A2.fire("compose:close");});}else{A2.fire("compose:close");A3.author.set("forceClose",1);A3.author.set("close",1);}}function r(A2,A1,Y){A2.addClass(AU);}function B(Y){Y.removeClass(AU);}function d(A3,A2){var A5=this,A4,Y,A1;if(A2){A2.preventDefault();}if(!A5.allowEdit){return;}A5._switchWellGuts(A3,A2);A5._restoreFocus();A5.editor.resize();}function g(A5,A4){var A7=this,A6,Y,A2,A1,A3;A2=f[A5].well;if(f[A5].isRTE&&!A7._isRTEActive()){A2="div.rich-text-switch-pane";}A7._closeWellGuts();A1=A7.baseNode.one(A2);B(A1);if(A1.hasClass("attachments-pane")){A7.attView.attachPaneHidden=false;}A6=A7.cdo._getAttachmentsCount();if(A6!=0){A7.baseNode.one("div.attachments-well").removeClass(AU);}else{A7.baseNode.one("div.attachments-well").addClass(AU);}A7.baseNode.one(f[A5].tab).get("parentNode").get("parentNode").addClass("active");A3=A7.baseNode.one("div.rte li.active a");A3.set("aria-selected",true);A1.set("aria-labelledby",A3.generateID());A7._switchWellCB(A5,A4);if(A4){J.set(Ag,A5);}if(A7.attView){A5!="atch"?A7.attView.reposAttachObj(Au):A7.attView.reposAttachObj(AW);}}function M(Y){var A1=this;if(Y){Y.preventDefault();}A1._closeWellGuts();A1.attView&&A1.attView.reposAttachObj(Au);J.set(Ag,"none");A1._restoreFocus();A1.editor.resize();}function Ac(){var A2=this,Y,A1;Y=A2.baseNode.all("div.gwell");Y.each(r);A2.attView.attachPaneHidden=true;A2.baseNode.one("div.rich-text-switch-pane").addClass(AU);if((A1=A2.baseNode.one("div.rte li.active"))){A1.removeClass("active");A1.one("a").removeAttribute("aria-selected");}}function L(Y){var A1=this;A1._toggleRTEWell(Y,".rte .emoticons",".emoticons-pane");A1._toggleRTEWell(Y,".rte .rich-text",".format-pane");}function P(A2,A4,A5){var A7=this,A3,A1,A6,Y;if(A7.baseNode.one(A4).get("parentNode").get("parentNode").hasClass("active")){A3=A7.baseNode.one(A5);A1=A7.baseNode.one(".rich-text-switch-pane");A6=A2?A1:A3;Y=A2?A3:A1;A6.addClass(AU);Y.removeClass(AU);A7.editor.resize();}}function K(A1,Y){var A2=this;if(A1=="fmt"){A2._initializeSpellCheck();}else{if(A1=="atch"){A2.fire("darlaEvent",{action:"attch_upload_av_display"});}}}function D(){}function AT(A3){var A4=this,Y=A4.getRTEDocNode(),A2=A4.getRTEInstance(),A1;A1=A3?A4.editor.getContentOnSave():A4.editor.getContent();if(A4._isSpellCheckActive()){AR.mail.Controller.SpellCheck.removeAllMarkers(Y,null);}return S.assembleSendBody(Y,A4.editor.richFontInfo,A1);}function z(){var Y=this;if(Y._isSpellCheckActive()){return;}if(Y.spellCheckView==null){if(strings.str_tog_spellcheckEnabled){Y.spellCheckView=new AR.mail.ui.SpellCheckView(Y,Y.cdo);Y.spellCheckView.bindCDO();}else{Y.spellCheckView=0;Y.formatButtons.each(function(A1){var A2=A1.get("id");if(A2=="spellCheck"||A2=="btn-spell-langs"){A1.addClass(AU);}});}}}function y(){var Y=this;AR.use("mail-ui-composeview-spellcheck",function(){Y._activateSpellCheck();if(Y._isSpellCheckActive()){Y.spellCheckView.doSpellCheck();Y.setFocus("body");Y.fire("darlaEvent",{action:"spell_chk"});}});}function AF(Y){var A1=this;AR.use("mail-ui-composeview-spellcheck",function(){A1._activateSpellCheck();if(A1._isSpellCheckActive()){A1.spellCheckView.showLangMenu(Y);}});}function AD(){return this.editor.getRTE().getInstance();}function Al(){return this.getRTEInstance().one("doc");}function Ad(){this.editor.resize();}function H(){var A3=this,A2,Y,A1;if(NeoConfig.fullPage){if(A3.baseNode==null){return;}A2=A3.baseNode.one("table");if(A2==null){return;}A1=parseInt(A2.one(".compose-header").getStyle("height"));Y=AR.one("body").get("winHeight")+A1;if(Y<Ae){Y=Ae;}A2.setStyle("height",Y+"px");if(AR.UA.ie){A3.baseNode.setStyle("height",Y+"px");}}if(AR.UA.ie){A3.editor.resize(true);}}function q(A5){var A6=this,A1,Y,A2,A3=j.length;if(!0){A1=A5.commands;A6.formatButtons.removeClass("pressed");A6.formatButtons.each(function(A9){var A8=A9.getAttribute("data-action"),A7=A9.hasClass("btnpress");if(A8&&A1[A8]&&A7){A9.addClass("pressed");}});A6.fontFamilyOptions.each(function(A7){var A8=A7.get("value").toLowerCase();if(A8.indexOf(","!==-1)){A8=(A8.split(","))[0];}if(A8===A5.fontFamily){A7.set("selected",true);}});if(A5.fontSize.indexOf("pt")!==-1){Y=A5.fontSize.replace("pt","");for(var A4=0;A4<A3;A4++){if(A6.fontSizeOptions.item(A4).get("text")===Y){A6.fontSizeOptions.item(A4).set("selected",true);}}}else{Y=parseInt(A5.fontSize.replace("px",""));
if(!isNaN(Y)){A6.fontSizeOptions.item(A6._fontSizeMatch(Y)).set("selected",true);}else{if(AR.UA.webkit){Y=A6._fontSizeMatchWebkit(A5.fontSize);if(!isNaN(Y)){A6.fontSizeOptions.item(Y-1).set("selected",true);}}}}if(A5.fontColor){if(!A6._formatPane){A6._formatPane=A6.baseNode.one(".format-pane");}A2=A6._formatPane.one("#btn-forecolor i");A2.setStyle("backgroundColor",A5.fontColor);}}}function x(A4){var A5=10000,A2,A1=A4,A3,Y=j.length;if(A1>7){for(A3=0;A3<Y;A3++){A2=Math.abs(A4-j[A3]);if(A2<A5){A5=A2;A1=A3;}}}else{if(A1){A1--;}}return A1;}function AE(Y){var A1=Y=="-webkit-xxx-large"?7:Y=="xx-large"?6:Y=="x-large"?5:Y=="large"?4:Y=="medium"?3:Y=="small"?2:Y=="x-small"?1:Y;return A1;}function AK(A2,A1,Y){var A3=U(A2);AR.one("body").appendChild(A3);AR.use("comms-ui-menu-base",function(A4){A1.plug(A4.Plugin.Menu,{"menu":A3});A1.menu.show();A3.delegate("mousedown",function(A9){A9.halt();var A8=A9.target,A7=A9.currentTarget,A5=A8.ancestor(function(BB){return BB.getAttribute("data-action")||BB===A7;},true),A6=A5?A5.getAttribute("data-action"):0,BA=A5.getAttribute("data-value")||"";A3.fire("menuSelected",{dataAction:A6,dataValue:BA,item:A5});A1.menu&&A1.menu.hide();},"li");Y(A3);});return A3;}function N(Y){var A3=this,A2,A1=AR.mail.model.DataStore.Messages.getPermMidPart;if(Y&&Y.oMsg&&A3.draftMID){return A1(A3.draftMID)==A1(Y.oMsg.mid);}if(!A3._isOrigin()){if(!Y||!Y.oMsg){return true;}}if(Y&&Y.oMsg){A2=A3.cdo.get("origin");return(Y.action===A2.action&&Y.fid===A2.fid&&Y.oMsg.mid===A2.oMsg.mid&&Y.forwardAsAttachment===A2.forwardAsAttachment);}return false;}function Ak(){var A1=this,Y;Y=A1.cdo.get("origin");return(Y.action&&Y.fid&&Y.oMsg);}function AX(){var A1=this,Y;Y=A1.cdo.get("origin");A1._clearOriginTimers();A1._writeLoadingHtml(Y.errInfo=="ok"?"pop":"slow");}function AA(){var Y=this;Y._writeLoadingHtml("start");}function u(A1,Y){this.editor.setContent(A1,Y);}function Az(A1){var Y=this;if(Y.loadingArea.hasChildNodes()){Y.loadingArea.get("children").remove().destroy(true);}Y.loadingArea.appendChild(U(W(Ax.base,null,Y.loadFormatters,A1,strings,As)));}function Ab(){var Y=this;Y.slowOriginReqTimer&&clearTimeout(Y.slowOriginReqTimer);Y.loadingTimer&&clearTimeout(Y.loadingTimer);}function AJ(Y){var A3=this,A2,A1;if(A3.allowSend){AR.use("common-ui-dialog-helper",function(A4){A3.allowSend=false;A2={hd:Y?strings.str_rte_attachments_alert_virus_title:strings.str_comp_dialogtitle_invalidSendAttachments,bd:Y?strings.str_rte_attachments_alert_virus:strings.str_comp_dialogbody_invalidSendAttachments,suppressRestoreFocus:true};A1=function(){A3.allowSend=true;A3._restoreFocus();};A4.common.ui.DialogHelper.alert(A2,{ok:{handler:A1},cancel:{handler:A1}});});}else{A3._restoreFocus();}}function v(A2,A1,Y){AY.push({params:AR.clone(A2),appInstance:A1,handler:Y});AR.fire("om:compose_add_btn",A1);}function Z(Y){AR.each(AY,function(A1,A2){if(A1.appInstance===Y){AY.splice(A2,1);}});AR.fire("om:compose_remove_btns",Y);}AR.extend(AQ,AR.mail.ui.MailCompose);AR.mix(AQ.prototype,{NAME:"FullCompose",render:AM,bindUI:C,_bindWellUI:At,onKeyDown:l,onFocus:s,handleActiveChanged:AI,handleToolbarSelection:F,handleCloseChange:Ap,updateToolbar:n,getContent:A,getRTE:AH,getRTEInstance:AD,getRTEDocNode:Al,getFirstNode:Q,setFocus:Ai,contentChangeAfter:AN,replyheaderChangeAfter:Aw,replyContentChangeAfter:w,postRender:Ah,matchOrigin:N,setContent:u,_bindCDO:AO,_initOpenMailButtons:Af,_addFocusListeners:An,_intlBindUIRTE:D,_allowEditing:AZ,_invokeDataAction:c,_invokeRTECommand:AG,_invokeAction:Aq,_isRTEActive:Av,_updateRTToolbar:q,_adjustLowRes:o,_resizeComposePage:H,_resizeRTE:Ad,assembleSendBody:AT,_invokeSend:O,_closeAfterWarning:X,_handleSendAction:b,_closeWell:M,_closeWellGuts:Ac,_switchWell:d,_switchWellGuts:g,_switchWellCB:K,_toggleRTEWellMode:L,_toggleRTEWell:P,_switchEditMode:G,_cmdTextSwitch:Am,_showMenus:AL,_showRTEMenu:AK,_alertInvalidAttachments:AJ,_initializeSpellCheck:AC,_activateSpellCheck:z,_isSpellCheckActive:Ay,_doSpellCheck:y,_openSpellCheckMenu:AF,_isOrigin:Ak,_handleSlowOriginRequest:AX,_displayLoading:AA,_writeLoadingHtml:Az,_clearOriginTimers:Ab,_setComposePreference:p,_fontSizeMatch:x,_fontSizeMatchWebkit:AE,ondestroy:function(){AQ.superclass.ondestroy.call(this,arguments);}},true);AR.namespace("mail");AR.mail.ComposeView=AQ;AR.mix(AR.mail.ComposeView,{addButton:v,removeButtons:Z},true);if(NeoConfig.isCorpmail){AR.use("ac-corp-widget");}if(NeoConfig.intl==="jp"){AR.use("mail-ui-composeview-base-jp",function(A1){A1.extend(A1.mail.ComposeViewJp,AQ);A1.mail.ComposeView=A1.mail.ComposeViewJp;});}},"1.0.0",{requires:["mail-ui-mailcompose","mail-ui-rteview","mail-ui-messagepane-utils","forms_css","rte_css","attachments_css","mod-stationery_css","mod-compose_css","mail-ui-composeview-attach","editor-base","editor-para","editor-br","node","stylesheet","mail-controller-compose-text","mail-model-compose","contacts-api-utils","contacts-api","filter-contacts","plugin","comms-bidi-textentry","comms-editor-autobidi","comms-intl-bidi","editor-bidi","_shared_module_compose","_shared_module_toolbar_compose","_shared_module_compose_loading","_shared_module_offscreen_bin_compose","_shared_module_offscreen_bin_compose_menu_spellcheck","_shared_module_offscreen_bin_compose_modal_cancel_compose","_shared_module_rte_well_content_format","_shared_module_rte_well_content_emoticons","_shared_module_rte_well_content_attachments","_shared_module_rte_well_tabs_compose","common-ui-toolbar-base","_shared_module_offscreen_bin_compose_menu_list","_shared_module_offscreen_bin_compose_menu_text_align"]});