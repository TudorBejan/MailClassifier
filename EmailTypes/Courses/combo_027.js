YUI.add("mail-ui-messagepane-warnings",function(D){D.namespace("mail.ui");var A=D.common.Utils.substitute,C=strings;function B(G){if(confirm(A([C["str_warning_msg_read_form_part1"],C["str_warning_msg_read_form_part2"]].join("  "),C))){G.submit();}return false;}function F(G){if(strings.str_cfg_tog_exlink_alert_page){window.open(strings.str_cfg_url_exlink_alert_page+encodeURIComponent(G),"new");return false;}if(confirm(A([C["str_warning_msg_read_link_part1"],C["str_warning_msg_read_link_part2"],C["str_warning_msg_read_link_part3"]].join("  "),C))){window.open(G.href);}return false;}function E(G){if(!G.warningShown){alert(A([C["str_warning_msg_read_password_part1"],C["str_warning_msg_read_password_part2"]].join("  "),C));G.warningShown=1;}}D.mail.ui.Warnings={showFormWarning:B,showLinkWarning:F,showPasswordWarning:E};},"1.0.0",{requires:["common-utils"]});YUI.add("mail-ui-mailpane-read",function(B){B.namespace("mail.ui");var J=B.mail,E=J.ui,F=B.common;var D=function(K){var L=this;};function H(Q,L,O){var R=this,M,P;O=O||R.message;P={fid:R.fid,mid:O.mid,pid:Q};M=O.nonImgAttachments;for(var K=0;K<M.length;K++){var N=M[K];if((N.type=="message"||N.type=="text")&&N.partId==Q){P.filename=N.filename;}}if(typeof L!="undefined"&&L!==""&&L!="null"){P.tnefid=L;}C([P]);}function G(T,L,V){var R=this,P,Q=[],K,O;V=V||R.message;K={image:V.imgAttachments,"non-image":V.nonImgAttachments,all:V.attachments};O=K[T]||[];for(var U=0;U<O.length;U++){var N=O[U],M={fid:R.fid,mid:V.mid,pid:N.partId},S=N.tnefId;if(N.type=="message"||N.type=="text"){M.filename=N.filename;}if(typeof S!="undefined"){M.tnefid=S;}Q.push(M);}if(L&&L.target){if(L.target.get("nodeName")=="A"){P={restoreFocusNode:L.target};}else{P={restoreFocusNode:L.target.ancestor("A")};}}if(Q.length){C(Q,P);}}function C(L,K){B.use("mail-common-downloader-v"+(NeoConfig.downloaderVersion||"1"),function(){J.common.downloader.render(L,K);});}function A(){B.fire("openOptions",B.mix(this,{params:{section:"spam"}}));}function I(K,O,N){var P=this,M,L,N=N||P.fid,O=O||P.message;if(O&&!P.loading_slow&&!P.loading_error&&!P.loading_moved&&!O.flags.isRead){M=B.mail.persist.MetaData.get("cg.pref.general.markasreadinterval");if(M!="999"){M=M?parseInt(M)*1000:750;if(isNaN(M)){M=750;}L=M==0;B.use("mail-controller-messages-ops",function(){var Q=function(){var R=J.Controller.batch();R.Messages.flag({fid:N,mid:O,setFlags:{"read":1},enableRetry:true},{suppressCodes:["*"]});return R;};if(!L){P.tmFireRead=setTimeout(function(){var R=Q&&Q();R&&R.execute();},M);}K&&K(L?Q:null);});return true;}}return false;}B.mix(D.prototype,{bindPaneContent:function(){},onSuccess:function(M,K,L){},setFullFormatters:function(){},postRender:function(){},downloadAttachment:H,downloadAllAttachments:G,loadOptions:A,markAsRead:I});B.mail.ui.MailPaneRead=D;},"1.0.0",{requires:["mail-ui-common-string-utils","common-utils","common-utils-stats"]});YUI.add("mail-ui-common-fonts",function(E){var A=E.mail.persist.MetaData,C="neo.pref.general.plaintextcomposefont",B="cg.pref.general.plaintextcomposefont",F={"1":"str_mailopt_fontvalue_1","2":"str_mailopt_fontvalue_2","3":"str_mailopt_fontvalue_3","4":"str_mailopt_fontvalue_4","5":"str_mailopt_fontvalue_5","6":"str_mailopt_fontvalue_6","7":"str_mailopt_fontvalue_7","8":"str_mailopt_fontvalue_8","9":"str_mailopt_fontvalue_9"};function D(){return A.get(B);}E.namespace("mail.ui.common").Fonts={getPlainTextOption:function(){var I=D(),H,G;if(I){H=Math.floor(I/100);G=[strings[F[H]],(I%100),"pt"];}return G;}};},"1.0.0",{requires:["mail-persist-meta-data"]});YUI.add("mail-ui-messagepane-read",function(E){theMainWindow=E.mail.ui.Warnings;E.namespace("mail.ui");var A=E.Lang.trim,t=window.NeoConfig,C=E.mail.ui._MessagePane,N=C.prototype,m=E.common.Utils,y=m.onDemand,x=m.substitute,f=m.escapeHtml,k=m.rocketstats,i=m.unescapeHtml,T=E.ui.Templates,z=E.mail,K=z.ui.MessagePaneUtils,S=z&&z.Controller?z.Controller.Messages:{},J=z.model.DataStore.Messages.getPermMidPart,AA=K.isKnownEmailAddress,n=strings.str_cfg_tog_show_contact_name&&E.contacts&&E.contacts.utils,l=".message-header",r=".msg-body.inner",F=".msg-truncated",Z=E.mail.persist.MetaData,L=E.common.persist.UserData,M="mail-ui-messagepane-bind",R={},V=0,Q=-1,j=-1,G=(NeoConfig.isFresh)?3:5;var B=function(Y){var AB=this;Y=Y||{};B.superclass.constructor.call(AB,Y);};function q(AD,AB){var Y,AC;if(AB){Y=A(AB.name)?A(AB.name):AB.email;AC=n?E.contacts.utils.getShownContactName(AB):Y;}return AC?f(i(AC)):"";}function D(AB,Y){if(NeoConfig.bidi&&Y&&Y.nameDir){return Y.nameDir;}return"";}function a(AC,AB){var Y="";if(AB&&AB.name!==AB.email){Y=f(i(A(AB.name)));}return Y;}function O(AB,Y){if(Y&&Y.email){return f(i(Y.email));}return"";}function w(){var AF=this,AC=function(AH){var AL=AH.s||"",AJ=AH.o||0,AG=AH.f||AF.readFormatters,AK=AH.a||0,AI=AH.strs||strings;return x(AL,AJ,AG,AK,AI);},Y=0,AD=t.isFresh?T._shared_module_message_display_fresh_rollup:T._shared_module_message_display_rollup;AF.showDetails=Z.get("neo.pref.showHeaderDetails");function AE(AH,AL,AK,AI,AM){var AJ=[],AG=AI?Math.min(AI,AH.length):AH.length;for(Y=0;Y<AG;Y++){AJ.push(AC({s:AL,o:AM&&AM(AH[Y]),f:AK,a:AH[Y]}));}Y=AH.length;return AJ.join("");}function AB(AG){return strings.str_tog_filename_center_truncate&&E.mail.ui.truncateJp?E.mail.ui.truncateJp.truncateFileName(AG):(AG.filename?f(i(AG.filename)):"");}this.readFormatters={message_selection:function(){return AF.numSelected>0&&!AF.message?AC({s:AD.message_selection}):"";},message_selection_else:function(){return AF.numSelected==1&&AF.message?AC({s:AD.message_selection_else}):"";},multiple_selected_msgs:function(){return AF.numSelected>1?AC({s:AF.isChat()?AD.page_conversation_history:AD.page_conversation_history_else,o:{num_selected_msgs:AF.numSelected}}):"";},multiple_selected_msgs_else:function(){return AF.numSelected==1?AC({s:AF.isChat()?AD.page_conversation_history1:AD.page_conversation_history_else1}):"";},folder_message1:function(AI){var AH=AI||AF.message,AJ=AH&&AH.header,AG;return(AJ&&(AJ.subject||(AJ.to&&AJ.to[0])||AJ.from.name))?AC({s:AD.folder_message1,o:AH}):"";},expanded:function(){return AF.showDetails?AD.expanded:"";},collapsed_header:function(){return AF.showDetails?"":"collapsed-header";},show_details:function(){return AC({s:(AF.showDetails?AD.show_details_else:AD.show_details)});},show_details1:function(){return AC({s:(AF.showDetails?AD.show_details_else1:AD.show_details1)});},subanchor:function(){return AF.showDetails?"":AD.subanchor;},details:function(){return AF.showDetails?AD.details:"";},btnpos:function(){return AF.showDetails?"":AD.btnpos;},hidden4:function(){return AF.showDetails?"":AD.hidden4;},hidden5:function(AH){var AG=AH||AF.message,AI=(AG&&AG.header&&AG.header.cc)||[];return((AI.length>0))?"":AD.hidden5;},hidden6:function(AH){var AG=AH||AF.message,AJ=(AG&&AG.header&&AG.header.to)||[],AI=(AG&&AG.header&&AG.header.cc)||[];return(AJ.length>0)?"":AD.hidden6;},hidden7:function(){return AF.showDetails?AD.hidden7:"";},hidden8:function(AI){var AG=AI||AF.message,AK=(AG&&AG.header&&AG.header.to)||[],AJ=(AG&&AG.header&&AG.header.cc)||[],AH=u(AK);return((AH>0)&&(AK.length>=1))?"":AD.hidden8;},hidden9:function(AI){var AG=AI||AF.message,AJ=(AG&&AG.header&&AG.header.to)||[],AH=u(AJ);return((AH==0))?"":AD.hidden9;},hidden10:function(AI){var AG=AI||AF.message,AJ=(AG&&AG.header&&AG.header.cc)||[],AH=P(AJ);return((!AH)&&(AJ.length>0))?"":AD.hidden10;},hidden11:function(AI){var AG=AI||AF.message,AJ=(AG&&AG.header&&AG.header.cc)||[],AH=P(AJ);return((AH)&&(AJ.length>0))?"":AD.hidden11;},hidden12:function(AI){var AH=AI||AF.message,AG=(AH&&AH.header&&AH.header.bcc)||[];return((AG.length>0))?"":AD.hidden12;},hidden13:function(AJ){var AI=AJ||AF.message,AH=(AI&&AI.header&&AI.header.bcc)||[],AG=c(AH);return((!AG)&&(AH.length>0))?"":AD.hidden13;},hidden14:function(AJ){var AI=AJ||AF.message,AH=(AI&&AI.header&&AI.header.bcc)||[],AG=c(AH);return((AG)&&(AH.length>0))?"":AD.hidden14;},headerto:function(AI){var AG=AI||AF.message,AK=(AG&&AG.header&&AG.header.to)||[],AJ=(AG&&AG.header&&AG.header.cc)||[],AH=u(AK);return(((AH>0)&&((AK.length-AH)>0))||((AH>0)&&(AJ.length>0))||(AH==0))?strings.str_small_header_to:"";},ccMore:function(AI){var AG=AI||AF.message,AJ=(AG&&AG.header&&AG.header.cc)||[],AH=P(AJ);return((AH>0)&&((AJ.length-AH)==0))?"":strings.str_small_header_more;},ccPlus:function(AI){var AG=AI||AF.message,AJ=(AG&&AG.header&&AG.header.cc)||[],AH=P(AJ);return((AH>0)&&((AJ.length-AH)>0))?"+":"";},bccPlus:function(AJ){var AI=AJ||AF.message,AH=(AI&&AI.header&&AI.header.bcc)||[],AG=c(AH);return((AG>0)&&((AH.length-AG)>0))?"+":"";},toPlus:function(AI){var AG=AI||AF.message,AJ=(AG&&AG.header&&AG.header.to)||[],AH=u(AJ);return((AH>0)&&((AJ.length-AH)>0))?"+":"";},toccPlus:function(AH){var AG=AH||AF.message,AK=(AG&&AG.header&&AG.header.to)||[],AJ=(AG&&AG.header&&AG.header.cc)||[],AI=u(AK)+P(AJ);return((AI>0)&&((AK.length+AJ.length-AI)>0))?"+":"";},toYou:function(AI){var AG=AI||AF.message,AK=(AG&&AG.header&&AG.header.to)||[],AJ=(AG&&AG.header&&AG.header.cc)||[],AH=u(AK);return(((AH>0)&&((AK.length-AH)>0))||((AH>0)&&(AJ.length>0)))?strings.str_small_header_you:"";},toccYou:function(AH){var AG=AH||AF.message,AK=(AG&&AG.header&&AG.header.to)||[],AJ=(AG&&AG.header&&AG.header.cc)||[],AI=u(AK)+P(AJ);return(AI>0)?strings.str_small_header_you_accusative:"";},toMore:function(AI){var AG=AI||AF.message,AJ=(AG&&AG.header&&AG.header.to)||[],AH=u(AJ);return((AH>0)&&((AJ.length-AH)==0))?"":strings.str_small_header_more;},toccMore:function(AI){var AH=AI||AF.message,AL=(AH&&AH.header&&AH.header.to)||[],AK=(AH&&AH.header&&AH.header.cc)||[],AJ=u(AL)+P(AK),AG=AL.length+AK.length;
if((AJ>0)&&(AG-AJ>0)){return strings.str_small_header_more;}else{if(AJ==0){if(AG==1){return strings.str_small_header_recipient;}else{return strings.str_small_header_recipients;}}}return"";},toCount:function(AI){var AG=AI||AF.message,AJ=(AG&&AG.header&&AG.header.to)||[],AH=u(AJ);return((AJ.length-AH)>0)?(AJ.length-AH):"";},toccCount:function(AI){var AG=AI||AF.message,AK=(AG&&AG.header&&AG.header.to)||[],AJ=(AG&&AG.header&&AG.header.cc)||[],AH=u(AK);return((AK.length+AJ.length-AH)>0)?(AK.length+AJ.length-AH):"";},tomCount:function(AH){var AG=AH||AF.message,AI=(AG&&AG.header&&AG.header.to)||[];return(AI.length>0)?(AI.length):"";},ccCount:function(AI){var AG=AI||AF.message,AJ=(AG&&AG.header&&AG.header.cc)||[],AH=P(AJ);return((AJ.length-AH)>0)?(AJ.length-AH):"";},ccmCount:function(AH){var AG=AH||AF.message,AI=(AG&&AG.header&&AG.header.cc)||[];return(AI.length>0)?(AI.length):"";},bccmCount:function(AI){var AH=AI||AF.message,AG=(AH&&AH.header&&AH.header.bcc)||[];return(AG.length>0)?(AG.length):"";},recip_string:function(AI){var AG=AI||AF.message,AJ=(AG&&AG.header&&AG.header.to)||[],AH=u(AJ);return((AH==0)&&(AJ.length==1))?strings.str_small_header_recipient:strings.str_small_header_recipients;},cc_recip_string:function(AI){var AG=AI||AF.message,AJ=(AG&&AG.header&&AG.header.cc)||[],AH=P(AJ);return((AH==0)&&(AJ.length==1))?strings.str_small_header_recipient:strings.str_small_header_recipients;},mail_search_enabled:function(AH){var AG=AH||AF.message;if((strings.str_cfg_tog_mailSearchEnabled!==undefined&&strings.str_cfg_tog_mailSearchEnabled===false)||!(AG&&AG.header&&AG.header.subject)){return"";}else{return AC({s:AD.mail_search_enabled});}},mail_search_enabled_else:function(AH){var AG=AH||AF.message;if((strings.str_cfg_tog_mailSearchEnabled!==undefined&&strings.str_cfg_tog_mailSearchEnabled===false)||!(AG&&AG.header&&AG.header.subject)){return AC({s:AD.mail_search_enabled_else});}else{return"";}},mail_search_enabled1:function(AH){var AG=AH||AF.message;if((strings.str_cfg_tog_mailSearchEnabled!==undefined&&strings.str_cfg_tog_mailSearchEnabled===false)||!(AG&&AG.header&&AG.header.subject)){return"";}else{return AC({s:AD.mail_search_enabled1});}},msg_unread:function(){var AH=AF.message,AG=AH&&AH.flags&&AH.flags.isRead;return AG?AC({s:AD.msg_unread}):"";},msg_unread_else:function(){var AH=AF.message,AG=AH&&AH.flags&&AH.flags.isRead;return AG?"":AC({s:AD.msg_unread_else});},msg_read_aria_checked:function(){var AH=AF.message,AG=AH&&AH.flags&&AH.flags.isRead;return AG?"false":"true";},msg_flagged_aria_checked:function(){var AH=AF.message,AG=AH&&AH.flags&&AH.flags.isFlagged;return AG?"true":"false";},msg_flagged1:function(){var AH=AF.message,AG=AH&&AH.flags&&AH.flags.isFlagged;return AG?AC({s:AD.msg_flagged1}):"";},msg_flagged_else:function(){var AH=AF.message,AG=AH&&AH.flags&&AH.flags.isFlagged;return AG?"":AC({s:AD.msg_flagged_else});},msg_subject:function(AH){var AG=AH||AF.message;return(AG&&AG.header&&AG.header.subject)?f(i(AG.header.subject)):strings["str_msg-view_no_subject"];},msg_subjectDir:function(AI){var AH=AI||AF.message,AG="";if(AH&&AH.header&&AH.header.subjectDir){if((AH.header.to.length>1)&&AF.showDetails){AG=" dir='"+AH.header.subjectDir+"' class='rtl-multi-to details'";}else{if(AH.header.to.length>1){AG=" dir='"+AH.header.subjectDir+"' class='rtl-multi-to'";}else{AG=" dir='"+AH.header.subjectDir+"' class='rtl-details'";}}}return AG;},msg_participant:function(AH){var AG=AH||AF.message,AK=AG.header||{},AJ=AK.from||{},AI=(AK.to||[])[0]||{};AI.email=AI.email||L.get("userSendPref.defaultID")||L.get("userSendPref.defaultFromAddress");AI.name=AI.name||L.get("userSendPref.defaultFromName")||AI.email;return AE([AI,AJ],AD.msg_participant,AF.toFormatters,null,AF.toFormatters.genObj);},more_participants:function(AG){return(AG&&AG.header&&AG.header.to&&(AG.header.to.length>1))?AC({s:AD.more_participants,o:AG}):"";},msg_from:function(AK){var AI=AK||AF.message,AH=AI&&AI.header?AI.header.from:null,AG=AH?AH.name:"",AJ;AJ=n&&AH?E.contacts.utils.getShownContactName(AH):AG;return f(i(AJ));},msg_display_name_dir:function(AG){return D(AG,(AG&&AG.header&&AG.header.from));},msg_from_address:function(AH){var AG=AH||AF.message;return(AG&&AG.header)?f(i(AG.header.from.email))||"":"";},is_contact_from:function(AG){return AG&&AG.header&&AG.header.from&&AA(AG.header.from.email)?AC({s:AD.is_contact_from,o:AG}):"";},is_contact_from_else:function(AG){return AG&&AG.header&&AG.header.from&&!AA(AG.header.from.email)?AC({s:AD.is_contact_from_else,o:AG}):"";},message_header_participants:function(AH){var AG=AH||AF.message,AK=AG.header||{},AJ=AK.from,AI=AK.to||[];return AF.isChat(AG)?AC({s:AD.message_header_participants,o:AG,f:AF.readFormatters}):"";},message_header_from:function(AI){var AH=AI||AF.message,AG=!AF.isChat(AH)&&(AH&&AH.header&&AH.header.from);return AG?AC({s:AD.message_header_from,o:AH,f:AF.readFormatters}):"";},message_header_to:function(AI){var AH=AI||AF.message,AG=!AF.isChat(AH)&&(AH&&AH.header&&AH.header.to&&AH.header.to.length);return AG?AC({s:AD.message_header_to,o:AH,f:AF.toFormatters}):"";},message_header_cc:function(AI){var AH=AI||AF.message,AG=(AH&&AH.header&&AH.header.cc&&AH.header.cc.length);return AG?AC({s:AD.message_header_cc,o:AH,f:AF.ccFormatters}):"";},message_header_bcc:function(AI){var AH=AI||AF.message,AG=(AH&&AH.header&&AH.header.bcc&&AH.header.bcc.length);return AG?AC({s:AD.message_header_bcc,o:AH,f:AF.bccFormatters}):"";},message_header_linemod:function(AI){var AH=AI||AF.message,AG=0;if(AH&&AH.header){AG+=AH.header.to&&AH.header.to.length>0?1:0;AG+=AH.header.cc&&AH.header.cc.length>0?1:0;AG+=AH.header.bcc&&AH.header.bcc.length>0?1:0;}if(AG>0&&AG<2){return"twolines";}else{if(AG==3){return"fourlines";}}return"";},msg_body:function(){return AC({s:AD.msg_body,o:AF.message});},msg_body_style:function(AI){var AH=AI||AF.message,AG=AH&&AH.body&&AH.body.isPlainText?E.mail.ui.common.Fonts.getPlainTextOption():0;return AG?("font:"+AG[1]+AG[2]+" "+AG[0]):"";},msg_body_bidi_default_dir:function(AG){if(AG.conversationBody){return"";
}else{return NeoConfig.isRTL?'dir="ltr"':"";}},page_loading:function(){var AG=AF.message;return(!AG.body||AF.loading_slow||AF.loading_error||AF.loading_moved)?AD.page_loading:"";},page_loading1:function(){var AG=AF.message;return(!AG.body||AF.outboundReq||AF.loading_slow||AF.loading_error||AF.loading_moved)?AC({s:AD.page_loading1}):"";},page_loading_else:function(){return(AF.loading_slow||AF.loading_error||AF.loading_moved)?"":AC({s:AD.page_loading_else});},loading_error_else:function(){return !AF.loading_error?AC({s:AD.loading_error_else}):"";},loading_slow_else:function(){return !AF.loading_slow&&!AF.loading_moved?AC({s:AD.loading_slow_else}):"";},loading_slow_msg:function(){return !AF.isChat(AF.message)?AC({s:AD.loading_slow_msg}):"";},loading_slow_conv:function(){return AF.isChat(AF.message)?AC({s:AD.loading_slow_conv}):"";},folder_message:function(AH){var AG=AH||AF.message;return AC({s:AD.folder_message,o:AG});},msg_blocked:function(){var AL=AF.message,AH=AL?AL.imgAttachments||[]:[],AG=AF.inboxservices||[],AK=E.common.persist.UserData.get("userUIPref.imageBlocking")==="b",AI=AH.length&&AF.blockImages==="all",AJ=AL&&(AL.hasBlockedImages||(strings.str_cfg_tog_old_imageblock?AI:((AI&&!S.isCertified(AG))&&!(AK&&AL&&AL.flags&&AL.flags.inAddressBook))));return AJ?AC({s:AD.msg_blocked,o:AL}):"";},message_header_expand:function(AH){var AG=AH||AF.message;return AG.mid?AC({s:AD.message_header_expand,o:AG}):"";},message_header_flag:function(AH){var AG=AH||AF.message;return AG.mid?AC({s:AD.message_header_flag,o:AG}):"";},msg_has_photo_attachment:function(){var AH=AF.message,AG=AH?AH.imgAttachments||[]:[];return AG.length?AC({s:AD.msg_has_photo_attachment,o:AH}):"";},attached_photos:function(){var AL=AF.message,AK,AH=AL?AL.imgAttachments||[]:[],AG=AH.length,AI=[];for(AK=0;AK<AG;AK++){var AJ=AH[AK];if(AF.blockImages=="all"&&!(E.common.persist.UserData.get("userUIPref.imageBlocking")=="b"&&(AL&&AL.flags&&AL.flags.inAddressBook))&&!strings.str_cfg_tog_show_imageblock_thumbnail){AJ.blocked_images="img";}else{AJ.blocked_images_else=AD.blocked_images_else;}if(strings.str_cfg_tog_show_imageblock_thumbnail&&!AJ.thumbnailurl){AJ.thumbnailurl=strings.str_cfg_url_imageblock_thumbnail;}AI.push(AC({s:AD.attached_photos,o:AJ,f:{image:function(){return AJ.thumbnailurl?AC({s:AD.image,o:AJ}):"";},filename:function(){return AB(AJ);}}}));}return AI.join("");},hasattachment:function(){var AH=AF.message,AG=AH?AH.attachments||[]:[];return(AG.length>0)?"hasattachment":"";},msg_has_attachment:function(){var AH=AF.message,AG=AH?AH.nonImgAttachments||[]:[];return !AF.isChat(AH)&&AG.length?AC({s:AD.msg_has_attachment,o:AH}):"";},hide_attachments_else:function(){return AC({s:AD.hide_attachments_else});},attached_files:function(){var AL=AF.message,AK,AH=AL?AL.nonImgAttachments||[]:[],AG=AH.length,AI=[];for(AK=0;AK<AG;AK++){var AJ=AH[AK];AI.push(AC({s:AD.attached_files,o:AJ,f:{image1:function(){return AJ.thumbnailurl?AC({s:AD.image,o:AJ}):"";},type:function(){return E.mail.ui.AttachFileType.getType(AJ.filename);},filename:function(){if(AJ.filename===".eml"){AJ.filename=strings.str_comp_nosubject+".eml";}return AB(AJ);}}}));}return AI.join("");},has_inline_attachments:function(){return(AF.message.body&&AF.message.body.inlineAttachments.length>0)?AC({s:AD.has_inline_attachments}):"";},inline_attachment_text:function(){var AK,AL=AF.message.body.inlineAttachments,AG=AL.length,AH=[],AI={inline_from_data:function(AM){return AJ([AM.header.from]);},inline_to_data:function(AM){return AJ(AM.header.to);},inline_date_data:function(AM){return m.dateFormatter(new Date(AM.header.receivedDate*1000),strings.str_tog_dateformat_header_l10n);},inline_subject_data:function(AM){return f(i(AM.header.subject));},inline_cc_data:function(AM){return AJ(AM.header.cc);},inline_cchdr:function(AM){return(AM.header.cc.length>0)?AC({s:AD.inline_cchdr,o:AM,f:AI}):"";},inlinemsg_text:function(AM){return AM.text||[AM.body.display].join("");}};function AJ(AM){var AP=AM.length,AO=[],AN,AQ;for(AN=0;AN<AP;AN++){AQ=AM[AN];if(AQ.name){AO.push(AQ.name);AO.push(" <");}AQ.email&&AO.push(AQ.email);AQ.name&&AO.push(">");AO.push(", ");}AO.pop();return f(i(AO.join("")));}for(AK=0;AK<AG;AK++){AH.push(AC({s:AD.inline_attachment_text,o:AL[AK].content,f:AI}));}return AH.join("");},msg_has_attachment1:function(AI){var AH=AI||AF.message,AG=AH?AH.attachments||[]:[];return AG.length&&AH.mid&&!AF.isChat()?AC({s:AD.msg_has_attachment1}):AG.length&&!AF.isChat()?AC({s:AD.msg_has_attachment1,o:AH}):"";},hide_attachments_else1:function(AH){var AG=AH||AF.message;return AG.mid?AC({s:AD.hide_attachments_else1}):AC({s:AD.hide_attachments_else1,o:AG});},msg_num_attachments:function(AH){var AG=AH||AF.message;return AG.attachments.length;},single_attachment_string:function(AH){var AG=AH||AF.message;return(AG.attachments.length==1)?AC({s:AD.single_attachment_string}):"";},single_attachment_string_else:function(AH){var AG=AH||AF.message;return(AG.attachments.length==1)?"":AC({s:AD.single_attachment_string_else});},page_conversation_timestamp_data:function(AK){var AJ=AK&&AK.header&&AK.header.receivedDate,AI=/[\s\S]+"etype":"(\w+)"[\s\S]+/,AG=AK&&AK.body&&AK.body.display||"",AH=(AI.exec(AG)||[])[1]||"";if(AH=="INSTANT"){AH="IM";}return AJ?AC({s:AD.page_conversation_timestamp_data,o:{type:strings["str_conv_"+AH.toLowerCase()]||strings.str_conv_im,timestamp:m.dateFormatter(new Date(AJ*1000),strings.str_tog_dateformat_conversation)},f:AF.readFormatters}):"";},page_message_history:function(AG){if(!AG.conversationBody){return AG;}var AU=(AG.header.to||[])[0]||{},AV=AG.header.from||{},AJ=AU.name||E.common.persist.UserData.get("userSendPref.defaultFromName")||AU.email,AQ=(AV.email=="mailbot@yahoo.com"),AR=AV.name||AV.email||"",AI,AM,AP,AT,AK,AN,AO="",AL=(AG.conversationBody).replace(/^[\s\S]*({"messages"[\s\S]+})/,"$1"),AH={0:"yahoo",2:"msn"};E.later(100,null,function(){AG.fid=AF.fid;NeoConfig.msgrData.message=AG;NeoConfig.msgrData.spam={spammedAs:AU.email,spammerId:AV.email};});try{AK=(E.JSON.parse(AL)).messages||[];
for(AM=0;(AI=AK[AM]);AM++){AP=(AQ?AV.name:AV.email).replace(/[@%].*/,"")!==AI.from.replace(/[@%].*/,"");AN=E.mail.common.YML.toHTML(AI.yml||AI.txt||"",AH[AI.cloud_id||0]);if(!AN){if(AI.call_duration){AN='<span style="color: #bdbdbd; font-weight: bold; font-size: 10px;">';AN+=H(AI.call_duration);AN+="</span>";}else{continue;}}AT=strings.str_tog_dateformat_conversation;AO+=AC({s:AD.page_message_history,o:{self:AP?"self":"",timestamp:m.dateFormatter(new Date(AI.ts*1000),AT),name:AP?f(i(AJ)):f(i(AR)),msg:AN},f:AF.readFormatters});}}catch(AS){return AL;}return AO;},page_conversation_history2:function(){return AF.isChat(AF.message)?AC({s:AD.page_conversation_history2,o:AF.message,f:AF.readFormatters}):"";},page_conversation_history_else2:function(){return !AF.isChat(AF.message)?AC({s:AD.page_conversation_history_else2,o:AF.message,f:AF.readFormatters}):"";},num_selected_msgs:function(){return AF.numSelected;},msg_body_display:function(){return"";},message_header_ycw:function(){return false?AC({s:AD.message_header_ycw,o:AF.message}):"";},msg_flagged:function(){var AH=AF.message,AG=AH&&AH.flags&&AH.flags.isFlagged;return AG?AC({s:AD.msg_flagged}):"";},received_date:function(AH){var AG=AH||AF.message;if(NeoConfig.isFresh){return AG&&AG.header&&AG.header.receivedDate?m.dateFormatter(new Date(AG.header.receivedDate*1000),strings.str_tog_dateformat_header_long_l10n):"";}return AG&&AG.header&&AG.header.receivedDate?m.dateFormatter(new Date(AG.header.receivedDate*1000),strings.str_tog_dateformat_header_l10n):"";},short_received_date:function(AI){var AH=AI||AF.message,AG=AH.header.receivedDate*1000;return AH&&AH.header&&AH.header.receivedDate?m.dateFormatter(new Date(AG),Neo.getDateFormat(AG)):"";},msg_truncated:function(){var AG=AF.message;return AG.body&&AG.isTruncated&&!AF.disableTruncate?AC({s:AD.msg_truncated}):"";}};AF.toFormatters={msg_to:function(AJ,AH){var AI=AJ||AF.message,AK=(AI&&AI.header&&AI.header.to)||[],AG=AH?null:3;return AE(AK,AD.msg_to,AF.toFormatters,AG,AF.toFormatters.genObj);},more_to:function(){return Y>3?AC({s:AD.more_to,o:{has_more_to:Y-3}}):"";},genObj:function(AH){var AG=AH&&AA(AH.email),AI={msg_data_name:a(null,AH),msg_to_address:O(null,AH),msg_display_name_dir:D(null,AH),msg_display_name:q(null,AH),msg_participant_address:O(null,AH),is_contact_to:AG?AD.is_contact_to:""};AI.is_contact_to_else=(AG?"":AC({s:AD.is_contact_to_else,o:AI,f:AF.toFormatters,a:AH}));if(A(AI.msg_data_name)==""){AI.msg_data_name=AI.msg_display_name;}return AI;},is_contact_chat:function(AG,AP){var AN=AP&&AP.email,AM=AN&&AA(AP.email),AO,AL,AK,AJ,AH,AI;if(AM){return AD.is_contact_chat;}else{AO=E.contacts.utils.getContacts();for(AL in AO){AL=AO.hasOwnProperty(AL)&&AO[AL]||{};AK=AL.fields||[];for(AJ=0,AH=AK.length;AJ<AH;AJ++){AI=AK[AJ];if(AI.type==="yahooid"||AI.type==="otherid"){if(AI.value.indexOf("@")<0){AI.value=AI.value+AP.email.replace(/.+(@.+)/,"$1");}if(AI.value===AP.email){return AD.is_contact_chat;}}}}}return"";},is_contact_chat_else:function(AG,AP){var AN=AP&&AP.email,AM=AN&&AA(AP.email),AO,AL,AK,AJ,AH,AI;if(AM){return"";}else{AO=E.contacts.utils.getContacts();for(AL in AO){AL=AO.hasOwnProperty(AL)&&AO[AL]||{};AK=AL.fields||[];for(AJ=0,AH=AK.length;AJ<AH;AJ++){AI=AK[AJ];if(AI.type==="yahooid"||AI.type==="otherid"){if(AI.value.indexOf("@")<0){AI.value=AI.value+AP.email.replace(/.+(@.+)/,"$1");}if(AI.value===AP.email){return"";}}}}}return AC({s:AD.is_contact_chat_else,f:AF.toFormatters,o:AG,a:AP});}};AF.ccFormatters={msg_cc:function(AJ,AH){var AI=AJ||AF.message,AK=(AI&&AI.header&&AI.header.cc)||[],AG=AH?null:G;return AE(AK,AD.msg_cc,AF.ccFormatters,AG,AF.ccFormatters.genObj);},more_cc:function(){return Y>G?AC({s:AD.more_cc,o:{has_more_cc:Y-G}}):"";},genObj:function(AH){var AG=AH&&AA(AH.email),AI={msg_data_name:a(null,AH),msg_cc_address:O(null,AH),msg_display_name_dir:D(null,AH),msg_display_name:q(null,AH),msg_to_address:O(null,AH),msg_participant_address:O(null,AH),is_contact_cc:AG?AD.is_contact_cc:""};if(A(AI.msg_data_name)==""){AI.msg_data_name=AI.msg_display_name;}AI.is_contact_cc_else=(AG?"":AC({s:AD.is_contact_cc_else,o:AI}));return AI;}};AF.bccFormatters={msg_bcc:function(AK,AI){var AJ=AK||AF.message,AH=(AJ&&AJ.header&&AJ.header.bcc)||[],AG=AI?null:5;return AE(AH,AD.msg_bcc,AF.bccFormatters,AG,AF.bccFormatters.genObj);},more_bcc:function(){return Y>5?AC({s:AD.more_bcc,o:{has_more_bcc:Y-5}}):"";},genObj:function(AH){var AG=AH&&AA(AH.email),AI={msg_data_name:a(null,AH),msg_bcc_address:O(null,AH),msg_display_name_dir:D(null,AH),msg_display_name:q(null,AH),msg_to_address:O(null,AH),msg_participant_address:O(null,AH),is_contact_bcc:AG?AD.is_contact_bcc:""};if(A(AI.msg_data_name)==""){AI.msg_data_name=AI.msg_display_name;}AI.is_contact_bcc_else=(AG?"":AC({s:AD.is_contact_bcc_else,o:AI}));return AI;}};AF.setFull=1;}function h(AB,AK,AD){var AF=this,AH,AC=m.Stopwatch.get("MsgInPreview")||AF.stopwatch,AI=AB&&AB.mid,AE,AJ=AD?"preloadSuccess":"loadMessageSuccess",Y=AF.retryPrefix();Q=-1;j=-1;try{AC&&AC.start(3,"OnSuccess");clearTimeout(AF.loadingTimer);if(AI&&AF.message&&(J(AF.message.mid)==J(AI))){try{if(!AF.changingRequest){V++;if(R[AI]){R[AI]+=1;k.stat("messageread","RereadMessage");if(R[AI]<=26){k.stat("messageread","RereadMessage_"+(R[AI]==26?"MAX":R[AI]));}if(!AK){k.stat("messageread","RereadUncachedMessage");}}else{R[AI]=1;}if(V<=101){k.stat("messageread","MessagesRead_"+(V==101?"MAX":V));}}k.stat("messageread",(AA(AB.header.from.email)?"":"Non")+"Contact");k.stat("messageread",(AB.flags.isRead?"":"Un")+"Read");k.stat("messageread",(AB.attachments&&AB.attachments.length?"Has":"No")+"Attachments");k.stat("messageread","Age",Math.round((new Date())-AB.header.receivedDate*1000)/60000);}catch(AG){k.stat("messageread","SuccessStatError");E.use("common-utils-error",function(){m.error.report("SuccessStatError",AG,1,1,1);});}AF.changingRequest=AF.loading_slow=0;AF.outboundReq=null;AF.request=null;AF.isRetrying=0;clearTimeout(AF.slowLoad);AF.inboxservices=AF.message.inboxservices;AB.header.receivedDate=AF.message.header.receivedDate;
AF.message=AB;AH=S.getQueryParams(AB,"midRequest");AF.blockImages=AH&&AH.blockImages;AF.fireEvent("getSuccess");AF.render();k.stat("messageread",(Y+AJ+(AK?"Cached":"Uncached")));}else{AE=AB?"permMidDifferent":"noRetrievedMsg";AF.loadExtra(function(){this.onFailure({data:AF.message,reason:AE},AD);},1);}AC&&AC.start(3,"PostOnSuccess");}catch(AG){k.stat("messageread","onSuccessError");}}function o(AB,Y){return function(AC){y(AB,M).apply(this,arguments);if(!Y){AC.halt();}};}function X(AD){var AC=AD.target,Y=AC.get("parentNode"),AB=null;if(AC.hasAttribute("ymailto")){AB=AC.getAttribute("ymailto");}else{if(Y.hasAttribute("ymailto")){AB=Y.getAttribute("ymailto");}}if(AB&&AB.length>0){AD.preventDefault();E.use("mail-ui-shortcuts",function(AE){AE.mail.ui.ShortCuts.composeMailToMessage(AB);});}}function U(AB){var AD=this,Y=AB.target,AC=m.getDataAction(AB);if(AC.action=="calevent"){E.use("calendar-ui-addEvent-listener",function(AF){var AE={id:Y.getAttribute("id"),mid:Y.getAttribute("mid"),fid:Y.getAttribute("fid")};AF.calendar.ui.addEvent.listener.fire("addEvent",{data:AE,source:"mail"});});}}function e(){var AC=this,AB,Y=m.Stopwatch.get("MsgInPreview")||AC.stopwatch;Y&&Y.start(3,"BindPaneContent");if(!AC.messageBound){AB=AC.getRoot();if(AB){AC.fireEvent("bindUI");AC._evts.push(AB.delegate("keydown",function(AD){if(AD.keyCode===32){AD.preventDefault();AD.target.simulate("click");}},".flag a"));if(NeoConfig.isFresh){AC._evts.push(AB.delegate("keydown",function(AD){if(AD.keyCode===32){AD.preventDefault();AD.target.simulate("click");}},".unread-dot a"));}AC._evts.push(AB.delegate("keydown",function(AD){if(AD.keyCode===13){AD.target.simulate("click");}},".file-attach li"));AC._evts.push(AB.delegate("keydown",function(AG){var AE=E.UA.os,AD=(AE=="windows"||AE=="win"),AF=AG.target,AH;if(AG.keyCode==9&&(AH=AG.currentTarget.one(".hidefocus"))){if(AF.get("nodeName").toLowerCase()==="a"&&AF.get("parentNode").hasClass("hidefocus")){AG.preventDefault();}AH.removeClass("hidefocus");}if((AD&&AG.shiftKey&&AG.keyCode==121)||(!AD&&AG.ctrlKey&&AG.shiftKey&&AG.altKey&&AG.keyCode==77)){AG.preventDefault();m.simulateContextMenu(AG.target);}},l,AC));AC._evts.push(AB.delegate("contextmenu",o("contextClick"),l,AC));AC._evts.push(AB.delegate("click",o("retryClick"),("#loadingpane a"),AC));AC._evts.push(AB.delegate("click",U,".ycalshortcuts"));AC._evts.push(AB.delegate("click",o("handleClick"),function(AD){var AE=AD.getAttribute("data-action");return AE!=="";},AC));if(strings.str_cfg_tog_exlink_alert_page){AB.delegate("click",function(AF){if(AC.fid=="%40B%40Bulk"&&!AF.target.hasAttribute("ymailto")){var AD=AF.target.getAttribute("href"),AE=new RegExp(strings.str_cfg_regex_yahoo_link,"i");if(!AD.match(AE)){AF.halt();window.open(strings.str_cfg_url_exlink_alert_page+encodeURIComponent(AD),"new");}}},".msg-body a");}AC._evts.push(E.on("msgsview:movetonewfolder",function(){var AD=E.mail.Tabs.getActiveTab();if(AD&&AD.widget&&AD.widget.msgPane&&AD.widget.msgPane==AC){if(AC.message&&AC.message.mid){AC.handleUI({action:"folder-new",tbAction:true},AC.fid,null,AC.message.mid);}}}));AC.messageBound=1;}}Y&&Y.start(3,"PostBindMessage");AB=null;}function g(){var Y;if(!this.messageBodyBound){Y=this.getRoot();Y&&Y.one(r)&&Y.one(r).on("click",function(AD){AD.stopPropagation();var AC=AD.target,AB=AC.get("parentNode");if(AB.get("nodeName")==="A"||AC.get("nodeName")==="A"){X(AD);}if(AC.hasClass("ycalshortcuts")){U(AD);}});this.messageBodyBound=1;}}function p(){E.fire("openOptions",E.mix(this,{params:{section:"spam"}}));E.fire("mt:click",{action:"options"});}function d(AB){var AC=this,Y=AC.get("rootNode");AC.disableTruncate=1;AC.scrollTop=(AB&&AB.scrollTop)||Y.get("scrollTop");AC.href=AB&&AB.href;k.stat("messageread","viewFullMsg");AC.changeRequest({truncateAt:null},1,AB&&AB.cbk);E.fire("mt:click",{action:"show_fullmsg"});}function W(){k.stat("messageread","unblockImages");this.changeRequest({midRequest:{blockImages:"none"}});E.fire("mt:click",{action:"show_images"});}function b(AC,AB,Y){var AE=this,AD=AE.message;if(!AB){AD.body=AD.attachments=AD.imgAttachments=AD.nonImgAttachments=0;}AE.changingRequest=1;AE.loadPaneContent(1,AC,Y);}function I(){var AB=this,Y=AB.loading_slow?20:AB.loading_error;AB.loading_slow=AB.loading_error=AB.loading_moved=0;if(Y>0&&Y<=6){AB.numRetries=AB.numRetries?(AB.numRetries+1):1;if(AB.numRetries>=AB.maxRetries){k.stat("messageread","maxRetry");}}AB.fireEvent("retry");AB.loadPaneContent(Y);AB.set("transferFocus",1);E.fire("mt:click",{action:"retry"});}function s(AB){var AC=this,Y;switch(AB){case"to":Y=AC.toFormatters.msg_to;break;case"cc":Y=AC.ccFormatters.msg_cc;break;case"bcc":Y=AC.bccFormatters.msg_bcc;break;}return Y&&Y(AC.message,true);}function v(){var AE=this,AB=Array.prototype.slice.call(arguments),Y=(!AE.fullPageView&&AE.parentNode.one("div.tripane .content"))||AE.parentNode.one("div.message.content"),AC;if(NeoConfig.backButton&&(typeof window.history.state==="object")&&AE.fullView===true){if(!window.history.state||window.history.state.id!=1){window.history.pushState({id:"1"},document.title,window.location.pathname+window.location.search);}if(!window.location.hash.length){window.history.replaceState({id:"1"},document.title,"#mail");}}K.resizeSubject(Y);function AD(AI){var AJ,AH=AE.neighbors,AF,AG=AI&&AI();if(AE.fid=="%40B%40Bulk"||AE.fid=="Trash"){AH=null;}AF=AH&&AH.length;if(AF){AJ={fid:AE.fid,msg:null,cachekey:"Neighbors",prefetch:AH};if(AE.isChat(AH[0])){AJ.ovparams={displayPref:"text/json",urlDetection:false,emailDetection:false,annotateOption:{annotateText:"none"}};}if(AG){AG.Messages.get(AJ,{suppressCodes:["*"],backgroundLogs:["*"]});}else{S.get(AJ,{suppressCodes:["*"],backgroundLogs:["*"]});}}AG&&AG.execute();}if(!AE.outboundReq&&AE.message&&AE.message.body){if(!AE.markAsRead(AD)){AD();}}else{AD();}if(!NeoConfig.low_bandwidth&&NeoConfig.msg_header_images){E.use("mail-ui-msgpane-profiles",function(){AE.appendProfileImage();});}this.message.fid=AE.fid;AE.neoFire("rendered",AB,AE.message,Y);if(AE.fullView){AC="message_tabpane";
}else{AC="msgread_reading_pane";}E.fire("mt:view",{action:AC});}function u(Y){if(Y.length==0){return 0;}if(Q<0){Q=c(Y);}return Q;}function P(Y){if(Y.length==0){return 0;}if(j<0){j=c(Y);}return j;}function c(AB){var AF,AE,AN=0,AM=0,Y=0,AH=L.get("userSendPref"),AK=L.get("externalAccounts")||{},AI,AC=AK.extAccount||[],AO=AC.length,AL=(AH.defaultID||"").toLowerCase(),AG=(AH.defaultFromAddress||"").toLowerCase(),AD,AJ;for(AF=0;AF<AB.length;AF++){AJ=(AB[AF].email||"").toLowerCase();if((AJ==AL)||(AJ==AG)){AN++;}}if(AN>0){return AN;}for(AF=0;AF<AO;AF++){AI=AC[AF];if(AI){AD=(AI.address||"").toLowerCase();for(AE=0;AE<AB.length;AE++){AJ=(AB[AE].email||"").toLowerCase();if(AJ==AD){AM++;}}}}if(AM>0){return AM;}return Y;}function H(AE){var AB=[strings.str_conv_call_duration],AD=0,Y=0,AC=parseInt(AE,10);if(isNaN(AC)){AC=0;}while(AC>=3600){AD++;AC-=3600;}while(AC>=60){Y++;AC-=60;}if(AD){AB.push(AD,strings.str_conv_time_hours);}if(Y){AB.push(Y,strings.str_conv_time_minutes);}AB.push(AC,strings.str_conv_time_seconds);return AB.join(" ");}E.extend(B,z.ui.MailPaneRead,{setFullFormatters:w,onSuccess:h,bindPaneContent:e,loadOptions:p,retryLoad:I,unblockImages:W,viewFullMsg:d,changeRequest:b,searchRecipients:c,postRender:v,getAllLozenges:s,bindBodyContent:g});E.mix(C.prototype,B.prototype);E.mix(C.prototype,z.ui.MailPaneRead.prototype);},"1.0.0",{requires:["common-persist-user-data","mail-persist-meta-data","mail-ui-messagepane-warnings","mail-ui-mailpane-read","contacts-api","contacts-api-utils","common-utils-stats","mail-ui-messagepane-utils","attachments_css","mod-conversation-history_css","mail-ui-attachment-filetype","mail-ui-common-fonts","common-ui-tabs-base"]});var JSON;if(!JSON){JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());var YUI;if(typeof YUI==="undefined"){(function(){var e=".",b=Object.prototype.hasOwnProperty,d=Object.prototype.toString,c={"undefined":"undefined",number:"number","boolean":"boolean",string:"string","[object Function]":"function","[object RegExp]":"regexp","[object Array]":"array","[object Date]":"date","[object Error]":"error"},f,a=function(j,i){var h=typeof j;return(j&&(h==="object"||(!i&&(h==="function"||f.Lang.isFunction(j)))))||false};f={namespace:function(){var k=arguments,q=this,n=0,m,p,h;for(;n<k.length;n++){h=k[n];if(h.indexOf(e)){p=h.split(e);for(m=(p[0]=="YAHOO")?1:0;m<p.length;m++){q[p[m]]=q[p[m]]||{};q=q[p[m]]}}else{q[h]=q[h]||{}}}return q},add:function(h,i){if(i){i(f)}},use:function(){var h=arguments[arguments.length-1];if(typeof h==="function"){h(f)}},log:function(){},merge:function(){var k=arguments,m=0,j=k.length,h={};for(;m<j;++m){f.mix(h,k[m],true)}return h},Object:{_hasEnumBug:!{valueOf:0}.propertyIsEnumerable("valueOf"),_forceEnum:["hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toString","toLocaleString","valueOf"]},mix:function(h,j,q,k,n,r){var o,u,t,m,v,p,s;if(!h||!j){return h||f}if(n){if(n===2){f.mix(h.prototype,j.prototype,q,k,0,r)}t=n===1||n===3?j.prototype:j;s=n===1||n===4?h.prototype:h;if(!t||!s){return h}}else{t=j;s=h}o=q&&!r;if(k){for(m=0,p=k.length;m<p;++m){v=k[m];if(!b.call(t,v)){continue}u=o?false:b.call(s,v);if(r&&u&&a(s[v],true)&&a(t[v],true)){f.mix(s[v],t[v],q,null,0,r)}else{if(q||!u){s[v]=t[v]}}}}else{for(v in t){if(!b.call(t,v)){continue}u=o?false:b.call(s,v);if(r&&u&&a(s[v],true)&&a(t[v],true)){f.mix(s[v],t[v],q,null,0,r)}else{if(q||!u){s[v]=t[v]}}}if(f.Object._hasEnumBug){f.mix(s,t,q,f.Object._forceEnum,n,r)}}return h},Lang:{isString:function(h){return typeof h==="string"},isFunction:function(h){return f.Lang.type(h)==="function"},type:function(h){return c[typeof h]||c[d.call(h)]||(h?"object":"null")}}};YUI=function(){return f};for(var g in f){if(f.hasOwnProperty(g)){YUI[g]=f[g]}}})()}if(typeof YAHOO==="undefined"||!YAHOO){var YAHOO={util:{}}}if(typeof YAHOO.util==="undefined"||!YAHOO.util){YAHOO.util={}}if(!YAHOO.util.CrossFrame){YAHOO.util.CrossFrame=(function(){var k=/^frames\[(\d+)\]$/,h=/^frames\[['"]([a-zA-Z0-9-_]+)['"]\]$/;var m,e,g,o,i,f,c,b,n,a=YUI;if(window.postMessage||document.postMessage){c=function(p,s,q){var r;if(n(q||"1.0.15","1.0.15")<1){r=[i(s),i(p)].join("|")}else{r=[i(q),i(s),i(p)].join("|")}return r};b=function(r){var q=r.split("|"),p;for(p=q.length-1;p>=0;--p){q[p]=f(q[p])}if(q.length==2){return{sig:q[0],body:q[1]}}else{if(q.length==3){return{version:q[0],sig:q[1],body:q[2]}}else{return null}}};i=function(p){return p.replace(/\|/g,"&c124;")};f=function(p){return p.replace(/&c124;/g,"|")}}else{c=function(p,u,q,s,r){var t;q=q||"1.0.15";if(n(q,"1.0.15")<1){t=[u,p.replace(/\&/g,"&c38;").replace(/\"/g,"&c34;").replace(/\'/g,"&c39;").replace(/\\/g,"&c92;").replace(/\0/g,"&c0;").replace(/\n/g,"&c10;").replace(/\r/g,"&c13;")].join("|")}else{if(n(q,"1.1.9")<0){t=[i(q),i(u),i(p)].join("|")}else{t=[i(q),i(u),i(p),i(s),i(r)].join("|")}}return t};b=function(q){var p=q.split("|");if(p.length===2){return{sig:p[0],body:p[1].replace(/&c13;/g,"\r").replace(/&c10;/g,"\n").replace(/&c0;/g,"\0").replace(/&c92;/g,"\\").replace(/&c39;/g,"'").replace(/&c34;/g,'"').replace(/&c38;/g,"&")}}else{if(p.length===3){return{version:f(p[0]),sig:f(p[1]),body:f(p[2])}}else{if(p.length===5){return{version:f(p[0]),sig:f(p[1]),body:f(p[2]),target:f(p[3]),url:f(p[4])}}else{return null}}}};i=function(p){return escape(p.replace(/\&/g,"&c38;").replace(/\"/g,"&c34;").replace(/\'/g,"&c39;").replace(/\\/g,"&c92;").replace(/\0/g,"&c0;").replace(/\n/g,"&c10;").replace(/\r/g,"&c13;").replace(/\//g,"&c47;").replace(/\@/g,"&c64;").replace(/\+/g,"&c43;"))};f=function(p){return unescape(p).replace(/&c43;/g,"+").replace(/&c64;/g,"@").replace(/&c47;/g,"/").replace(/&c13;/g,"\r").replace(/&c10;/g,"\n").replace(/&c0;/g,"\0").replace(/&c92;/g,"\\").replace(/&c39;/g,"'").replace(/&c34;/g,'"').replace(/&c38;/g,"&")}}n=function(t,r){var s=typeof t==="string",q=typeof r==="string";if(!s||!q){return s&&!q?1:(!s&&q?-1:0)}t=t.split(".");r=r.split(".");if(t.length!==3||r.length!==3){throw new Error("Invalid version format")}var v=0,u=0;for(var p=0;p<3;p++){v=parseInt(t[p],10);u=parseInt(r[p],10);if(v!==u){return(v>u)?1:-1}}return 0};e=function(p,q){if(Object.prototype.hasOwnProperty){return p.hasOwnProperty(q)}return typeof p[q]!=="undefined"&&p.constructor.prototype[q]!==p[q]};g=function(v){var w,t,y,x,u,q;w={};t=v.split("&");for(u=0,q=t.length;u<q;u++){x=t[u].indexOf("=");w[t[u].substr(0,x)]=decodeURIComponent(t[u].substr(x+1))}return w};m=function(v){var s=v.split("."),t,r,q,u;v=window;for(r=0,q=s.length;r<q;r++){u=s[r];if(u==="parent"){v=v.parent}else{if(u==="opener"){v=v.opener}else{if(u==="top"){v=v.top}else{if((t=k.exec(u)||h.exec(u))){v=v.frames[t[1]]}else{throw new Error("Invalid Target: "+v)}}}}}return v};o=function(){var u,t,r,q,p,w=g(window.location.hash.substr(1)),v=b(window.name);if(w.target){t=m("parent."+w.target);q=w.url}else{t=m("parent.opener."+v.target);q=v.url}if(v&&t&&q){r=q.split("/")[2];p=v.version;u=(t.YUI&&t.YUI.util&&t.YUI.util.CrossFrame)?t.YUI.util.CrossFrame:t.YAHOO.util.CrossFrame;try{if(navigator.userAgent.indexOf("Firefox")>-1){t.setTimeout(function(){u._receive([v.sig,v.body].join("|"),r,q,p)},0)}else{u._receive([v.sig,v.body].join("|"),r,q,p)}}catch(s){}}else{throw new Error("Missing required params")}};function d(r,s,q,p){a.util.CrossFrame._receive(r,s,q,p)}var j;j={proxyReceive:o,parseTarget:m,constructMessage:c,deconstructMessage:b,escapeAttr:i,unescapeAttr:f,compareVer:n,_receive:d};return j})();if(typeof YUI!=="undefined"&&YUI){YUI.namespace("util.CrossFrame");YUI.add("omCrossframe",function(a){},"1.0.0",{requires:[]});(function(d){var u="1.1.16",p=YUI.util.CrossFrame;var h="OM_VBS_Wrapper",b="OM_VBS_GetWrapper",s="OM_VBS_HandleMessage",m="OM_VBS_CreateChannel",j,v=window.location.toString(),i,x,n,y;i=YAHOO.util.CrossFrame.parseTarget;x=YAHOO.util.CrossFrame.compareVer;function o(D,C,B,e){if(D&&D.addEventListener){D.addEventListener(C,B,e)}else{if(D&&D.attachEvent){D.attachEvent("on"+C,B)}}}function g(e){if(e.stopImmediatePropagation){e.stopImmediatePropagation()}else{if(e.stopPropagation){e.stopPropagation()}}e.cancelBubble=true}n=function(D){var e=(d.Lang.isString(D))?D.replace(/#$/,""):false,C=document.getElementsByTagName("iframe"),B;for(B=0,l=C.length;B<l;B++){if(C[B].src.replace(/#$/,"")===e||C[B].contentWindow.location===D){return C[B]}}return null};y=function(D){var B=(typeof D==="object")&&(D!==null)&&(typeof D.sig==="string")&&(typeof D.body==="string")&&(D.sig.length>2)&&(D.body.length>0);if(B){try{if(x(D.version||"1.0.15","1.0.15")<1){}else{B=(x(D.version,D.version)===0)}}catch(C){B=false}}return B};var z,q,k,a,t,A,r,f,c;k=YAHOO.util.CrossFrame.constructMessage;a=YAHOO.util.CrossFrame.deconstructMessage;t=YAHOO.util.CrossFrame.escapeAttr;A=YAHOO.util.CrossFrame.unescapeAttr;if(window.postMessage||document.postMessage){r=!window.postMessage;o(window,"message",function(B){var C,D,E,G;B=B||window.event;try{G=a(B.data);if(y(G)){D=B.origin;E=D.split("/")[2];C=n(B.source.location);if(self===top){g(B)}p.fire("receiveMessage",[G.sig,G.body].join("|"),E,D,C,G.version)}else{}}catch(F){d.log("crossframe.js:onMessageListener: error msg["+F.message+"]")}},false);z=function(E){var B,D,C=i(E.target),e=E.version||u;if(!C){return false}if(r){C=C.document}D=k(E.message,E.sig||"",e);C.postMessage(D,E.proxy);E.handler.call(window);return true}}else{if(window.ActiveXObject){j={};window[s]=function(e,H,I,F){var E=arguments.length,D,C,B,G;window.setTimeout(function(){try{if(E===1){D=JSON.parse(e);e=D.uri;H=D.sig;I=D.message;F=D.version}else{e+="";H+="";I+="";F+=""}C=n(e);B=e.split("/")[2];p.fire("receiveMessage",[H,I].join("|"),B,e,C,F)}catch(J){}},0)};window[m]=function(e,B){j[e]=B};vbscript=["Class "+h+"\n ","Private m_Intended\n","Public Sub SetIntendedName(name)\n ","If isEmpty(m_Intended) Then\n","m_Intended = name\n","End If\n","End Sub\n","Public Sub SendMessage(data)\n ",s+"(data)\n","End Sub\n","Public Sub SendMessage2(uri, sig, message, version)\n ","Call "+s+"(uri, sig, message, version)\n","End Sub\n","Public Sub CreateChannel(channel)\n ","Call "+m+"(m_Intended, channel)\n","End Sub\n","End Class\n","Function "+b+"(name)\n","Dim wrap\n","Set wrap = New "+h+"\n","wrap.SetIntendedName name\n","Set "+b+" = wrap\n","End Function"].join("");try{window.execScript(vbscript,"vbscript")}catch(w){}}z=function(E){var B,C;E.version=E.version||u;E.sig=E.sig||"";E.uri=v;try{B=E.targetId||"parent";if(B=="parent"){C=j.parent;if(!C&&window.opener&&"CreateChannel" in window.opener){C=window.opener;C.CreateChannel(window[b]("parent"));j.parent=C;window.opener=null}if(C){if("SendMessage2" in C){C.SendMessage2(E.uri,E.sig,E.message,E.version)}else{C.SendMessage(JSON.stringify(E))}E.handler.call(window);return true}}else{if(j[B]){if("SendMessage2" in j[B]){j[B].SendMessage2(E.uri+"",E.sig+"",E.message+"",E.version+"")}else{j[B].SendMessage(JSON.stringify(E))}E.handler.call(window);return true}}}catch(D){}c.send(E)};c=(function(){var e=(function(){var C=0;return function(){return"om_xdm_proxy"+C++}})();q=function(D){function C(){var E=document.getElementById(D);E.getElementsByTagName("iframe")[0].onload=null;if(E.parentNode){E.parentNode.removeChild(E)}E=null}p.mapHandlers[D].call(window);delete p.mapHandlers[D];if(navigator.userAgent.indexOf("Firefox")>-1){setTimeout(C,0)}else{C()}};var B=function(E){if(!document||!document.body){setTimeout(function(){z(E)},20);return}var I=E.proxy,G=E.target,O=E.message,L=E.handler,N=E.sig||"",H=E.version||u;if(!i(G)){L();return false}if(window.ActiveXObject&&x(H,"1.1.9")>=0){var J=new ActiveXObject("htmlfile");J.open();J.parentWindow.opener=window;J.parentWindow.callback=function(){J=null;L()};J.write(["<html><head></head><body>",'<iframe src="',I,'" name="',k(O,N,H,G,v),'"></iframe>',"<script>onload = callback;<\/script>","</body></html>"].join(""));J.close()}else{var K=[I,"#","target=",encodeURIComponent(G)+"&url=",encodeURIComponent(v)].join(""),F,D,C=document.createElement("div"),M=C.style;D=e();p.mapHandlers[D]=L;F=["<iframe onload=\"YAHOO.util.CrossFrame.iframeOnload('",D,'\');" name="',k(O,N,H),'" src="',K,'"></iframe>'].join("");M.width=M.left=M.top=M.height="0";M.overflow="hidden";M.position="absolute";C.id=D;document.body.appendChild(C);C.innerHTML=F}return true};return{send:B}})()}d.mix(p,{_events:{},on:function(e,C){var B=this._events;if(!B[e]){B[e]=[C]}else{B[e].push(C)}},fire:function(C){var E=this._events[C]||[],B=Array.prototype.slice.apply(arguments,[1]);for(var D=E.length;D--;){try{E[D].apply(null,B)}catch(F){}}},send:z,mapHandlers:{},_receive:function(D,E,C,e){var B=n(C);p.fire("receiveMessage",D,E,C,B,e)},initIEFrameTransport:function(e,C){var B;if(window.ActiveXObject&&!window.postMessage){B=window[b](C);e.contentWindow.opener=B}},proxyReceive:YAHOO.util.CrossFrame.proxyReceive},true);YAHOO.util.CrossFrame.iframeOnload=q})(YUI())}}if(typeof YUI!=="undefined"&&YUI&&!(YUI.om&&YUI.om.Iframe)){YUI.namespace("om.Iframe");(function(b){var d=[],f=[],j,c,g,i,e=true,h=YUI.util.CrossFrame;j=function(v,o,m,p,s){var k=v.indexOf("|"),u=v.substr(0,k),t,q,n;v=v.substr(k+1);for(q=0,n=d.length;q<n;q++){t=d[q];if(t.sig){if(!u||(t.sig!==u)){continue}}if(t.filter&&((t.filter.exec&&!t.filter.exec(m))||(t.filter.call&&!t.filter.call(null,m)))){continue}if(t.handler){try{t.handler.apply(t.scope,[{iframe:p,version:s},v.substr(4)])}catch(r){b.log("Exception in user defined handler","om.Iframe","iframe.js")}}}};h.on("receiveMessage",j);c=function(k){if(!k.pattern||!k.pattern.test||!k.handler||!k.handler.call){return false}d.push(k);return true};i=function(o,q,p,m,k,n){f.push({proxy:o,target:q,message:p,handler:g,sig:m,version:k,targetId:n});if(!e){g()}};g=function(){if(!f.length){e=false;return}e=true;h.send(f.shift())};YUI.om.Iframe={listen:c,send:i};function a(k){if(/in/.test(document.readyState)){setTimeout(function(){a(k)},9)}else{k()}}if(window.postMessage||document.postMessage||(top==self)){g()}else{if(document.addEventListener){document.addEventListener("DOMContentLoaded",g,false)}else{a(g)}}})(YUI())};