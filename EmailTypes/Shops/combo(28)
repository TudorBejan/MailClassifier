YUI.add("mail-ui-inboxmenu-base",function(G){var A=G.common.Utils.substitute,F=G.common.Utils,E=G.ui.Templates,H=NeoConfig.emptyFolders,D=G.mail.FoldersView,C=G.common.persist.UserData,B=NeoConfig.mnuTmplMap;G.namespace("mail.ui");G.mail.ui.InboxMenu=new function(){var Z;var K=NeoConfig.om&&strings.str_cfg_tog_hasSMS,g=strings.str_tog_use_num_accel,Q=null,N=(G.one("#rail-resize-vert"))?1:0,f={leftpane_pane_folders:function(i){return A(i.leftpane_pane_folders,0,0,0,strings);},fid:function(i){return i.fid;},folderName:function(i){return i.name;},accel_prefix:function(){if(g){return strings["str_menu_accel_d_number"]+" ";}return"";},is_inbox_folder_else:function(j){var i={};i.is_accel1=(g?j.is_accel1:"");return A(j.is_inbox_folder_else,i,0,0,strings);},NOT_V1:function(){return"";},NOT_V11:function(){return"";},has_IM:function(i){return(NeoConfig.isBizmail!="1")?A(i.has_IM,null,null,null,strings):"";},has_sms:function(i){return(K&&NeoConfig.isBizmail!="1")?A(i.has_sms,null,null,null,strings):"";},global_url_base:function(){return NeoConfig.global_url_base;},showRedirectMsg:function(i){return NeoConfig.isInternal&&NeoConfig.intl!=="jp"?A(i.showRedirectMsg,0,0,0,strings):"";},sender_not_in_contacts:function(i){return A(i.sender_not_in_contacts,0,0,0,strings);},fwd_as_attacht:function(i){return strings.str_cfg_tog_fwd_as_attacht?A(i.fwd_as_attacht,0,0,0,strings):"";},enable_fullpage:function(i){return NeoConfig.fullPageAvailable?A(i.enable_fullpage,0,0,0,strings):"";},show_empty_trash:function(i){return H?"":A(i.show_empty_trash,0,0,0,strings);},show_empty_spam:function(i){return H?"":A(i.show_empty_spam,0,0,0,strings);},show_empty_folder:function(i,j){return H?A(i.show_empty_folder,0,0,0,strings):"";},show_empty_folder_else:function(i){return H?"":A(i.show_empty_folder_else,0,0,0,strings);},quickFilter:function(i){return NeoConfig.quickFilter==1?A(i.quickFilter,0,0,0,strings):"";},delete_thread_in_menu:function(i){return(NeoConfig.hasConvView||NeoConfig.hasConv)?A(i.delete_thread_in_menu,0,0,0,strings):"";}};function I(i,o,l,j){var r,n=i.replace("btn-","menu-"),m=G.one("#"+n);if(!m){var p=B[n]||B["menu-inbox"];G.use(p,function(t){var s=E[p];r=A(s.base,s,f,0,strings);t.one("body").appendChild(t.Node.create(r));k();});}else{k();}function q(){if(o){o();}}function k(){switch(n){case"menu-actions":case"menu-conv-actions":case"menu-msg-actions":case"menu-msglist":case"menu-bubble-actions":case"menu-thread-list-actions":J(i,n,j);if(i=="menu-msglist"){c(l);}break;case"menu-msg-actions":this.fire("darlaEvent",{action:"inbox_action_menu"});break;case"menu-move":X(q,l);return;case"menu-new":break;case"menu-conv-reply":h(n);break;case"menu-ml-preview":W(i,n);break;default:break;}q();}}function W(m,l){var k=G.one("#"+l),i=G.one("#"+m),j;if(NeoConfig.fullPageAvailable&&k){j=(NeoConfig.expBucketId==="CMUSMFMIM01"||NeoConfig.farm==="f9323")?k.one("[data-action=scroll-view-noprev]"):k.one("[data-action=fullpage-view]");}if(NeoConfig.fullPageAvailable){j[(NeoConfig.fullPage?"add":"remove")+"Class"]("active");j.set("aria-checked",(NeoConfig.fullPage?"true":"false"));}k&&k.all("ul li").set("role","menuitemradio");T(l);i.before("mousedown",function(){T(l);});}G.on("verticalPreview",function(i){N=i;});function T(r){var n=NeoConfig.fullPage,i=C.get("userUIPref.msgPaneVisible"),k=G.one("#"+r),s=k&&k.one("[data-action=scroll-view-prev]"),j=k&&k.one("[data-action=scroll-view-prev-beside]"),l=k&&k.one("[data-action=scroll-view-noprev]"),o=s&&s.one("em"),q=l&&l.one("em"),p=document.getElementById("shellcontent"),m;if(NeoConfig.verticalPreview){p=p?p.offsetWidth:10000;m=p<900;if(m){j.addClass("disabled");j.setAttribute("title",strings["str_msg-view_scroll_pvw_too_narrow"]);}else{j.removeClass("disabled");j.removeAttribute("title");}j[((!n&&i&&N&&!m)?"add":"remove")+"Class"]("active");j.set("aria-checked",((!n&&i&&N&&!m)?"true":"false"));}else{j.setStyle("display","none");}s[((!n&&i&&!N)?"add":"remove")+"Class"]("active");s.set("aria-checked",((!n&&i&&!N)?"true":"false"));l[((!n&&!i)?"add":"remove")+"Class"]("active");l.set("aria-checked",(!n&&!i?"true":"false"));if(!n){o[(i?"add":"remove")+"Class"]("hidden");q[(!i?"add":"remove")+"Class"]("hidden");}else{o["addClass"]("hidden");q["addClass"]("hidden");}}function h(l){var k=G.one("#"+l),i=k&&k.one("[data-action=reply-im]"),j=k&&k.one("[data-action=reply-sms]");if(i){i[(NeoConfig.tog_hasIM?"remove":"add")+"Class"]("hidden");}if(j){j[(NeoConfig.tog_hasSMS?"remove":"add")+"Class"]("hidden");}}function J(j,p,l){var m=G.one("#"+p),n=G.all("#"+j),s=l?(l.enableAddContact||null):null,k,q,o,r;if(NeoConfig.isFresh){S(G.one("#menu-actions [data-action=none]"),false);b(p);n.each(function(t){t.before("mousedown",function(){b(p);});});r=m.one(".togglePreview");if(r&&NeoConfig.fullPage){r.setAttribute("data-action","scroll-view-prev");}else{if(r){a(true,r);if(Z&&Z.detach){Z.detach();Z=null;}Z=G.on("ws:previewChange",a,this,r);}}return;}if(s){s.call(this,function(t){Y(m,t);});if(!l.isContext){n.each(function(t){t.before("mousedown",function(){s.call(this,function(u){Y(m,u);});});});}}if(p=="menu-actions"){k=G.mail.Tabs.getActiveTab();q=k&&k.widget&&k.widget.type;var i=m&&m.one("[data-action=togglePrevDialog]");i=i&&i.get("parentNode");o=!NeoConfig.hoverPreview||!NeoConfig.fullPage||q!="messagelist";i&&i.setStyle("display",(o?"none":"block"));}if(p==="menu-conv-actions"){b(p);idNode.before("mousedown",function(){b(p);});}}function a(j,i){if(j&&C.get("userUIPref.msgPaneVisible")){if(NeoConfig.expBucketId==="CMUSMFMIM01"||NeoConfig.farm==="f9323"){i.addClass("checked").setAttribute("data-action","scroll-view-noprev");}else{i.addClass("checked").setAttribute("data-action","fullpage-view");}}else{i.removeClass("checked").setAttribute("data-action","scroll-view-prev");}}function b(q){var o,t,n,j=G.one("#"+q),r=j&&j.get("children"),p,u,m=r&&r.size()||0,k,s;if(NeoConfig.isFresh&&q==="menu-actions"){n=G.one("#msg-list");if(n.hasClass("ml-compact")){u=j.one("[data-action=density-compact]");}else{if(n.hasClass("ml-open")){u=j.one("[data-action=density-open]");
}else{u=j.one("[data-action=density-regular]");}}if(u){j.all("[data-action=density-compact], [data-action=density-regular], [data-action=density-open]").removeClass("checked");u.addClass("checked");}else{clearTimeout(b.timeout);b.timeout=setTimeout(function(){b(q);},100);}k=G.mail.Tabs.getActiveTab();s=k&&k.widget&&k.widget.type;if(s==="messagelist"){j.all(".msglistonly").show();R(j,true);}else{if(s==="searchlist"){j.all(".msglistonly").hide();R(j,false);}}}if(q==="menu-conv-actions"){o=NeoConfig.msgrData;t=o&&o.spam;for(p=0;p<m;p++){u=r.item(p).one("li");if(u&&(/yimapp:report_spam$/).test(u.getAttribute("data-action"))){if(p==m-1){j.insert(u.get("parentNode"),r.item(p-1));b.moved=true;}S(u,t&&t.spammerId);}}if(!b.moved){clearTimeout(b.timeout);b.timeout=setTimeout(function(){b(q);},100);}}}function R(k,i){var j=k.one("ul.om li[data-action$='toggleqr']");if(j){if(i){j.ancestor("ul").removeClass("hidden");}else{j.ancestor("ul").addClass("hidden");}}}function Y(j,i){var k=j.get("id"),l=j.one("[data-action='addcontact']");if(k==="menu-actions"||k==="menu-msg-actions"||k==="menu-conv-actions"){S(l,i);}else{d(l,i);}j.fire("menu:changed");}function d(j,i){if(!j){return;}if(i){j.removeClass("hidden");j.ancestor("ul").removeClass("hidden");}else{j.addClass("hidden");if(j.siblings().size()==0){j.ancestor("ul").addClass("hidden");}}}function P(i,j){i.setContent(j);}function S(k,j){if(!k){return;}var i=k.one("a");if(j){k.removeClass("disabled");i.removeAttribute("aria-disabled");}else{k.addClass("disabled");i.set("aria-disabled",true);}}function O(i){var j=[];i.all("li em").each(function(m){var k=m.get("text").replace(/^\s+|\s+$/g,"");var n=k.indexOf(strings["str_menu_accel_d_number"]);if(n!=-1){k=G.Lang.trim(k.replace(strings["str_menu_accel_d_number"],""));}k=k.split("+");for(var l=0;l<k.length;l++){if(k[l].length==1){k[l]=k[l].charCodeAt(0);}}k=(k.length==1)?k[0]:k.join("+");j.push(k);});return j;}function e(i){var j=[],k,l;for(l in i){k=i[l];if(!k.isSystem&&k.folderInfo){if(k.folderInfo.fid.indexOf("Sync%20Trap")==0){continue;}j.push(k);}}return j;}function U(j){var m=0,l=[],k,o=G.one("#menu-move-folder"),n=E[B["menu-inbox"]];if(o){for(;m<j.length;m++){k={fid:j[m].folderInfo.fid,name:j[m].folderInfo.name,name_dir:NeoConfig.bidi?j[m].folderInfo.dir:""};if(g&&m+1<=9){k.accel=strings["str_menu_accel_d_number"]+" "+(m+1);}else{k.is_accel="";}l.push(A(n.folders,k,f,0,strings,n));}o.setContent(l.join(""));if(NeoConfig.fullpage===0&&G.UA.ie>0){height=parseInt(o.getStyle("maxHeight"));winHeight=o.get("winHeight");height=Math.max(50,Math.min(height,parseInt(winHeight/4)));o.setStyle("maxHeight",height+"px");}}}function L(j){var i=null;switch(j){case"%40B%40Bulk":i=G.one("#menu-move [data-action='spam']");break;case"Trash":i=G.one("#menu-move [data-action='trash']");break;case"Inbox":i=G.one("#menu-move [data-action='inbox-move']");break;default:i=G.one("#menu-move-folder [data-fid='"+j+"']");}return i;}function M(k){G.all("#menu-move li").setStyle("display","block");var i=L(k),j;if(!i){return;}i.setStyle("display","none");j=G.one("#menu-move-folder");if(G.Array.indexOf(j.all("li").getStyle("display"),"block")!=-1){j.setStyle("display","block");}else{j.setStyle("display","none");}}function c(o){var n=G.one("#menu-msglist"),l,i,j,k,m={"%40B%40Bulk":1,"Draft":1,"Sent":1};if(n){l=n.one("[data-action='spam']");i=n.one("[data-action='notspam']");j=n.one("[data-action='reply_sender']");k=n.one("[data-action='fullheader']");n[(o=="%40C%40Chats"?"add":"remove")+"Class"]("hidden");}if(!l||!i){return;}d(l.ancestor("li"),m[o]!==1);d(i.ancestor("li"),o==="%40B%40Bulk");if(o=="Draft"){d(j);}else{d(j,true);}if(k){d(k,(o&&o!=="%40S%40Search"));}}function X(i,j){var k=j||D.get("fid").fid;if(G.one("#menu-move-folder li")){M(k);i();}else{G.mail.Controller.Folders.get(null,{success:function(m){var l=e(m);U(l);M(k);i();}});}}function V(){if(!Q){Q=A("{{str_menu_accel_enter}}",null,null,0,strings);}return Q;}G.mix(this,{insert:I,getValidKeys:O,getEnterAccel:V,updateAddContactsMenu:Y});D.on("fidChange",function(j){var i=j.newVal.fid;c(i);M(i);});G.on("ds:folder:change",function(k,j,l){if(!l){var i=e(j);U(i);}});};},"1.0.0",{requires:["common-utils","menus_css"]});YUI.add("_shared_module_offscreen_bin_menus_actions_fresh",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_offscreen_bin_menus_actions_fresh={base:'<div id="menu-actions" class="optionMenu"> <ul class="multimsg first"> <li data-action="read" class="multimsg"><a href="#"><span>{{str_menu_mark_read}}</span><em>{{str_menu_accel_mark_read}}</em></a></li> <li data-action="unread" class="multimsg"><a href="#"><span>{{str_menu_mark_unread}}</span><em>{{str_menu_accel_mark_unread}}</em></a></li> <li data-action="flagged" class="multimsg"><a href="#"><span>{{str_menu_flag}}</span><em>{{str_menu_accel_flag}}</em></a></li> <li data-action="unflagged" class="multimsg"><a href="#"><span>{{str_menu_clear_flag}}</span><em>{{str_menu_accel_clear_flag}}</em></a></li> </ul> <ul class="onemsg"> <li data-action="print" class="onemsg"><a href="#"><span>{{str_menu_print_email}}</span><em>{{str_menu_accel_print}}</em></a></li> {{quickFilter}} </ul> <ul class="onemsg"> <li data-action="fullheader" class="onemsg"><a href="#"><span>{{str_menu_view_header}}</span></a></li> <li data-action="set_encodings" class="onemsg" id="btn-set-encodings"><a href="#"><span>{{str_menu_encodings}}</span></a></li> </ul> <ul> <li data-action="density-compact"><a href="#"><span>{{str_menu_size_compact}}</span></a></li> <li data-action="density-regular"><a href="#"><span>{{str_menu_size_regular}}</span></a></li> <li data-action="density-open"><a href="#"><span>{{str_menu_size_open}}</span></a></li> </ul> <ul class="msglistonly"> <li class="togglePreview"><a href="#"><span>{{str_menu_preview_pane}}</span></a></li> </ul> <ul class="nomsg"> <li data-action="none"><a href="#"><span>{{str_menu_select_for_more}}</span></a></li> </ul></div>',quickFilter:'<li data-action="quick_filter" class="onemsg"><a href="#"><span>{{str_menu_filter_emails_like_this}}</span></a></li>'};},"1.0.0");